
===================configuration===================
l2 0.001
learning rate :  0.005
observation hour [7,19]
observation threshold :  10800
prediction time :  86400
cascade length [5,1000]
model save at : ../model_save/cascn/weibo/
===================configuration===================
-----------------display step-------------------
display step : 2887
WARNING:tensorflow:From models/CasCN/run.py:53: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From models/CasCN/run.py:53: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-01-02 12:35:57.121265: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2022-01-02 12:35:57.184529: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3493010000 Hz
2022-01-02 12:35:57.186268: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55979b514f20 executing computations on platform Host. Devices:
2022-01-02 12:35:57.186326: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2022-01-02 12:35:57.202644: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2022-01-02 12:35:57.221526: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.635
pciBusID: 0000:41:00.0
2022-01-02 12:35:57.223821: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2022-01-02 12:35:57.269110: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2022-01-02 12:35:57.289339: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10
2022-01-02 12:35:57.294004: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10
2022-01-02 12:35:57.326412: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10
2022-01-02 12:35:57.330741: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10
2022-01-02 12:35:57.391787: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2022-01-02 12:35:57.395181: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-01-02 12:35:57.396024: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.1
2022-01-02 12:35:57.561210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-01-02 12:35:57.561262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0 
2022-01-02 12:35:57.561646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N 
2022-01-02 12:35:57.564534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10319 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:41:00.0, compute capability: 7.5)
2022-01-02 12:35:57.568140: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5597a78446e0 executing computations on platform CUDA. Devices:
2022-01-02 12:35:57.568172: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
WARNING:tensorflow:From /home/yuhang/open-cas/models/CasCN/utils/model_sparse_graph_signal.py:253: calling RandomUniform.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/yuhang/open-cas/models/CasCN/utils/model_sparse_graph_signal.py:290: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/yuhang/open-cas/models/CasCN/utils/model_sparse_graph_signal.py:338: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
1->WARNING:tensorflow:From /home/yuhang/miniconda3/envs/tf14/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
2->3->4->5->6->7->8->9->10->11->12->13->14->15->16->17->18->19->20->21->22->23->24->25->26->27->28->29->30->31->32->33->34->35->36->37->38->39->40->41->42->43->44->45->46->47->48->49->50->51->52->53->54->55->56->57->58->59->60->61->62->63->64->65->66->67->68->69->70->71->72->73->74->75->76->77->78->79->80->81->82->83->84->85->86->87->88->89->90->91->92->93->94->95->96->97->98->99->100->WARNING:tensorflow:From /home/yuhang/open-cas/models/CasCN/utils/model_sparse_graph_signal.py:268: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

WARNING:tensorflow:From /home/yuhang/open-cas/models/CasCN/utils/model_sparse_graph_signal.py:272: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/yuhang/miniconda3/envs/tf14/lib/python3.7/site-packages/tensorflow/python/ops/math_grad.py:1205: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2022-01-02 12:37:48.969922: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
WARNING:tensorflow:From models/CasCN/run.py:57: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

building time: 112.93861699104309
l2 0.001
learning rate: 0.005

feat_in: 100 
num_nodes: 100 
n_sequences: 100
n_nodes:   100
-----------start to train--------------
2022-01-02 12:37:55.076418: W tensorflow/core/framework/allocator.cc:107] Allocation of 64000000 exceeds 10% of system memory.
2022-01-02 12:37:55.310632: W tensorflow/core/framework/allocator.cc:107] Allocation of 64000000 exceeds 10% of system memory.
2022-01-02 12:39:16.230384: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10
2022-01-02 12:39:17.309429: W tensorflow/core/framework/allocator.cc:107] Allocation of 64000000 exceeds 10% of system memory.
2022-01-02 12:39:17.642487: W tensorflow/core/framework/allocator.cc:107] Allocation of 64000000 exceeds 10% of system memory.
[Training] 2/40001 [..............................] - ETA: 644:43:06  loss: 22.1853 2022-01-02 12:39:46.755302: W tensorflow/core/framework/allocator.cc:107] Allocation of 64000000 exceeds 10% of system memory.
[Training] 1990/40001 [>.............................] - ETA: 4:44:41  loss: 2.7717 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 561.8ms/step  loss: 1.3776    08 
#1.0, Training Loss= 3.214761, Validation Loss= 2.891472, Test Loss= 3.025009, Best Valid Loss= 2.891472, Best Test Loss= 3.025009
 Val Loss mSEL:0.760311, Test Loss mSEL:0.780989,
 Val acc:0.753034, Test acc:0.746157,
 Val Loss mape:0.525942, Test Loss mape:0.538646,


after evaluating: 1714.7026362419128
[Training] 4877/40001 [==>...........................] - ETA: 4:45:09  loss: 2.4339 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 513.0ms/step  loss: 1.3137    72 
#2.0, Training Loss= 2.963545, Validation Loss= 2.869598, Test Loss= 3.007667, Best Valid Loss= 2.869598, Best Test Loss= 3.007667
 Val Loss mSEL:0.726597, Test Loss mSEL:0.749388,
 Val acc:0.753742, Test acc:0.746359,
 Val Loss mape:0.520911, Test Loss mape:0.534544,


after evaluating: 1448.630640745163
[Training] 6470/40001 [===>..........................] -[Training] 6471/40001 [===>..........................] -[Training] 6472/40001 [===>..........................] -[Training] 6473/40001 [===>..........................] -[Training] 6474/40001 [===>..........................] -[Training] 7764/40001 [====>.........................] - ETA: 4:24:55  loss: 2.4414 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 520.9ms/step  loss: 1.3645    45  
#3.0, Training Loss= 2.951042, Validation Loss= 2.842813, Test Loss= 2.981216, Best Valid Loss= 2.842813, Best Test Loss= 2.981216
 Val Loss mSEL:0.729262, Test Loss mSEL:0.757163,
 Val acc:0.766889, Test acc:0.761529,
 Val Loss mape:0.505304, Test Loss mape:0.518592,


after evaluating: 1462.9548020362854
[Training] 10651/40001 [======>.......................] - ETA: 4:02:54  loss: 2.4239 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 513.8ms/step  loss: 1.3414    556  
#4.0, Training Loss= 2.928967, Validation Loss= 2.829798, Test Loss= 2.972314, Best Valid Loss= 2.829798, Best Test Loss= 2.972314
 Val Loss mSEL:0.700720, Test Loss mSEL:0.733459,
 Val acc:0.780036, Test acc:0.772553,
 Val Loss mape:0.498544, Test Loss mape:0.512376,


after evaluating: 1452.4334378242493
[Training] 13539/40001 [=========>....................] - ETA: 3:39:48  loss: 2.4016 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 517.7ms/step  loss: 1.4066    382 
#5.0, Training Loss= 2.920349, Validation Loss= 2.826041, Test Loss= 2.970045, Best Valid Loss= 2.826041, Best Test Loss= 2.970045
 Val Loss mSEL:0.721842, Test Loss mSEL:0.752109,
 Val acc:0.781655, Test acc:0.774980,
 Val Loss mape:0.493014, Test Loss mape:0.506684,


after evaluating: 1465.5470073223114
[Training] 16426/40001 [===========>..................] - ETA: 3:15:48  loss: 1.4235 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 489.2ms/step  loss: 1.3555    590  
#6.0, Training Loss= 2.914310, Validation Loss= 2.835556, Test Loss= 2.977975, Best Valid Loss= 2.826041, Best Test Loss= 2.970045
 Val Loss mSEL:0.705199, Test Loss mSEL:0.737640,
 Val acc:0.783879, Test acc:0.776901,
 Val Loss mape:0.492885, Test Loss mape:0.506669,


after evaluating: 1398.7694895267487
[Training] 19313/40001 [=============>................] - ETA: 2:51:01  loss: 2.2598 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 488.9ms/step  loss: 1.3587 WARNING:tensorflow:From /home/yuhang/miniconda3/envs/tf14/lib/python3.7/site-packages/tensorflow/python/training/saver.py:960: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.

#7.0, Training Loss= 2.909134, Validation Loss= 2.823822, Test Loss= 2.963839, Best Valid Loss= 2.823822, Best Test Loss= 2.963839
 Val Loss mSEL:0.699783, Test Loss mSEL:0.730065,
 Val acc:0.778924, Test acc:0.772249,
 Val Loss mape:0.499928, Test Loss mape:0.513692,


after evaluating: 1395.179303407669
[Training] 22200/40001 [===============>..............] - ETA: 2:26:36  loss: 2.2080 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 488.4ms/step  loss: 1.3694    376  
#8.0, Training Loss= 2.910895, Validation Loss= 2.829283, Test Loss= 2.969996, Best Valid Loss= 2.823822, Best Test Loss= 2.963839
 Val Loss mSEL:0.735226, Test Loss mSEL:0.757748,
 Val acc:0.779834, Test acc:0.773867,
 Val Loss mape:0.492873, Test Loss mape:0.505983,


after evaluating: 1377.3618304729462
[Training] 25087/40001 [=================>............] - ETA: 2:02:18  loss: 2.4235 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 485.4ms/step  loss: 1.3880    950  
#9.0, Training Loss= 2.908326, Validation Loss= 2.821604, Test Loss= 2.964859, Best Valid Loss= 2.821604, Best Test Loss= 2.964859
 Val Loss mSEL:0.709092, Test Loss mSEL:0.733181,
 Val acc:0.779430, Test acc:0.772553,
 Val Loss mape:0.496656, Test Loss mape:0.510393,


after evaluating: 1383.8077630996704
[Training] 27975/40001 [===================>..........] - ETA: 1:38:22  loss: 4.7054 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 489.4ms/step  loss: 1.3948    345 
#10.0, Training Loss= 2.906685, Validation Loss= 2.834077, Test Loss= 2.974078, Best Valid Loss= 2.821604, Best Test Loss= 2.964859
 Val Loss mSEL:0.735193, Test Loss mSEL:0.767678,
 Val acc:0.783778, Test acc:0.775991,
 Val Loss mape:0.487257, Test Loss mape:0.500702,


after evaluating: 1382.5873310565948
[Training] 30862/40001 [======================>.......] - ETA: 1:14:34  loss: 0.9972 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 481.8ms/step  loss: 1.3956    204  
#11.0, Training Loss= 2.909487, Validation Loss= 2.822847, Test Loss= 2.964924, Best Valid Loss= 2.821604, Best Test Loss= 2.964859
 Val Loss mSEL:0.716217, Test Loss mSEL:0.744490,
 Val acc:0.777913, Test acc:0.771845,
 Val Loss mape:0.497117, Test Loss mape:0.510735,


after evaluating: 1372.761593580246
[Training] 33749/40001 [========================>.....] - ETA: 50:54  loss: 2.3540 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 488.5ms/step  loss: 1.3802    2 
#12.0, Training Loss= 2.904965, Validation Loss= 2.823267, Test Loss= 2.965303, Best Valid Loss= 2.821604, Best Test Loss= 2.964859
 Val Loss mSEL:0.696800, Test Loss mSEL:0.727503,
 Val acc:0.778722, Test acc:0.771946,
 Val Loss mape:0.499849, Test Loss mape:0.513806,


after evaluating: 1378.6475031375885
[Training] 36636/40001 [==========================>...] - ETA: 27:20  loss: 2.2203 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Testing] 618/618 [==============================] 489.8ms/step  loss: 1.4143    0 
#13.0, Training Loss= 2.905269, Validation Loss= 2.848384, Test Loss= 2.994275, Best Valid Loss= 2.821604, Best Test Loss= 2.964859
 Val Loss mSEL:0.733867, Test Loss mSEL:0.772595,
 Val acc:0.779227, Test acc:0.772654,
 Val Loss mape:0.493402, Test Loss mape:0.506636,


after evaluating: 1375.3514261245728
[Training] 39523/40001 [============================>.] - ETA: 3:52  loss: 2.3294 setting an array element with a sequence. The requested array has an inhomogeneous shape after 2 dimensions. The detected shape was (16, 100) + inhomogeneous part.
[Training] 40002/40001 [==============================] 485.5ms/step  loss: 3.3973 Finished!
----------------------------------------------------------------
Time: 923.523030757904
Valid Loss: 2.8216038
Test Loss: 2.9648595