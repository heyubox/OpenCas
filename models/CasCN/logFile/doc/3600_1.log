error id at cas_id 2508
['351601', '-1']
error id at cas_id 24627
['1089184', '-1']
error id at cas_id 29214
['2216751', '-1']
error id at cas_id 52071
['953561', '-1']
error id at cas_id 75918
['4781546', '-1']
error id at cas_id 80162
['5000830', '-1']
error id at cas_id 85836
['5263156', '-1']
error id at cas_id 85836
['5263156', '-1']
error id at cas_id 87338
['652902', '-1']
error id at cas_id 87919
['-1']
error id at cas_id 87962
['-1']
error id at cas_id 87997
['-1']
error id at cas_id 88004
['-1']
error id at cas_id 88035
['-1']
error id at cas_id 88065
['-1']
error id at cas_id 88066
['-1']
error id at cas_id 90486
['5513165', '-1']
error id at cas_id 93504
['1666362', '-1']
error id at cas_id 94182
['441319', '-1']
error id at cas_id 99670
['3619043', '-1']
error id at cas_id 101969
['164582', '-1']
total_readin: 119313
discard_midnight: 22519
discard_outer: 60673
total: 36121
train data: 25284
valid data: 5419
test data: 5418
finish gen cascades obser
52.54240036010742
52.555248975753784
length discard_cascade_id: 73156 26291
generate cascade new!!!
total qualified cascade 65945
train:, valid:, test:, 24108 5153 5188
84.02109885215759
NUM_SEQUENCE: 100
Train:24108 Test:5188 Valid:5153
length of original isd: 515238
length of original isd: 134356
length of original isd: 134295
max node:  100
create train
349.8437042236328
create val and test
NUM_SEQUENCE: 100 LEN_SEQUENCE: 13
488.2300069332123
Finish!!!
Working in TF version 1.14....
===================configuration===================
l2 0.001
learning rate :  0.0005
observation hour [7,19]
observation threshold :  3600
prediction time :  86400
cascade length [10,100]
model save at : ../model_save/cascn/weibo/
===================configuration===================
-----------------display step-------------------
display step : 1506
1->2->3->4->5->6->7->8->9->10->11->12->13->14->15->16->17->18->19->20->21->22->23->24->25->26->27->28->29->30->31->32->33->34->35->36->37->38->39->40->41->42->43->44->45->46->47->48->49->50->51->52->53->54->55->56->57->58->59->60->61->62->63->64->65->66->67->68->69->70->71->72->73->74->75->76->77->78->79->80->81->82->83->84->85->86->87->88->89->90->91->92->93->94->95->96->97->98->99->100->building time: 110.7067551612854
-----------------display step-------------------
display step : 24096
l2 0.001
learning rate: 0.0005

feat_in: 100 
num_nodes: 100 
n_sequences: 100
n_nodes:   681749
-----------start to train--------------

traing time for an epoch: 1157.3998818397522 
 evaluating.........
[0.04 0.05 0.06 0.07 0.09 0.12]

last test error: 3.1917713

#1.0, Training Loss= 4.915068, Validation Loss= 3.183275, Test Loss= 3.191771, Best Valid Loss= 3.183275, Best Test Loss= 3.191771

after evaluating: 1429.7380619049072

traing time for an epoch: 862.9420914649963 
 evaluating.........
[0.03 0.05 0.07 0.08 0.1  0.14]

last test error: 2.9467225

#2.0, Training Loss= 2.924852, Validation Loss= 2.955389, Test Loss= 2.946723, Best Valid Loss= 2.955389, Best Test Loss= 2.946723

after evaluating: 1080.1858224868774

traing time for an epoch: 940.5594925880432 
 evaluating.........
[0.03 0.05 0.08 0.09 0.12 0.16]

last test error: 2.9587176

#3.0, Training Loss= 2.807217, Validation Loss= 2.993288, Test Loss= 2.958718, Best Valid Loss= 2.955389, Best Test Loss= 2.946723

after evaluating: 1175.078788280487

traing time for an epoch: 933.4750039577484 
 evaluating.........
[0.03 0.06 0.09 0.11 0.15 0.2 ]

last test error: 2.7944367

#4.0, Training Loss= 2.729656, Validation Loss= 2.813253, Test Loss= 2.794437, Best Valid Loss= 2.813253, Best Test Loss= 2.794437

after evaluating: 1196.0836477279663

traing time for an epoch: 943.2557196617126 
 evaluating.........
[0.04 0.06 0.11 0.13 0.17 0.23]

last test error: 2.7073395

#5.0, Training Loss= 2.658263, Validation Loss= 2.705279, Test Loss= 2.707340, Best Valid Loss= 2.705279, Best Test Loss= 2.707340

after evaluating: 1184.1677961349487

traing time for an epoch: 890.272421836853 
 evaluating.........
[0.04 0.07 0.12 0.14 0.18 0.24]

last test error: 2.7631197

#6.0, Training Loss= 2.642092, Validation Loss= 2.770214, Test Loss= 2.763120, Best Valid Loss= 2.705279, Best Test Loss= 2.707340

after evaluating: 1114.6703736782074

traing time for an epoch: 873.045821428299 
 evaluating.........
[0.04 0.08 0.13 0.15 0.2  0.27]

last test error: 2.768309

#7.0, Training Loss= 2.628016, Validation Loss= 2.782297, Test Loss= 2.768309, Best Valid Loss= 2.705279, Best Test Loss= 2.707340

after evaluating: 1090.9393200874329

traing time for an epoch: 919.1368277072906 
 evaluating.........
[0.03 0.08 0.14 0.17 0.22 0.29]

last test error: 2.6315587

#8.0, Training Loss= 2.594519, Validation Loss= 2.640425, Test Loss= 2.631559, Best Valid Loss= 2.640425, Best Test Loss= 2.631559

after evaluating: 1154.8697397708893

traing time for an epoch: 927.7667067050934 
 evaluating.........
[0.02 0.08 0.16 0.18 0.23 0.31]

last test error: 2.5984428

#9.0, Training Loss= 2.547050, Validation Loss= 2.583002, Test Loss= 2.598443, Best Valid Loss= 2.583002, Best Test Loss= 2.598443

after evaluating: 1165.056457042694

traing time for an epoch: 917.0614900588989 
 evaluating.........
[-0.    0.07  0.15  0.18  0.23  0.31]

last test error: 2.5163248

#10.0, Training Loss= 2.488412, Validation Loss= 2.497986, Test Loss= 2.516325, Best Valid Loss= 2.497986, Best Test Loss= 2.516325

after evaluating: 1162.571522474289

traing time for an epoch: 871.6821572780609 
 evaluating.........
[-0.01  0.05  0.13  0.17  0.22  0.29]

last test error: 2.3713412

#11.0, Training Loss= 2.383780, Validation Loss= 2.345438, Test Loss= 2.371341, Best Valid Loss= 2.345438, Best Test Loss= 2.371341

after evaluating: 1096.4338402748108

traing time for an epoch: 867.4955472946167 
 evaluating.........
[-0.01  0.01  0.11  0.16  0.2   0.28]

last test error: 2.2878983

#12.0, Training Loss= 2.319885, Validation Loss= 2.239750, Test Loss= 2.287898, Best Valid Loss= 2.239750, Best Test Loss= 2.287898

after evaluating: 1089.213574886322

traing time for an epoch: 915.7425765991211 
 evaluating.........
[-0.01  0.    0.1   0.15  0.19  0.26]

last test error: 2.2062106

#13.0, Training Loss= 2.234544, Validation Loss= 2.142199, Test Loss= 2.206211, Best Valid Loss= 2.142199, Best Test Loss= 2.206211

after evaluating: 1143.6360721588135

traing time for an epoch: 780.2492983341217 
 evaluating.........
[-1.18e-02  2.16e-05  7.72e-02  1.31e-01  1.82e-01  2.50e-01]

last test error: 2.1801946

#14.0, Training Loss= 2.184009, Validation Loss= 2.119586, Test Loss= 2.180195, Best Valid Loss= 2.119586, Best Test Loss= 2.180195

after evaluating: 992.5143735408783

traing time for an epoch: 811.2969324588776 
 evaluating.........
[-0.01  0.    0.06  0.12  0.17  0.25]

last test error: 2.1564765

#15.0, Training Loss= 2.148974, Validation Loss= 2.095500, Test Loss= 2.156476, Best Valid Loss= 2.095500, Best Test Loss= 2.156476

after evaluating: 1015.7441649436951

traing time for an epoch: 890.3156881332397 
 evaluating.........
[-0.01 -0.    0.05  0.11  0.17  0.24]

last test error: 2.1244576

#16.0, Training Loss= 2.126665, Validation Loss= 2.074579, Test Loss= 2.124458, Best Valid Loss= 2.074579, Best Test Loss= 2.124458

after evaluating: 1078.3577909469604

traing time for an epoch: 890.5792396068573 
 evaluating.........
[-0.01 -0.    0.05  0.11  0.16  0.24]

last test error: 2.1312375

#17.0, Training Loss= 2.106513, Validation Loss= 2.068644, Test Loss= 2.131238, Best Valid Loss= 2.074579, Best Test Loss= 2.124458

after evaluating: 1109.4474711418152

traing time for an epoch: 883.0273070335388 
 evaluating.........
[-0.01 -0.    0.04  0.11  0.17  0.25]

last test error: 2.1055133

#18.0, Training Loss= 2.096983, Validation Loss= 2.053939, Test Loss= 2.105513, Best Valid Loss= 2.053939, Best Test Loss= 2.105513

after evaluating: 1136.5381877422333

traing time for an epoch: 875.6453251838684 
 evaluating.........
[-0.01  0.    0.03  0.1   0.16  0.24]

last test error: 2.1009748

#19.0, Training Loss= 2.079672, Validation Loss= 2.059759, Test Loss= 2.100975, Best Valid Loss= 2.059759, Best Test Loss= 2.100975

after evaluating: 1103.9127414226532

traing time for an epoch: 877.4390981197357 
 evaluating.........
[-0.01 -0.    0.03  0.09  0.17  0.24]

last test error: 2.078378

#20.0, Training Loss= 2.065531, Validation Loss= 2.023513, Test Loss= 2.078378, Best Valid Loss= 2.023513, Best Test Loss= 2.078378

after evaluating: 1092.3770797252655

traing time for an epoch: 900.3857245445251 
 evaluating.........
[-0.01 -0.    0.03  0.1   0.17  0.26]

last test error: 2.0810163

#21.0, Training Loss= 2.048209, Validation Loss= 2.019443, Test Loss= 2.081016, Best Valid Loss= 2.023513, Best Test Loss= 2.078378

after evaluating: 1115.5565314292908

traing time for an epoch: 906.6165845394135 
 evaluating.........
[-0.01 -0.    0.03  0.1   0.18  0.27]

last test error: 2.0776048

#22.0, Training Loss= 2.049491, Validation Loss= 2.025418, Test Loss= 2.077605, Best Valid Loss= 2.025418, Best Test Loss= 2.077605

after evaluating: 1142.5127370357513

traing time for an epoch: 1534.0044236183167 
 evaluating.........
[-1.06e-02 -1.22e-04  2.75e-02  9.87e-02  1.89e-01  2.88e-01]

last test error: 2.0731843

#23.0, Training Loss= 2.047343, Validation Loss= 2.038183, Test Loss= 2.073184, Best Valid Loss= 2.038183, Best Test Loss= 2.073184

after evaluating: 1760.5839245319366

traing time for an epoch: 761.5206303596497 
 evaluating.........
[-0.01 -0.    0.03  0.1   0.2   0.3 ]

last test error: 2.0560124

#24.0, Training Loss= 2.044746, Validation Loss= 2.006873, Test Loss= 2.056012, Best Valid Loss= 2.006873, Best Test Loss= 2.056012

after evaluating: 956.5730657577515

traing time for an epoch: 871.6907165050507 
 evaluating.........
[-0.01 -0.    0.03  0.11  0.22  0.32]

last test error: 2.0700238

#25.0, Training Loss= 2.032251, Validation Loss= 2.013167, Test Loss= 2.070024, Best Valid Loss= 2.006873, Best Test Loss= 2.056012

after evaluating: 1094.7281489372253

traing time for an epoch: 868.1133041381836 
 evaluating.........
[-0.01 -0.    0.03  0.12  0.23  0.34]

last test error: 2.074482

#26.0, Training Loss= 2.033657, Validation Loss= 2.022492, Test Loss= 2.074482, Best Valid Loss= 2.006873, Best Test Loss= 2.056012

after evaluating: 1087.4773511886597

 5200 5188
Finished!
----------------------------------------------------------------
Time: 488.12029576301575
Valid Loss: 2.006873
Test Loss: 2.0560124
