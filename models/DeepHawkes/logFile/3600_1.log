os.environ: 0
1.14.0
dataset information: nodes:752556, n_sequence:120, n_steps:17 
===================configuration===================
dropout prob :  0.001
l2 0.05
learning rate :  0.0005
emb_learning_rate :  0.0005
observation hour [7,19]
observation threshold :  3600
prediction time :  86400
cascade length [5,100]
model save at : ../model_save/deephawkes/weibo1/
===================configuration===================
---------***---------
Number: 37228, Max: 15.090567326304047 and Min: 0.0 label Value in Train
NUmber: 7978, Max: 15.009784888072957 and Min: 0.0 label Value in Test
NUmber: 7978, Max: 13.410318842200489 and Min: 0.0 label Value in Valid
---------***---------
37228 7978 7978
Total_parameters:37653055
finish one epoch, time374.44029998779297
#0, Training Loss= nan, Valid Loss= 5.14929, Valid median Loss= 2.41600, Best Valid Loss= 5.14929, Test Loss= 4.92208, Test median  Loss= 2.33049, Best Test Loss= 4.92208
 Val Loss mSEL:2.416001, Test Loss mSEL:2.330489,
 Val acc:0.200605, Test acc:0.201361,
 Val Loss mape:17.062710, Test Loss mape:14.938875,

finish one epoch, time897.5485346317291
#1, Training Loss= nan, Valid Loss= 2.69552, Valid median Loss= 0.70324, Best Valid Loss= 2.69552, Test Loss= 2.51023, Test median  Loss= 0.67619, Best Test Loss= 2.51023
 Val Loss mSEL:0.703235, Test Loss mSEL:0.676189,
 Val acc:0.486643, Test acc:0.496220,
 Val Loss mape:19.273470, Test Loss mape:17.174571,

finish one epoch, time1428.5385220050812
#2, Training Loss= nan, Valid Loss= 2.65935, Valid median Loss= 0.73154, Best Valid Loss= 2.65935, Test Loss= 2.47147, Test median  Loss= 0.70837, Best Test Loss= 2.47147
 Val Loss mSEL:0.731542, Test Loss mSEL:0.708374,
 Val acc:0.476562, Test acc:0.487399,
 Val Loss mape:18.570217, Test Loss mape:16.558555,

finish one epoch, time2137.0070798397064
#3, Training Loss= nan, Valid Loss= 2.62512, Valid median Loss= 0.72651, Best Valid Loss= 2.62512, Test Loss= 2.46411, Test median  Loss= 0.70792, Best Test Loss= 2.46411
 Val Loss mSEL:0.726506, Test Loss mSEL:0.707920,
 Val acc:0.478327, Test acc:0.489037,
 Val Loss mape:18.386973, Test Loss mape:16.329682,

finish one epoch, time2856.5658700466156
#4, Training Loss= nan, Valid Loss= 2.62657, Valid median Loss= 0.74381, Best Valid Loss= 2.62512, Test Loss= 2.46622, Test median  Loss= 0.71873, Best Test Loss= 2.46411
 Val Loss mSEL:0.743813, Test Loss mSEL:0.718734,
 Val acc:0.474924, Test acc:0.484375,
 Val Loss mape:18.105745, Test Loss mape:16.002217,

finish one epoch, time3590.2101271152496
#5, Training Loss= nan, Valid Loss= 2.60824, Valid median Loss= 0.70168, Best Valid Loss= 2.60824, Test Loss= 2.43474, Test median  Loss= 0.68745, Best Test Loss= 2.43474
 Val Loss mSEL:0.701681, Test Loss mSEL:0.687449,
 Val acc:0.487903, Test acc:0.496724,
 Val Loss mape:18.650051, Test Loss mape:16.346970,

finish one epoch, time4256.818666219711
#6, Training Loss= nan, Valid Loss= 2.58933, Valid median Loss= 0.68979, Best Valid Loss= 2.58933, Test Loss= 2.41253, Test median  Loss= 0.67853, Best Test Loss= 2.41253
 Val Loss mSEL:0.689795, Test Loss mSEL:0.678529,
 Val acc:0.492944, Test acc:0.501134,
 Val Loss mape:18.765832, Test Loss mape:16.527634,

finish one epoch, time4883.017116308212
#7, Training Loss= nan, Valid Loss= 2.48532, Valid median Loss= 0.69897, Best Valid Loss= 2.48532, Test Loss= 2.30560, Test median  Loss= 0.67717, Best Test Loss= 2.30560
 Val Loss mSEL:0.698967, Test Loss mSEL:0.677171,
 Val acc:0.487273, Test acc:0.499622,
 Val Loss mape:16.621499, Test Loss mape:14.476872,

finish one epoch, time5499.004162073135
#8, Training Loss= nan, Valid Loss= 2.41610, Valid median Loss= 0.66176, Best Valid Loss= 2.41610, Test Loss= 2.21653, Test median  Loss= 0.62775, Best Test Loss= 2.21653
 Val Loss mSEL:0.661755, Test Loss mSEL:0.627746,
 Val acc:0.508191, Test acc:0.518019,
 Val Loss mape:16.337953, Test Loss mape:14.020340,

finish one epoch, time6159.764642953873
#9, Training Loss= nan, Valid Loss= 2.34374, Valid median Loss= 0.65374, Best Valid Loss= 2.34374, Test Loss= 2.15135, Test median  Loss= 0.60971, Best Test Loss= 2.15135
 Val Loss mSEL:0.653736, Test Loss mSEL:0.609709,
 Val acc:0.509325, Test acc:0.516633,
 Val Loss mape:14.778468, Test Loss mape:12.591757,

finish one epoch, time6818.7261481285095
#10, Training Loss= nan, Valid Loss= 2.32924, Valid median Loss= 0.65096, Best Valid Loss= 2.32924, Test Loss= 2.13141, Test median  Loss= 0.60399, Best Test Loss= 2.13141
 Val Loss mSEL:0.650963, Test Loss mSEL:0.603992,
 Val acc:0.502268, Test acc:0.519657,
 Val Loss mape:14.454785, Test Loss mape:12.284413,

finish one epoch, time7466.278710603714
#11, Training Loss= nan, Valid Loss= 2.31549, Valid median Loss= 0.65001, Best Valid Loss= 2.31549, Test Loss= 2.12804, Test median  Loss= 0.60374, Best Test Loss= 2.12804
 Val Loss mSEL:0.650014, Test Loss mSEL:0.603742,
 Val acc:0.508443, Test acc:0.520287,
 Val Loss mape:14.727146, Test Loss mape:12.652943,

finish one epoch, time8117.6207909584045
#12, Training Loss= nan, Valid Loss= 2.30552, Valid median Loss= 0.66818, Best Valid Loss= 2.30552, Test Loss= 2.09355, Test median  Loss= 0.62995, Best Test Loss= 2.09355
 Val Loss mSEL:0.668182, Test Loss mSEL:0.629954,
 Val acc:0.503276, Test acc:0.513987,
 Val Loss mape:14.005809, Test Loss mape:11.785770,

finish one epoch, time8784.215123653412
#13, Training Loss= nan, Valid Loss= 2.28633, Valid median Loss= 0.66274, Best Valid Loss= 2.28633, Test Loss= 2.10006, Test median  Loss= 0.63210, Best Test Loss= 2.09355
 Val Loss mSEL:0.662743, Test Loss mSEL:0.632105,
 Val acc:0.510711, Test acc:0.515373,
 Val Loss mape:14.491545, Test Loss mape:12.476719,

finish one epoch, time10030.715756177902
#14, Training Loss= nan, Valid Loss= 2.30222, Valid median Loss= 0.66527, Best Valid Loss= 2.28633, Test Loss= 2.08859, Test median  Loss= 0.62404, Best Test Loss= 2.08859
 Val Loss mSEL:0.665267, Test Loss mSEL:0.624041,
 Val acc:0.507308, Test acc:0.512601,
 Val Loss mape:14.095000, Test Loss mape:11.781713,

finish one epoch, time10699.4089615345
#15, Training Loss= nan, Valid Loss= 2.30198, Valid median Loss= 0.67161, Best Valid Loss= 2.28633, Test Loss= 2.09296, Test median  Loss= 0.63860, Best Test Loss= 2.08859
 Val Loss mSEL:0.671615, Test Loss mSEL:0.638602,
 Val acc:0.505040, Test acc:0.507560,
 Val Loss mape:13.618435, Test Loss mape:11.563886,

finish one epoch, time11365.474606990814
#16, Training Loss= nan, Valid Loss= 2.29827, Valid median Loss= 0.67072, Best Valid Loss= 2.28633, Test Loss= 2.08716, Test median  Loss= 0.64377, Best Test Loss= 2.08716
 Val Loss mSEL:0.670724, Test Loss mSEL:0.643766,
 Val acc:0.503780, Test acc:0.508947,
 Val Loss mape:13.738041, Test Loss mape:11.525409,

finish one epoch, time12036.134396791458
#17, Training Loss= nan, Valid Loss= 2.28098, Valid median Loss= 0.67494, Best Valid Loss= 2.28098, Test Loss= 2.07762, Test median  Loss= 0.64484, Best Test Loss= 2.07762
 Val Loss mSEL:0.674935, Test Loss mSEL:0.644843,
 Val acc:0.505796, Test acc:0.511341,
 Val Loss mape:13.706088, Test Loss mape:11.666343,

finish one epoch, time12721.215571641922
#18, Training Loss= nan, Valid Loss= 2.27650, Valid median Loss= 0.66152, Best Valid Loss= 2.27650, Test Loss= 2.06405, Test median  Loss= 0.63435, Best Test Loss= 2.06405
 Val Loss mSEL:0.661515, Test Loss mSEL:0.634348,
 Val acc:0.507686, Test acc:0.512601,
 Val Loss mape:13.474950, Test Loss mape:11.430301,

finish one epoch, time13367.619188308716
#19, Training Loss= nan, Valid Loss= 2.25781, Valid median Loss= 0.66511, Best Valid Loss= 2.25781, Test Loss= 2.06841, Test median  Loss= 0.63882, Best Test Loss= 2.06405
 Val Loss mSEL:0.665110, Test Loss mSEL:0.638825,
 Val acc:0.499118, Test acc:0.503402,
 Val Loss mape:12.286506, Test Loss mape:10.349727,

finish one epoch, time14034.695183753967
#20, Training Loss= nan, Valid Loss= 2.26435, Valid median Loss= 0.67226, Best Valid Loss= 2.25781, Test Loss= 2.07603, Test median  Loss= 0.64346, Best Test Loss= 2.06405
 Val Loss mSEL:0.672263, Test Loss mSEL:0.643465,
 Val acc:0.500252, Test acc:0.505796,
 Val Loss mape:13.291843, Test Loss mape:11.358904,

finish one epoch, time14712.548391103745
#21, Training Loss= nan, Valid Loss= 2.26489, Valid median Loss= 0.63497, Best Valid Loss= 2.25781, Test Loss= 2.05996, Test median  Loss= 0.62260, Best Test Loss= 2.05996
 Val Loss mSEL:0.634969, Test Loss mSEL:0.622603,
 Val acc:0.508821, Test acc:0.515373,
 Val Loss mape:14.322917, Test Loss mape:12.205466,

finish one epoch, time15379.432572603226
#22, Training Loss= nan, Valid Loss= 2.24314, Valid median Loss= 0.62842, Best Valid Loss= 2.24314, Test Loss= 2.04924, Test median  Loss= 0.62187, Best Test Loss= 2.04924
 Val Loss mSEL:0.628425, Test Loss mSEL:0.621872,
 Val acc:0.503528, Test acc:0.509829,
 Val Loss mape:12.463580, Test Loss mape:10.454661,

finish one epoch, time16040.057532310486
#23, Training Loss= nan, Valid Loss= 2.24812, Valid median Loss= 0.63989, Best Valid Loss= 2.24314, Test Loss= 2.04127, Test median  Loss= 0.62748, Best Test Loss= 2.04127
 Val Loss mSEL:0.639886, Test Loss mSEL:0.627476,
 Val acc:0.503780, Test acc:0.511719,
 Val Loss mape:12.718219, Test Loss mape:10.710270,

finish one epoch, time16705.12835741043
#24, Training Loss= nan, Valid Loss= 2.24822, Valid median Loss= 0.63436, Best Valid Loss= 2.24314, Test Loss= 2.06069, Test median  Loss= 0.61266, Best Test Loss= 2.04127
 Val Loss mSEL:0.634364, Test Loss mSEL:0.612664,
 Val acc:0.498614, Test acc:0.502520,
 Val Loss mape:11.316138, Test Loss mape:9.506207,

finish one epoch, time17355.270681858063
#25, Training Loss= nan, Valid Loss= 2.23487, Valid median Loss= 0.63826, Best Valid Loss= 2.23487, Test Loss= 2.04643, Test median  Loss= 0.61621, Best Test Loss= 2.04127
 Val Loss mSEL:0.638264, Test Loss mSEL:0.616213,
 Val acc:0.504032, Test acc:0.512853,
 Val Loss mape:12.482220, Test Loss mape:10.566553,

finish one epoch, time18010.428029298782
#26, Training Loss= nan, Valid Loss= 2.23252, Valid median Loss= 0.62854, Best Valid Loss= 2.23252, Test Loss= 2.03817, Test median  Loss= 0.61534, Best Test Loss= 2.03817
 Val Loss mSEL:0.628540, Test Loss mSEL:0.615337,
 Val acc:0.507686, Test acc:0.511089,
 Val Loss mape:12.864837, Test Loss mape:10.870160,

finish one epoch, time18666.26692390442
#27, Training Loss= nan, Valid Loss= 2.22770, Valid median Loss= 0.63705, Best Valid Loss= 2.22770, Test Loss= 2.02914, Test median  Loss= 0.61986, Best Test Loss= 2.02914
 Val Loss mSEL:0.637053, Test Loss mSEL:0.619861,
 Val acc:0.502898, Test acc:0.509199,
 Val Loss mape:12.141201, Test Loss mape:10.153452,

finish one epoch, time19325.30459356308
#28, Training Loss= nan, Valid Loss= 2.21739, Valid median Loss= 0.62343, Best Valid Loss= 2.21739, Test Loss= 2.02992, Test median  Loss= 0.60060, Best Test Loss= 2.02914
 Val Loss mSEL:0.623432, Test Loss mSEL:0.600600,
 Val acc:0.507182, Test acc:0.514113,
 Val Loss mape:12.647476, Test Loss mape:10.954207,

finish one epoch, time19986.790513515472
#29, Training Loss= nan, Valid Loss= 2.20638, Valid median Loss= 0.61087, Best Valid Loss= 2.20638, Test Loss= 2.03871, Test median  Loss= 0.60148, Best Test Loss= 2.02914
 Val Loss mSEL:0.610873, Test Loss mSEL:0.601476,
 Val acc:0.505040, Test acc:0.511215,
 Val Loss mape:11.988415, Test Loss mape:10.094963,

finish one epoch, time20653.503212928772
#30, Training Loss= nan, Valid Loss= 2.21621, Valid median Loss= 0.59912, Best Valid Loss= 2.20638, Test Loss= 2.03276, Test median  Loss= 0.58332, Best Test Loss= 2.02914
 Val Loss mSEL:0.599124, Test Loss mSEL:0.583315,
 Val acc:0.508065, Test acc:0.511845,
 Val Loss mape:11.908494, Test Loss mape:9.954717,

finish one epoch, time21292.975613355637
#31, Training Loss= nan, Valid Loss= 2.23376, Valid median Loss= 0.62475, Best Valid Loss= 2.20638, Test Loss= 2.03779, Test median  Loss= 0.61218, Best Test Loss= 2.02914
 Val Loss mSEL:0.624751, Test Loss mSEL:0.612180,
 Val acc:0.499370, Test acc:0.506048,
 Val Loss mape:11.415872, Test Loss mape:9.356845,

finish one epoch, time21951.526505708694
#32, Training Loss= nan, Valid Loss= 2.19580, Valid median Loss= 0.63167, Best Valid Loss= 2.19580, Test Loss= 2.01478, Test median  Loss= 0.62201, Best Test Loss= 2.01478
 Val Loss mSEL:0.631675, Test Loss mSEL:0.622006,
 Val acc:0.507182, Test acc:0.510837,
 Val Loss mape:11.816689, Test Loss mape:9.986115,

finish one epoch, time22620.825167894363
#33, Training Loss= nan, Valid Loss= 2.21334, Valid median Loss= 0.59169, Best Valid Loss= 2.19580, Test Loss= 2.01349, Test median  Loss= 0.58508, Best Test Loss= 2.01349
 Val Loss mSEL:0.591695, Test Loss mSEL:0.585085,
 Val acc:0.501638, Test acc:0.506930,
 Val Loss mape:10.522522, Test Loss mape:8.597726,

Finished!
----------------------------------------------------------------
Time: 22978.784113883972
Valid Loss: 2.1957972
Test Loss: 2.0134912
