os.environ: 0
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
1.14.0
WARNING:tensorflow:From run.py:20: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

ok
dataset information: nodes:868901, n_sequence:120, n_steps:17 
===================configuration===================
dropout prob :  0.001
l2 0.05
learning rate :  0.005
emb_learning_rate :  0.005
observation hour [7,19]
observation threshold :  10800
prediction time :  86400
cascade length [10,100]
model save at : ../model_save/deephawkes/weibo/
===================configuration===================
---------***---------
Number: 31951, Max: 14.264955662710035 and Min: 0.0 label Value in Train
NUmber: 6847, Max: 13.772520776314755 and Min: 0.0 label Value in Test
NUmber: 6847, Max: 12.7737573721398 and Min: 0.0 label Value in Valid
---------***---------
31951 6847 6847
  5%|▍         | 31872/640001 [04:29<1:40:54, 100.45it/s]finish one epoch, time270.43444538116455
  5%|▍         | 31872/640001 [04:44<1:40:54, 100.45it/s]
train mseloss : 2.248839098873542
lambda1 [-1.24e-04  1.98e-02  3.62e-02  6.37e-02  9.64e-02  1.79e-01]
#0, Training Loss= 2.24570, Valid Loss= 2.25065, Valid median Loss= 0.81122, Best Valid Loss= 2.25065, Test Loss= 2.19518, Test median  Loss= 0.78960, Best Test Loss= 2.19518
 10%|▉         | 63872/640001 [14:56<1:24:56, 113.04it/s]finish one epoch, time898.2177550792694
 10%|▉         | 63872/640001 [15:11<1:24:56, 113.04it/s]
train mseloss : 2.0835269580434383
lambda1 [-0.    0.01  0.05  0.09  0.11  0.19]
#1, Training Loss= 2.08398, Valid Loss= 2.05957, Valid median Loss= 0.59655, Best Valid Loss= 2.05957, Test Loss= 2.04054, Test median  Loss= 0.62948, Best Test Loss= 2.04054
 15%|█▍        | 95872/640001 [26:00<1:35:01, 95.44it/s] finish one epoch, time1561.5137391090393
 15%|█▍        | 95872/640001 [26:11<1:35:01, 95.44it/s]
train mseloss : 2.0721140959238373
lambda1 [-0.    0.01  0.04  0.08  0.13  0.21]
#2, Training Loss= 2.06600, Valid Loss= 2.04784, Valid median Loss= 0.67191, Best Valid Loss= 2.04784, Test Loss= 2.01909, Test median  Loss= 0.67340, Best Test Loss= 2.01909
 20%|█▉        | 127872/640001 [37:08<1:14:47, 114.12it/s]finish one epoch, time2230.219534635544
 20%|█▉        | 127872/640001 [37:19<1:14:47, 114.12it/s]
train mseloss : 2.13786240948776
lambda1 [-0.    0.01  0.05  0.1   0.14  0.25]
#3, Training Loss= 2.13661, Valid Loss= 2.10872, Valid median Loss= 0.65553, Best Valid Loss= 2.04784, Test Loss= 2.09786, Test median  Loss= 0.65072, Best Test Loss= 2.01909
 25%|██▍       | 159872/640001 [48:12<1:07:03, 119.33it/s]finish one epoch, time2893.8589141368866
 25%|██▍       | 159872/640001 [48:25<1:07:03, 119.33it/s]
train mseloss : 2.069121521806362
lambda1 [-0.    0.01  0.06  0.12  0.15  0.26]
#4, Training Loss= 2.07057, Valid Loss= 2.06748, Valid median Loss= 0.62725, Best Valid Loss= 2.04784, Test Loss= 2.02630, Test median  Loss= 0.62108, Best Test Loss= 2.01909
 30%|██▉       | 191872/640001 [59:17<1:14:30, 100.25it/s]finish one epoch, time3558.4341180324554
 30%|██▉       | 191872/640001 [59:28<1:14:30, 100.25it/s]
train mseloss : 2.043852885189379
lambda1 [-0.    0.03  0.05  0.1   0.18  0.29]
#5, Training Loss= 2.04188, Valid Loss= 2.02516, Valid median Loss= 0.57822, Best Valid Loss= 2.02516, Test Loss= 2.00672, Test median  Loss= 0.58554, Best Test Loss= 2.00672
 35%|███▍      | 223872/640001 [1:10:24<54:20, 127.61it/s]finish one epoch, time4226.561777591705
 35%|███▍      | 223872/640001 [1:10:39<54:20, 127.61it/s]
train mseloss : 2.027083661488704
lambda1 [-0.    0.01  0.04  0.12  0.18  0.3 ]
#6, Training Loss= 2.02829, Valid Loss= 2.02450, Valid median Loss= 0.59627, Best Valid Loss= 2.02450, Test Loss= 1.98520, Test median  Loss= 0.60957, Best Test Loss= 1.98520
 40%|███▉      | 255872/640001 [1:21:29<53:11, 120.36it/s]  finish one epoch, time4890.8408143520355
 40%|███▉      | 255872/640001 [1:21:42<53:11, 120.36it/s]
train mseloss : 2.048412338740257
lambda1 [-0.    0.01  0.04  0.14  0.18  0.31]
#7, Training Loss= 2.05297, Valid Loss= 2.06359, Valid median Loss= 0.59724, Best Valid Loss= 2.02450, Test Loss= 2.00460, Test median  Loss= 0.58942, Best Test Loss= 1.98520
 45%|████▍     | 287872/640001 [1:32:37<1:01:54, 94.79it/s]finish one epoch, time5558.990135908127
 45%|████▍     | 287872/640001 [1:32:53<1:01:54, 94.79it/s]
train mseloss : 2.016851155558443
lambda1 [-0.   -0.    0.04  0.13  0.21  0.33]
WARNING:tensorflow:From /home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/training/saver.py:960: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
#8, Training Loss= 2.01747, Valid Loss= 2.01294, Valid median Loss= 0.62430, Best Valid Loss= 2.01294, Test Loss= 1.95143, Test median  Loss= 0.62626, Best Test Loss= 1.95143
 50%|████▉     | 319872/640001 [1:43:54<43:29, 122.68it/s]finish one epoch, time6236.557069778442
 50%|████▉     | 319872/640001 [1:44:06<43:29, 122.68it/s]
train mseloss : 2.0842422904953146
lambda1 [-0.01  0.01  0.04  0.14  0.2   0.34]
#9, Training Loss= 2.09090, Valid Loss= 2.06296, Valid median Loss= 0.62810, Best Valid Loss= 2.01294, Test Loss= 2.04420, Test median  Loss= 0.62030, Best Test Loss= 1.95143
 55%|█████▍    | 351872/640001 [1:55:05<47:52, 100.30it/s]finish one epoch, time6906.694945335388
 55%|█████▍    | 351872/640001 [1:55:17<47:52, 100.30it/s]
train mseloss : 2.0600697446484095
lambda1 [-0.    0.01  0.05  0.15  0.2   0.33]
#10, Training Loss= 2.05662, Valid Loss= 2.03280, Valid median Loss= 0.65112, Best Valid Loss= 2.01294, Test Loss= 1.99865, Test median  Loss= 0.64376, Best Test Loss= 1.95143
 60%|█████▉    | 383872/640001 [2:06:21<42:31, 100.40it/s]finish one epoch, time7581.905035734177
 60%|█████▉    | 383872/640001 [2:06:40<42:31, 100.40it/s]
train mseloss : 2.047633889640334
lambda1 [-0.    0.04  0.06  0.14  0.21  0.36]
#11, Training Loss= 2.04326, Valid Loss= 2.00289, Valid median Loss= 0.57613, Best Valid Loss= 2.00289, Test Loss= 1.99547, Test median  Loss= 0.59337, Best Test Loss= 1.95143
 65%|██████▍   | 415872/640001 [2:17:35<30:15, 123.42it/s]finish one epoch, time8257.654721021652
 65%|██████▍   | 415872/640001 [2:17:55<30:15, 123.42it/s]
train mseloss : 2.064524779973173
lambda1 [-0.    0.02  0.07  0.14  0.23  0.36]
#12, Training Loss= 2.06201, Valid Loss= 2.05769, Valid median Loss= 0.60486, Best Valid Loss= 2.00289, Test Loss= 2.02510, Test median  Loss= 0.61280, Best Test Loss= 1.95143
 70%|██████▉   | 447872/640001 [2:28:46<25:29, 125.63it/s]finish one epoch, time8928.759521484375
 70%|██████▉   | 447872/640001 [2:28:57<25:29, 125.63it/s]
train mseloss : 2.091389696642719
lambda1 [-0.01  0.01  0.06  0.13  0.21  0.36]
#13, Training Loss= 2.08910, Valid Loss= 2.09008, Valid median Loss= 0.60165, Best Valid Loss= 2.00289, Test Loss= 2.04844, Test median  Loss= 0.61418, Best Test Loss= 1.95143
 75%|███████▍  | 479872/640001 [2:40:05<26:34, 100.44it/s]finish one epoch, time9606.74122428894
 75%|███████▍  | 479872/640001 [2:40:18<26:34, 100.44it/s]
train mseloss : 2.063296505472122
lambda1 [-0.    0.05  0.06  0.11  0.24  0.38]
#14, Training Loss= 2.06059, Valid Loss= 2.05307, Valid median Loss= 0.58075, Best Valid Loss= 2.00289, Test Loss= 2.03415, Test median  Loss= 0.59383, Best Test Loss= 1.95143
 80%|███████▉  | 511872/640001 [2:51:23<18:28, 115.62it/s]finish one epoch, time10285.622575998306
 80%|███████▉  | 511872/640001 [2:51:39<18:28, 115.62it/s]
train mseloss : 2.037967092253977
lambda1 [-0.    0.03  0.03  0.12  0.24  0.37]
#15, Training Loss= 2.03909, Valid Loss= 2.04455, Valid median Loss= 0.57985, Best Valid Loss= 2.00289, Test Loss= 2.00744, Test median  Loss= 0.58821, Best Test Loss= 1.95143
 85%|████████▍ | 543872/640001 [3:02:38<14:26, 111.00it/s]finish one epoch, time10960.307230472565
 85%|████████▍ | 543872/640001 [3:02:51<14:26, 111.00it/s]
train mseloss : 2.1097927788857396
lambda1 [-0.01 -0.    0.06  0.15  0.24  0.37]
#16, Training Loss= 2.10931, Valid Loss= 2.08809, Valid median Loss= 0.62980, Best Valid Loss= 2.00289, Test Loss= 2.06041, Test median  Loss= 0.63175, Best Test Loss= 1.95143
 90%|████████▉ | 575872/640001 [3:14:05<12:04, 88.50it/s] finish one epoch, time11645.99578332901
 90%|████████▉ | 575872/640001 [3:14:21<12:04, 88.50it/s]
train mseloss : 2.0959832974167103
lambda1 [-0.01  0.02  0.04  0.13  0.23  0.4 ]
#17, Training Loss= 2.09218, Valid Loss= 2.08926, Valid median Loss= 0.60015, Best Valid Loss= 2.00289, Test Loss= 2.05119, Test median  Loss= 0.60321, Best Test Loss= 1.95143
 95%|█████████▍| 607872/640001 [3:25:30<04:59, 107.29it/s]finish one epoch, time12331.575643539429
 95%|█████████▍| 607872/640001 [3:25:42<04:59, 107.29it/s]
train mseloss : 2.0582293697750083
lambda1 [-0.01  0.01  0.08  0.17  0.26  0.36]
#18, Training Loss= 2.05829, Valid Loss= 2.03551, Valid median Loss= 0.58594, Best Valid Loss= 2.00289, Test Loss= 2.00722, Test median  Loss= 0.58554, Best Test Loss= 1.95143
100%|█████████▉| 639872/640001 [3:36:25<00:01, 122.70it/s]finish one epoch, time12986.356687307358
100%|█████████▉| 639872/640001 [3:36:37<00:01, 122.70it/s]
train mseloss : 2.161291771794074
lambda1 [-0.    0.01  0.05  0.17  0.25  0.38]
#19, Training Loss= 2.15923, Valid Loss= 2.14229, Valid median Loss= 0.70976, Best Valid Loss= 2.00289, Test Loss= 2.12414, Test median  Loss= 0.70592, Best Test Loss= 1.95143
640128it [3:42:10,  1.75it/s]                            Finished!
----------------------------------------------------------------
Time: 13330.57171010971
Valid Loss: 2.0028937
Test Loss: 1.9514298