os.environ: 0
1.14.0
dataset information: nodes:858664, n_sequence:120, n_steps:17 
===================configuration===================
dropout prob :  0.001
l2 0.05
learning rate :  0.0005
emb_learning_rate :  0.0005
observation hour [7,19]
observation threshold :  7200
prediction time :  86400
cascade length [5,100]
model save at : ../model_save/deephawkes/weibo2/
===================configuration===================
---------***---------
Number: 39522, Max: 15.089202175838759 and Min: 0.0 label Value in Train
NUmber: 8469, Max: 13.518038379578142 and Min: 0.0 label Value in Test
NUmber: 8470, Max: 12.7737573721398 and Min: 0.0 label Value in Valid
---------***---------
39522 8469 8470
Total_parameters:42958455
finish one epoch, time508.67125511169434
#0, Training Loss= nan, Valid Loss= 3.66491, Valid median Loss= 1.60902, Best Valid Loss= 3.66491, Test Loss= 3.63746, Test median  Loss= 1.58007, Best Test Loss= 3.63746
 Val Loss mSEL:1.609019, Test Loss mSEL:1.580073,
 Val acc:0.235085, Test acc:0.237926,
 Val Loss mape:19.986418, Test Loss mape:18.558076,

finish one epoch, time1232.489821434021
#1, Training Loss= nan, Valid Loss= 2.41474, Valid median Loss= 0.71527, Best Valid Loss= 2.41474, Test Loss= 2.35378, Test median  Loss= 0.69552, Best Test Loss= 2.35378
 Val Loss mSEL:0.715270, Test Loss mSEL:0.695518,
 Val acc:0.427083, Test acc:0.430871,
 Val Loss mape:22.582117, Test Loss mape:20.720998,

finish one epoch, time1965.7439589500427
#2, Training Loss= nan, Valid Loss= 2.37209, Valid median Loss= 0.70009, Best Valid Loss= 2.37209, Test Loss= 2.30583, Test median  Loss= 0.70622, Best Test Loss= 2.30583
 Val Loss mSEL:0.700086, Test Loss mSEL:0.706224,
 Val acc:0.432884, Test acc:0.435606,
 Val Loss mape:22.460248, Test Loss mape:20.722396,

finish one epoch, time2720.0025198459625
#3, Training Loss= nan, Valid Loss= 2.34356, Valid median Loss= 0.68798, Best Valid Loss= 2.34356, Test Loss= 2.29016, Test median  Loss= 0.67481, Best Test Loss= 2.29016
 Val Loss mSEL:0.687984, Test Loss mSEL:0.674813,
 Val acc:0.444602, Test acc:0.447206,
 Val Loss mape:22.564785, Test Loss mape:20.822171,

finish one epoch, time3474.971764087677
#4, Training Loss= nan, Valid Loss= 2.33035, Valid median Loss= 0.66510, Best Valid Loss= 2.33035, Test Loss= 2.27048, Test median  Loss= 0.66700, Best Test Loss= 2.27048
 Val Loss mSEL:0.665104, Test Loss mSEL:0.666999,
 Val acc:0.453835, Test acc:0.456558,
 Val Loss mape:22.592270, Test Loss mape:20.813976,

finish one epoch, time4223.4087109565735
#5, Training Loss= nan, Valid Loss= 2.33433, Valid median Loss= 0.67055, Best Valid Loss= 2.33035, Test Loss= 2.26838, Test median  Loss= 0.66402, Best Test Loss= 2.26838
 Val Loss mSEL:0.670554, Test Loss mSEL:0.664025,
 Val acc:0.449100, Test acc:0.454427,
 Val Loss mape:22.751820, Test Loss mape:20.871105,

finish one epoch, time4978.589811086655
#6, Training Loss= nan, Valid Loss= 2.34084, Valid median Loss= 0.69302, Best Valid Loss= 2.33035, Test Loss= 2.27386, Test median  Loss= 0.68977, Best Test Loss= 2.26838
 Val Loss mSEL:0.693024, Test Loss mSEL:0.689773,
 Val acc:0.436316, Test acc:0.439867,
 Val Loss mape:21.953113, Test Loss mape:20.045593,

finish one epoch, time5737.1402180194855
#7, Training Loss= nan, Valid Loss= 2.33177, Valid median Loss= 0.65797, Best Valid Loss= 2.33035, Test Loss= 2.27430, Test median  Loss= 0.65432, Best Test Loss= 2.26838
 Val Loss mSEL:0.657968, Test Loss mSEL:0.654325,
 Val acc:0.457505, Test acc:0.459517,
 Val Loss mape:22.983743, Test Loss mape:21.153712,

finish one epoch, time6488.365376234055
#8, Training Loss= nan, Valid Loss= 2.33772, Valid median Loss= 0.64383, Best Valid Loss= 2.33035, Test Loss= 2.27844, Test median  Loss= 0.63574, Best Test Loss= 2.26838
 Val Loss mSEL:0.643826, Test Loss mSEL:0.635744,
 Val acc:0.456676, Test acc:0.460819,
 Val Loss mape:23.282295, Test Loss mape:21.462439,

finish one epoch, time7247.8088002204895
#9, Training Loss= nan, Valid Loss= 2.32478, Valid median Loss= 0.66293, Best Valid Loss= 2.32478, Test Loss= 2.26943, Test median  Loss= 0.65046, Best Test Loss= 2.26838
 Val Loss mSEL:0.662930, Test Loss mSEL:0.650455,
 Val acc:0.451823, Test acc:0.457741,
 Val Loss mape:22.221613, Test Loss mape:20.492821,

finish one epoch, time8007.935864686966
#10, Training Loss= nan, Valid Loss= 2.32419, Valid median Loss= 0.65505, Best Valid Loss= 2.32419, Test Loss= 2.26823, Test median  Loss= 0.65673, Best Test Loss= 2.26823
 Val Loss mSEL:0.655053, Test Loss mSEL:0.656731,
 Val acc:0.450402, Test acc:0.454901,
 Val Loss mape:22.486002, Test Loss mape:20.716613,

finish one epoch, time8780.409239768982
#11, Training Loss= nan, Valid Loss= 2.21780, Valid median Loss= 0.63286, Best Valid Loss= 2.21780, Test Loss= 2.15588, Test median  Loss= 0.62069, Best Test Loss= 2.15588
 Val Loss mSEL:0.632859, Test Loss mSEL:0.620687,
 Val acc:0.461884, Test acc:0.465199,
 Val Loss mape:20.991839, Test Loss mape:19.224880,

finish one epoch, time9545.13818359375
#12, Training Loss= nan, Valid Loss= 2.06643, Valid median Loss= 0.63087, Best Valid Loss= 2.06643, Test Loss= 2.03341, Test median  Loss= 0.63863, Best Test Loss= 2.03341
 Val Loss mSEL:0.630874, Test Loss mSEL:0.638629,
 Val acc:0.462121, Test acc:0.460701,
 Val Loss mape:18.147079, Test Loss mape:16.908003,

finish one epoch, time10294.664479732513
#13, Training Loss= nan, Valid Loss= 2.02299, Valid median Loss= 0.57510, Best Valid Loss= 2.02299, Test Loss= 1.99560, Test median  Loss= 0.59876, Best Test Loss= 1.99560
 Val Loss mSEL:0.575104, Test Loss mSEL:0.598763,
 Val acc:0.458333, Test acc:0.455019,
 Val Loss mape:15.397461, Test Loss mape:14.423618,

finish one epoch, time11061.389659881592
#14, Training Loss= nan, Valid Loss= 1.99546, Valid median Loss= 0.59420, Best Valid Loss= 1.99546, Test Loss= 1.96786, Test median  Loss= 0.60368, Best Test Loss= 1.96786
 Val Loss mSEL:0.594200, Test Loss mSEL:0.603676,
 Val acc:0.460938, Test acc:0.458688,
 Val Loss mape:16.018312, Test Loss mape:14.954797,

finish one epoch, time11833.338509321213
#15, Training Loss= nan, Valid Loss= 1.98202, Valid median Loss= 0.57682, Best Valid Loss= 1.98202, Test Loss= 1.94397, Test median  Loss= 0.59532, Best Test Loss= 1.94397
 Val Loss mSEL:0.576817, Test Loss mSEL:0.595322,
 Val acc:0.462831, Test acc:0.460819,
 Val Loss mape:15.592134, Test Loss mape:14.563480,

finish one epoch, time12597.813436746597
#16, Training Loss= nan, Valid Loss= 1.97469, Valid median Loss= 0.60086, Best Valid Loss= 1.97469, Test Loss= 1.95277, Test median  Loss= 0.61108, Best Test Loss= 1.94397
 Val Loss mSEL:0.600859, Test Loss mSEL:0.611084,
 Val acc:0.471828, Test acc:0.469815,
 Val Loss mape:17.643528, Test Loss mape:16.400680,

finish one epoch, time13350.635637521744
#17, Training Loss= nan, Valid Loss= 1.96721, Valid median Loss= 0.55830, Best Valid Loss= 1.96721, Test Loss= 1.92728, Test median  Loss= 0.57270, Best Test Loss= 1.92728
 Val Loss mSEL:0.558302, Test Loss mSEL:0.572695,
 Val acc:0.470644, Test acc:0.467921,
 Val Loss mape:15.928108, Test Loss mape:14.831415,

finish one epoch, time14098.566064119339
#18, Training Loss= nan, Valid Loss= 1.97043, Valid median Loss= 0.56677, Best Valid Loss= 1.96721, Test Loss= 1.94576, Test median  Loss= 0.58234, Best Test Loss= 1.92728
 Val Loss mSEL:0.566771, Test Loss mSEL:0.582336,
 Val acc:0.460819, Test acc:0.456439,
 Val Loss mape:15.618849, Test Loss mape:14.597004,

finish one epoch, time14857.410804748535
#19, Training Loss= nan, Valid Loss= 1.94416, Valid median Loss= 0.55406, Best Valid Loss= 1.94416, Test Loss= 1.92611, Test median  Loss= 0.56957, Best Test Loss= 1.92611
 Val Loss mSEL:0.554057, Test Loss mSEL:0.569569,
 Val acc:0.467211, Test acc:0.458688,
 Val Loss mape:14.518652, Test Loss mape:13.571020,

finish one epoch, time15625.215056180954
#20, Training Loss= nan, Valid Loss= 1.94025, Valid median Loss= 0.55310, Best Valid Loss= 1.94025, Test Loss= 1.91549, Test median  Loss= 0.57050, Best Test Loss= 1.91549
 Val Loss mSEL:0.553100, Test Loss mSEL:0.570501,
 Val acc:0.470052, Test acc:0.460582,
 Val Loss mape:14.996094, Test Loss mape:14.054242,

finish one epoch, time16382.980262517929
#21, Training Loss= nan, Valid Loss= 1.94271, Valid median Loss= 0.55739, Best Valid Loss= 1.94025, Test Loss= 1.91494, Test median  Loss= 0.56627, Best Test Loss= 1.91494
 Val Loss mSEL:0.557386, Test Loss mSEL:0.566271,
 Val acc:0.467803, Test acc:0.462713,
 Val Loss mape:15.526612, Test Loss mape:14.514322,

finish one epoch, time17146.409796237946
#22, Training Loss= nan, Valid Loss= 1.93758, Valid median Loss= 0.54075, Best Valid Loss= 1.93758, Test Loss= 1.92534, Test median  Loss= 0.55448, Best Test Loss= 1.91494
 Val Loss mSEL:0.540751, Test Loss mSEL:0.554480,
 Val acc:0.465436, Test acc:0.458807,
 Val Loss mape:13.922747, Test Loss mape:13.077455,

finish one epoch, time17911.601884126663
#23, Training Loss= nan, Valid Loss= 1.94543, Valid median Loss= 0.55257, Best Valid Loss= 1.93758, Test Loss= 1.91895, Test median  Loss= 0.55851, Best Test Loss= 1.91494
 Val Loss mSEL:0.552575, Test Loss mSEL:0.558512,
 Val acc:0.459635, Test acc:0.456084,
 Val Loss mape:13.798595, Test Loss mape:12.795601,

finish one epoch, time18685.59922671318
#24, Training Loss= nan, Valid Loss= 1.92448, Valid median Loss= 0.54356, Best Valid Loss= 1.92448, Test Loss= 1.90921, Test median  Loss= 0.56434, Best Test Loss= 1.90921
 Val Loss mSEL:0.543563, Test Loss mSEL:0.564340,
 Val acc:0.471591, Test acc:0.461766,
 Val Loss mape:14.585019, Test Loss mape:13.637955,

finish one epoch, time19447.001224040985
#25, Training Loss= nan, Valid Loss= 1.92907, Valid median Loss= 0.54246, Best Valid Loss= 1.92448, Test Loss= 1.91704, Test median  Loss= 0.54464, Best Test Loss= 1.90921
 Val Loss mSEL:0.542457, Test Loss mSEL:0.544638,
 Val acc:0.468513, Test acc:0.461411,
 Val Loss mape:14.083840, Test Loss mape:13.104623,

finish one epoch, time20222.721696138382
#26, Training Loss= nan, Valid Loss= 1.92501, Valid median Loss= 0.54358, Best Valid Loss= 1.92448, Test Loss= 1.91133, Test median  Loss= 0.55883, Best Test Loss= 1.90921
 Val Loss mSEL:0.543585, Test Loss mSEL:0.558830,
 Val acc:0.468040, Test acc:0.460109,
 Val Loss mape:14.085787, Test Loss mape:13.072179,

finish one epoch, time20989.796117782593
#27, Training Loss= nan, Valid Loss= 1.93031, Valid median Loss= 0.53133, Best Valid Loss= 1.92448, Test Loss= 1.90412, Test median  Loss= 0.54423, Best Test Loss= 1.90412
 Val Loss mSEL:0.531331, Test Loss mSEL:0.544229,
 Val acc:0.461174, Test acc:0.460346,
 Val Loss mape:13.947572, Test Loss mape:13.071303,

finish one epoch, time21742.722418785095
#28, Training Loss= nan, Valid Loss= 1.91617, Valid median Loss= 0.52639, Best Valid Loss= 1.91617, Test Loss= 1.89352, Test median  Loss= 0.54665, Best Test Loss= 1.89352
 Val Loss mSEL:0.526385, Test Loss mSEL:0.546646,
 Val acc:0.470644, Test acc:0.465791,
 Val Loss mape:14.122592, Test Loss mape:13.245182,

finish one epoch, time22511.450541734695
#29, Training Loss= nan, Valid Loss= 1.92824, Valid median Loss= 0.53698, Best Valid Loss= 1.91617, Test Loss= 1.89629, Test median  Loss= 0.54401, Best Test Loss= 1.89352
 Val Loss mSEL:0.536980, Test Loss mSEL:0.544012,
 Val acc:0.475971, Test acc:0.469697,
 Val Loss mape:15.521683, Test Loss mape:14.473282,

finish one epoch, time23275.544588327408
#30, Training Loss= nan, Valid Loss= 1.93126, Valid median Loss= 0.53363, Best Valid Loss= 1.91617, Test Loss= 1.91025, Test median  Loss= 0.53821, Best Test Loss= 1.89352
 Val Loss mSEL:0.533628, Test Loss mSEL:0.538212,
 Val acc:0.464844, Test acc:0.461411,
 Val Loss mape:13.984656, Test Loss mape:13.036500,

finish one epoch, time24052.39481163025
#31, Training Loss= nan, Valid Loss= 1.92504, Valid median Loss= 0.54361, Best Valid Loss= 1.91617, Test Loss= 1.90576, Test median  Loss= 0.54382, Best Test Loss= 1.89352
 Val Loss mSEL:0.543609, Test Loss mSEL:0.543821,
 Val acc:0.471709, Test acc:0.466146,
 Val Loss mape:14.461173, Test Loss mape:13.455311,

Finished!
----------------------------------------------------------------
Time: 24467.32310938835
Valid Loss: 1.9161724
Test Loss: 1.8935233
