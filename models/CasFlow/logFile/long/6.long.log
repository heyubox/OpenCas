===================configuration===================
learning rate :  0.0005
observation hour [7,19]
observation threshold :  6
prediction time :  86400
cascade length [10,1000]
model save at : ../model_save/casflow/dblp1/
===================configuration===================
TF Version: 2.0.0
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 100, 80)]    0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 100, 80)      320         input_1[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape (TensorFlow [(None, 80)]         0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
sampling (Sampling)             (None, 64)           0           dense_2[0][0]                    
                                                                 dense_3[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape_2 (TensorFl [(None, 100, 64)]    0           sampling[0][0]                   
__________________________________________________________________________________________________
sequential (Sequential)         (None, 128)          1020544     tf_op_layer_Reshape_2[0][0]      
__________________________________________________________________________________________________
tf_op_layer_split (TensorFlowOp [(None, 64), (None,  0           sequential[1][0]                 
__________________________________________________________________________________________________
sampling_1 (Sampling)           (None, 64)           0           tf_op_layer_split[0][0]          
                                                                 tf_op_layer_split[0][1]          
__________________________________________________________________________________________________
planar_flow_layer1 (PlanarFlowL ((None, 64), (None,) 129         sampling_1[0][0]                 
__________________________________________________________________________________________________
planar_flow_layer (PlanarFlowLa ((None, 64), (None,) 129         planar_flow_layer1[0][0]         
                                                                 planar_flow_layer1[0][1]         
__________________________________________________________________________________________________
planar_flow_layer_1 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer[0][0]          
                                                                 planar_flow_layer[0][1]          
__________________________________________________________________________________________________
planar_flow_layer_2 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_1[0][0]        
                                                                 planar_flow_layer_1[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_3 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_2[0][0]        
                                                                 planar_flow_layer_2[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_4 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_3[0][0]        
                                                                 planar_flow_layer_3[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_5 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_4[0][0]        
                                                                 planar_flow_layer_4[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_6 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_5[0][0]        
                                                                 planar_flow_layer_5[0][1]        
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 100, 512)     519168      batch_normalization[0][0]        
__________________________________________________________________________________________________
planar_flow_layer_7 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_6[0][0]        
                                                                 planar_flow_layer_6[0][1]        
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 256)          493056      bidirectional_2[0][0]            
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 320)          0           planar_flow_layer_7[0][0]        
                                                                 bidirectional_3[0][0]            
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          41088       concatenate[0][0]                
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            65          dense_6[0][0]                    
==================================================================================================
Total params: 2,094,026
Trainable params: 2,093,866
Non-trainable params: 160
__________________________________________________________________________________________________
None
Epoch 1/10
774/774 [==============================] - 1547s 2s/step - loss: -32.3325 - mape: 1.1350 - msle_log2: 1.8790 - val_loss: -75.2400 - val_mape: 0.8310 - val_msle_log2: 1.4766
Epoch 2/10
774/774 [==============================] - 1439s 2s/step - loss: -89.8618 - mape: 0.9954 - msle_log2: 1.4127 - val_loss: -75.1649 - val_mape: 1.1050 - val_msle_log2: 1.4194
Epoch 3/10
774/774 [==============================] - 1445s 2s/step - loss: -85.1289 - mape: 0.9777 - msle_log2: 1.3727 - val_loss: -105.1023 - val_mape: 0.8679 - val_msle_log2: 1.3850
Epoch 4/10
774/774 [==============================] - 1445s 2s/step - loss: -109.6729 - mape: 0.9677 - msle_log2: 1.3529 - val_loss: -111.7412 - val_mape: 0.9780 - val_msle_log2: 1.3615
Epoch 5/10
774/774 [==============================] - 1043s 1s/step - loss: -113.2666 - mape: 0.9539 - msle_log2: 1.3308 - val_loss: -115.4699 - val_mape: 1.0414 - val_msle_log2: 1.3472
Epoch 6/10
774/774 [==============================] - 1003s 1s/step - loss: -116.4958 - mape: 0.9494 - msle_log2: 1.3209 - val_loss: -119.4554 - val_mape: 1.0354 - val_msle_log2: 1.3567
Epoch 7/10
774/774 [==============================] - 1026s 1s/step - loss: -119.5873 - mape: 0.9484 - msle_log2: 1.3143 - val_loss: -123.9635 - val_mape: 1.0271 - val_msle_log2: 1.3486
Epoch 8/10
774/774 [==============================] - 931s 1s/step - loss: -122.1609 - mape: 0.9383 - msle_log2: 1.2967 - val_loss: -124.5979 - val_mape: 0.9890 - val_msle_log2: 1.3627
Epoch 9/10
774/774 [==============================] - 910s 1s/step - loss: -116.5799 - mape: 0.9338 - msle_log2: 1.2907 - val_loss: -92.7841 - val_mape: 0.9706 - val_msle_log2: 1.3261
Epoch 10/10
774/774 [==============================] - 932s 1s/step - loss: -53.7519 - mape: 0.9291 - msle_log2: 1.2795 - val_loss: -10.3591 - val_mape: 0.8567 - val_msle_log2: 1.3495
Training ended!
166/166 [==============================] - 63s 378ms/step - loss: -10.3747 - mape: 0.8709 - msle_log2: 1.3552
2.4509404886965034
Finished! Time used: 198.093mins.

test MSEL 1.6050173515732524
test mape 0.9880626792591267
test mSEL 0.6119171847046379
test acc 0.2042260164135459
val MSEL 1.5951924794439365
val mape 0.978332007539925
val mSEL 0.6088509837647518
val acc 0.19864176570458403
Finished! Time used: 3.879mins.