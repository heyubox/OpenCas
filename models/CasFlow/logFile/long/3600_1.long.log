===================configuration===================
learning rate :  0.0005
observation hour [7,19]
observation threshold :  3600
prediction time :  86400
cascade length [5,1000]
model save at : ../model_save/casflow/weibo1/
===================configuration===================
TF Version: 2.0.0
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 100, 80)]    0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 100, 80)      320         input_1[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape (TensorFlow [(None, 80)]         0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
sampling (Sampling)             (None, 64)           0           dense_2[0][0]                    
                                                                 dense_3[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape_2 (TensorFl [(None, 100, 64)]    0           sampling[0][0]                   
__________________________________________________________________________________________________
sequential (Sequential)         (None, 128)          1020544     tf_op_layer_Reshape_2[0][0]      
__________________________________________________________________________________________________
tf_op_layer_split (TensorFlowOp [(None, 64), (None,  0           sequential[1][0]                 
__________________________________________________________________________________________________
sampling_1 (Sampling)           (None, 64)           0           tf_op_layer_split[0][0]          
                                                                 tf_op_layer_split[0][1]          
__________________________________________________________________________________________________
planar_flow_layer1 (PlanarFlowL ((None, 64), (None,) 129         sampling_1[0][0]                 
__________________________________________________________________________________________________
planar_flow_layer (PlanarFlowLa ((None, 64), (None,) 129         planar_flow_layer1[0][0]         
                                                                 planar_flow_layer1[0][1]         
__________________________________________________________________________________________________
planar_flow_layer_1 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer[0][0]          
                                                                 planar_flow_layer[0][1]          
__________________________________________________________________________________________________
planar_flow_layer_2 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_1[0][0]        
                                                                 planar_flow_layer_1[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_3 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_2[0][0]        
                                                                 planar_flow_layer_2[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_4 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_3[0][0]        
                                                                 planar_flow_layer_3[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_5 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_4[0][0]        
                                                                 planar_flow_layer_4[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_6 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_5[0][0]        
                                                                 planar_flow_layer_5[0][1]        
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 100, 512)     519168      batch_normalization[0][0]        
__________________________________________________________________________________________________
planar_flow_layer_7 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_6[0][0]        
                                                                 planar_flow_layer_6[0][1]        
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 256)          493056      bidirectional_2[0][0]            
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 320)          0           planar_flow_layer_7[0][0]        
                                                                 bidirectional_3[0][0]            
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          41088       concatenate[0][0]                
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            65          dense_6[0][0]                    
==================================================================================================
Total params: 2,094,026
Trainable params: 2,093,866
Non-trainable params: 160
__________________________________________________________________________________________________
None
Epoch 1/10
649/649 [==============================] - 1652s 3s/step - loss: 677.7615 - mape: 1.5795 - msle_log2: 2.8298 - val_loss: -57.9372 - val_mape: 1.4206 - val_msle_log2: 2.0896
Epoch 2/10
649/649 [==============================] - 1540s 2s/step - loss: 3.3368 - mape: 1.3380 - msle_log2: 2.0656 - val_loss: 340.7859 - val_mape: 1.2149 - val_msle_log2: 1.9674
Epoch 3/10
649/649 [==============================] - 1552s 2s/step - loss: -75.6702 - mape: 1.2359 - msle_log2: 1.9400 - val_loss: 241.3063 - val_mape: 1.3239 - val_msle_log2: 1.9242
Epoch 4/10
649/649 [==============================] - 1555s 2s/step - loss: -94.1007 - mape: 1.1550 - msle_log2: 1.8630 - val_loss: 41.3119 - val_mape: 1.1763 - val_msle_log2: 1.8773
Epoch 5/10
649/649 [==============================] - 1246s 2s/step - loss: -101.9007 - mape: 1.1070 - msle_log2: 1.7891 - val_loss: -10.0530 - val_mape: 1.1397 - val_msle_log2: 1.8432
Epoch 6/10
649/649 [==============================] - 1312s 2s/step - loss: -34.3561 - mape: 1.0851 - msle_log2: 1.7405 - val_loss: 58.5918 - val_mape: 1.0238 - val_msle_log2: 1.8751
Epoch 7/10
649/649 [==============================] - 1214s 2s/step - loss: 9.2303 - mape: 1.0307 - msle_log2: 1.6921 - val_loss: 43.9355 - val_mape: 1.2128 - val_msle_log2: 1.8764
Epoch 8/10
649/649 [==============================] - 1235s 2s/step - loss: 7.7728 - mape: 0.9809 - msle_log2: 1.6289 - val_loss: 25.0363 - val_mape: 1.2889 - val_msle_log2: 1.8770
Epoch 9/10
649/649 [==============================] - 1217s 2s/step - loss: 6.0527 - mape: 0.9478 - msle_log2: 1.5520 - val_loss: 16.3906 - val_mape: 1.2518 - val_msle_log2: 1.8678
Epoch 10/10
649/649 [==============================] - 1230s 2s/step - loss: 5.3615 - mape: 0.8949 - msle_log2: 1.4722 - val_loss: 16.7627 - val_mape: 1.1468 - val_msle_log2: 1.8999
Training ended!
139/139 [==============================] - 125s 900ms/step - loss: 20.5287 - mape: 1.0885 - msle_log2: 1.8819
4.251847193652473
Finished! Time used: 233.725mins.

test MSEL 2.327099343070971
test mape 1.4671480051699743
test mSEL 0.6503831359091437
test acc 0.20209294475075953
val MSEL 2.301315720831907
val mape 1.372052724814483
val mSEL 0.621978321131559
val acc 0.2042079207920792
Finished! Time used: 3.618mins.