===================configuration===================
learning rate :  0.0005
observation hour [7,19]
observation threshold :  7
prediction time :  86400
cascade length [10,100]
model save at : ../model_save/casflow/dblp3/
===================configuration===================
TF Version: 2.0.0
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 100, 80)]    0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 100, 80)      320         input_1[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape (TensorFlow [(None, 80)]         0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
sampling (Sampling)             (None, 64)           0           dense_2[0][0]                    
                                                                 dense_3[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape_2 (TensorFl [(None, 100, 64)]    0           sampling[0][0]                   
__________________________________________________________________________________________________
sequential (Sequential)         (None, 128)          1020544     tf_op_layer_Reshape_2[0][0]      
__________________________________________________________________________________________________
tf_op_layer_split (TensorFlowOp [(None, 64), (None,  0           sequential[1][0]                 
__________________________________________________________________________________________________
sampling_1 (Sampling)           (None, 64)           0           tf_op_layer_split[0][0]          
                                                                 tf_op_layer_split[0][1]          
__________________________________________________________________________________________________
planar_flow_layer1 (PlanarFlowL ((None, 64), (None,) 129         sampling_1[0][0]                 
__________________________________________________________________________________________________
planar_flow_layer (PlanarFlowLa ((None, 64), (None,) 129         planar_flow_layer1[0][0]         
                                                                 planar_flow_layer1[0][1]         
__________________________________________________________________________________________________
planar_flow_layer_1 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer[0][0]          
                                                                 planar_flow_layer[0][1]          
__________________________________________________________________________________________________
planar_flow_layer_2 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_1[0][0]        
                                                                 planar_flow_layer_1[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_3 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_2[0][0]        
                                                                 planar_flow_layer_2[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_4 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_3[0][0]        
                                                                 planar_flow_layer_3[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_5 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_4[0][0]        
                                                                 planar_flow_layer_4[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_6 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_5[0][0]        
                                                                 planar_flow_layer_5[0][1]        
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 100, 512)     519168      batch_normalization[0][0]        
__________________________________________________________________________________________________
planar_flow_layer_7 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_6[0][0]        
                                                                 planar_flow_layer_6[0][1]        
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 256)          493056      bidirectional_2[0][0]            
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 320)          0           planar_flow_layer_7[0][0]        
                                                                 bidirectional_3[0][0]            
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          41088       concatenate[0][0]                
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            65          dense_6[0][0]                    
==================================================================================================
Total params: 2,094,026
Trainable params: 2,093,866
Non-trainable params: 160
__________________________________________________________________________________________________
None
Epoch 1/10
