===================configuration===================
learning rate :  0.0005
observation hour [7,19]
observation threshold :  3600
prediction time :  86400
cascade length [5,100]
model save at : ../model_save/casflow/weibo1/
===================configuration===================
TF Version: 2.0.0
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 100, 80)]    0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 100, 80)      320         input_1[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape (TensorFlow [(None, 80)]         0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
sampling (Sampling)             (None, 64)           0           dense_2[0][0]                    
                                                                 dense_3[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape_2 (TensorFl [(None, 100, 64)]    0           sampling[0][0]                   
__________________________________________________________________________________________________
sequential (Sequential)         (None, 128)          1020544     tf_op_layer_Reshape_2[0][0]      
__________________________________________________________________________________________________
tf_op_layer_split (TensorFlowOp [(None, 64), (None,  0           sequential[1][0]                 
__________________________________________________________________________________________________
sampling_1 (Sampling)           (None, 64)           0           tf_op_layer_split[0][0]          
                                                                 tf_op_layer_split[0][1]          
__________________________________________________________________________________________________
planar_flow_layer1 (PlanarFlowL ((None, 64), (None,) 129         sampling_1[0][0]                 
__________________________________________________________________________________________________
planar_flow_layer (PlanarFlowLa ((None, 64), (None,) 129         planar_flow_layer1[0][0]         
                                                                 planar_flow_layer1[0][1]         
__________________________________________________________________________________________________
planar_flow_layer_1 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer[0][0]          
                                                                 planar_flow_layer[0][1]          
__________________________________________________________________________________________________
planar_flow_layer_2 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_1[0][0]        
                                                                 planar_flow_layer_1[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_3 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_2[0][0]        
                                                                 planar_flow_layer_2[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_4 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_3[0][0]        
                                                                 planar_flow_layer_3[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_5 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_4[0][0]        
                                                                 planar_flow_layer_4[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_6 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_5[0][0]        
                                                                 planar_flow_layer_5[0][1]        
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 100, 512)     519168      batch_normalization[0][0]        
__________________________________________________________________________________________________
planar_flow_layer_7 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_6[0][0]        
                                                                 planar_flow_layer_6[0][1]        
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 256)          493056      bidirectional_2[0][0]            
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 320)          0           planar_flow_layer_7[0][0]        
                                                                 bidirectional_3[0][0]            
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          41088       concatenate[0][0]                
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            65          dense_6[0][0]                    
==================================================================================================
Total params: 2,094,026
Trainable params: 2,093,866
Non-trainable params: 160
__________________________________________________________________________________________________
None
Epoch 1/10
582/582 [==============================] - 472s 811ms/step - loss: -12.7593 - mape: 1.3248 - msle_log2: 2.3940 - val_loss: -59.9187 - val_mape: 0.9265 - val_msle_log2: 2.0933
Epoch 2/10
582/582 [==============================] - 449s 772ms/step - loss: -76.0772 - mape: 1.1056 - msle_log2: 1.8839 - val_loss: -87.5739 - val_mape: 1.0774 - val_msle_log2: 1.9093
Epoch 3/10
582/582 [==============================] - 438s 753ms/step - loss: -89.7514 - mape: 1.0440 - msle_log2: 1.7824 - val_loss: -65.3636 - val_mape: 1.2305 - val_msle_log2: 1.9208
Epoch 4/10
582/582 [==============================] - 455s 782ms/step - loss: -71.3083 - mape: 1.0173 - msle_log2: 1.7200 - val_loss: -83.6347 - val_mape: 1.0973 - val_msle_log2: 1.8439
Epoch 5/10
582/582 [==============================] - 438s 753ms/step - loss: -105.1148 - mape: 0.9837 - msle_log2: 1.6720 - val_loss: -109.4817 - val_mape: 1.0028 - val_msle_log2: 1.8395
Epoch 6/10
582/582 [==============================] - 453s 778ms/step - loss: -110.5182 - mape: 0.9579 - msle_log2: 1.6167 - val_loss: -109.3933 - val_mape: 0.9608 - val_msle_log2: 1.8291
Epoch 7/10
582/582 [==============================] - 449s 771ms/step - loss: -113.5383 - mape: 0.9344 - msle_log2: 1.5693 - val_loss: -111.8573 - val_mape: 0.9777 - val_msle_log2: 1.8303
Epoch 8/10
582/582 [==============================] - 442s 759ms/step - loss: -112.0152 - mape: 0.9002 - msle_log2: 1.5158 - val_loss: -118.6902 - val_mape: 1.1631 - val_msle_log2: 1.8336
Epoch 9/10
582/582 [==============================] - 458s 787ms/step - loss: -118.6545 - mape: 0.8764 - msle_log2: 1.4618 - val_loss: -119.8802 - val_mape: 1.0069 - val_msle_log2: 1.8284
Epoch 10/10
582/582 [==============================] - 437s 751ms/step - loss: -120.7573 - mape: 0.8427 - msle_log2: 1.4014 - val_loss: -118.4264 - val_mape: 1.1614 - val_msle_log2: 1.8761
Training ended!
125/125 [==============================] - 40s 318ms/step - loss: -118.4734 - mape: 1.1555 - msle_log2: 1.8073
4.309076736591888
Finished! Time used: 76.371mins.
test MSEL 2.049075789520777
test mape 0.9877831654285626
test mSEL 0.5478551850260185
test acc 0.22762597142140886
val MSEL 2.064405915515087
val mape 0.974517823199382
val mSEL 0.5202013519135966
val acc 0.22938079719227877
Finished! Time used: 4.777mins.