===================configuration===================
learning rate :  0.0005
observation hour [7,19]
observation threshold :  6
prediction time :  86400
cascade length [10,100]
model save at : ../model_save/casflow/dblp1/
===================configuration===================
TF Version: 2.0.0
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 100, 80)]    0                                            
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 100, 80)      320         input_1[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape (TensorFlow [(None, 80)]         0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           5184        tf_op_layer_Reshape[0][0]        
__________________________________________________________________________________________________
sampling (Sampling)             (None, 64)           0           dense_2[0][0]                    
                                                                 dense_3[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_Reshape_2 (TensorFl [(None, 100, 64)]    0           sampling[0][0]                   
__________________________________________________________________________________________________
sequential (Sequential)         (None, 128)          1020544     tf_op_layer_Reshape_2[0][0]      
__________________________________________________________________________________________________
tf_op_layer_split (TensorFlowOp [(None, 64), (None,  0           sequential[1][0]                 
__________________________________________________________________________________________________
sampling_1 (Sampling)           (None, 64)           0           tf_op_layer_split[0][0]          
                                                                 tf_op_layer_split[0][1]          
__________________________________________________________________________________________________
planar_flow_layer1 (PlanarFlowL ((None, 64), (None,) 129         sampling_1[0][0]                 
__________________________________________________________________________________________________
planar_flow_layer (PlanarFlowLa ((None, 64), (None,) 129         planar_flow_layer1[0][0]         
                                                                 planar_flow_layer1[0][1]         
__________________________________________________________________________________________________
planar_flow_layer_1 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer[0][0]          
                                                                 planar_flow_layer[0][1]          
__________________________________________________________________________________________________
planar_flow_layer_2 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_1[0][0]        
                                                                 planar_flow_layer_1[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_3 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_2[0][0]        
                                                                 planar_flow_layer_2[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_4 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_3[0][0]        
                                                                 planar_flow_layer_3[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_5 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_4[0][0]        
                                                                 planar_flow_layer_4[0][1]        
__________________________________________________________________________________________________
planar_flow_layer_6 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_5[0][0]        
                                                                 planar_flow_layer_5[0][1]        
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 100, 512)     519168      batch_normalization[0][0]        
__________________________________________________________________________________________________
planar_flow_layer_7 (PlanarFlow ((None, 64), (None,) 129         planar_flow_layer_6[0][0]        
                                                                 planar_flow_layer_6[0][1]        
__________________________________________________________________________________________________
bidirectional_3 (Bidirectional) (None, 256)          493056      bidirectional_2[0][0]            
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 320)          0           planar_flow_layer_7[0][0]        
                                                                 bidirectional_3[0][0]            
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 128)          41088       concatenate[0][0]                
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 64)           8256        dense_5[0][0]                    
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 1)            65          dense_6[0][0]                    
==================================================================================================
Total params: 2,094,026
Trainable params: 2,093,866
Non-trainable params: 160
__________________________________________________________________________________________________
None
Epoch 1/10
760/760 [==============================] - 620s 815ms/step - loss: -31.1167 - mape: 1.1478 - msle_log2: 1.8011 - val_loss: -74.1065 - val_mape: 1.2932 - val_msle_log2: 1.5354
Epoch 2/10
760/760 [==============================] - 712s 936ms/step - loss: -88.4900 - mape: 0.9933 - msle_log2: 1.4028 - val_loss: -100.3348 - val_mape: 1.0637 - val_msle_log2: 1.3961
Epoch 3/10
760/760 [==============================] - 749s 986ms/step - loss: -104.7434 - mape: 0.9713 - msle_log2: 1.3593 - val_loss: -109.6790 - val_mape: 0.9694 - val_msle_log2: 1.3812
Epoch 4/10
760/760 [==============================] - 654s 860ms/step - loss: -112.4298 - mape: 0.9601 - msle_log2: 1.3371 - val_loss: -115.9553 - val_mape: 0.8415 - val_msle_log2: 1.4137
Epoch 5/10
760/760 [==============================] - 609s 801ms/step - loss: -113.3473 - mape: 0.9530 - msle_log2: 1.3238 - val_loss: -114.4680 - val_mape: 0.9289 - val_msle_log2: 1.3990
Epoch 6/10
760/760 [==============================] - 628s 827ms/step - loss: -94.9908 - mape: 0.9421 - msle_log2: 1.3053 - val_loss: -56.2017 - val_mape: 0.9525 - val_msle_log2: 1.3558
Epoch 7/10
760/760 [==============================] - 611s 804ms/step - loss: -65.6831 - mape: 0.9338 - msle_log2: 1.2919 - val_loss: -69.8301 - val_mape: 0.8870 - val_msle_log2: 1.3661
Epoch 8/10
760/760 [==============================] - 628s 826ms/step - loss: -76.8326 - mape: 0.9278 - msle_log2: 1.2792 - val_loss: -101.9350 - val_mape: 1.0673 - val_msle_log2: 1.3741
Epoch 9/10
760/760 [==============================] - 608s 800ms/step - loss: -48.3914 - mape: 0.9211 - msle_log2: 1.2635 - val_loss: -58.6868 - val_mape: 1.0623 - val_msle_log2: 1.3569
Epoch 10/10
760/760 [==============================] - 644s 847ms/step - loss: -61.2383 - mape: 0.9075 - msle_log2: 1.2445 - val_loss: -64.1770 - val_mape: 1.0021 - val_msle_log2: 1.3651
Training ended!
163/163 [==============================] - 70s 427ms/step - loss: -64.1786 - mape: 0.9773 - msle_log2: 1.3345
2.326041813659294
Finished! Time used: 110.165mins.
test MSEL 1.6038505307039335
test mape 0.804192850265063
test mSEL 0.6349585033333395
test acc 0.1997312601977157
val MSEL 1.6457038717001917
val mape 0.8297982703571782
val mSEL 0.64878969152298
val acc 0.19865642994241842
Finished! Time used: 2.188mins.