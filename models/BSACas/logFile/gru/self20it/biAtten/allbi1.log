/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:78.00029110908508
====bidirected: True,attention: GAT====
total parameters 77737
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.7902
batch:199 average train loss 3.2236
batch:299 average train loss 3.0225
batch:399 average train loss 2.8652
batch:499 average train loss 2.7284
batch:599 average train loss 2.6403
batch:699 average train loss 2.5609
batch:799 average train loss 2.5096
batch:899 average train loss 2.4961
batch:999 average train loss 2.4527
batch:1099 average train loss 2.4343
batch:1199 average train loss 2.4039
average train loss 2.3788
Train Consuming time:95.79 in the epoch: 0
total val iterations: 276 
average val loss 2.2856
accuracy ( less than 0.1 ): 0.1405
median val loss 0.5740
total test iterations: 276 
average test loss 2.2108
accuracy ( less than 0.1 ): 0.1322
median test loss 0.5887
Consuming time:120.67 in the epoch: 0
Best test loss is 2.21
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.2804
batch:199 average train loss 2.2312
batch:299 average train loss 2.2590
batch:399 average train loss 2.2388
batch:499 average train loss 2.1942
batch:599 average train loss 2.1704
batch:699 average train loss 2.1407
batch:799 average train loss 2.1353
batch:899 average train loss 2.1501
batch:999 average train loss 2.1339
batch:1099 average train loss 2.1334
batch:1199 average train loss 2.1222
average train loss 2.1113
Train Consuming time:96.38 in the epoch: 1
total val iterations: 276 
average val loss 2.2263
accuracy ( less than 0.1 ): 0.1415
median val loss 0.5571
total test iterations: 276 
average test loss 2.1633
accuracy ( less than 0.1 ): 0.1331
median test loss 0.5620
Consuming time:121.86 in the epoch: 1
Best test loss is 2.16
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2185
batch:199 average train loss 2.1712
batch:299 average train loss 2.1982
batch:399 average train loss 2.1832
batch:499 average train loss 2.1364
batch:599 average train loss 2.1196
batch:699 average train loss 2.0909
batch:799 average train loss 2.0838
batch:899 average train loss 2.0996
batch:999 average train loss 2.0849
batch:1099 average train loss 2.0871
batch:1199 average train loss 2.0752
average train loss 2.0652
Train Consuming time:96.54 in the epoch: 2
total val iterations: 276 
average val loss 2.2182
accuracy ( less than 0.1 ): 0.1411
median val loss 0.5486
total test iterations: 276 
average test loss 2.1823
accuracy ( less than 0.1 ): 0.1299
median test loss 0.5548
Consuming time:120.69 in the epoch: 2
Best test loss is 2.16
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1619
batch:199 average train loss 2.1186
batch:299 average train loss 2.1443
batch:399 average train loss 2.1366
batch:499 average train loss 2.0950
batch:599 average train loss 2.0778
batch:699 average train loss 2.0482
batch:799 average train loss 2.0455
batch:899 average train loss 2.0607
batch:999 average train loss 2.0468
batch:1099 average train loss 2.0494
batch:1199 average train loss 2.0386
average train loss 2.0307
Train Consuming time:95.42 in the epoch: 3
total val iterations: 276 
average val loss 2.0952
accuracy ( less than 0.1 ): 0.1855
median val loss 0.5244
total test iterations: 276 
average test loss 2.0344
accuracy ( less than 0.1 ): 0.1824
median test loss 0.5455
Consuming time:119.80 in the epoch: 3
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1317
batch:199 average train loss 2.1007
batch:299 average train loss 2.1252
batch:399 average train loss 2.1135
batch:499 average train loss 2.0707
batch:599 average train loss 2.0564
batch:699 average train loss 2.0254
batch:799 average train loss 2.0183
batch:899 average train loss 2.0350
batch:999 average train loss 2.0210
batch:1099 average train loss 2.0224
batch:1199 average train loss 2.0122
average train loss 2.0029
Train Consuming time:96.04 in the epoch: 4
total val iterations: 276 
average val loss 2.2093
accuracy ( less than 0.1 ): 0.1527
median val loss 0.5660
total test iterations: 276 
average test loss 2.1513
accuracy ( less than 0.1 ): 0.1484
median test loss 0.5579
Consuming time:120.37 in the epoch: 4
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1059
batch:199 average train loss 2.0709
batch:299 average train loss 2.0916
batch:399 average train loss 2.0841
batch:499 average train loss 2.0442
batch:599 average train loss 2.0296
batch:699 average train loss 2.0047
batch:799 average train loss 1.9965
batch:899 average train loss 2.0120
batch:999 average train loss 1.9982
batch:1099 average train loss 2.0021
batch:1199 average train loss 1.9924
average train loss 1.9834
Train Consuming time:96.08 in the epoch: 5
total val iterations: 276 
average val loss 2.1496
accuracy ( less than 0.1 ): 0.1589
median val loss 0.5306
total test iterations: 276 
average test loss 2.1038
accuracy ( less than 0.1 ): 0.1562
median test loss 0.5404
Consuming time:120.52 in the epoch: 5
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1000
batch:199 average train loss 2.0641
batch:299 average train loss 2.0758
batch:399 average train loss 2.0675
batch:499 average train loss 2.0267
batch:599 average train loss 2.0143
batch:699 average train loss 1.9883
batch:799 average train loss 1.9810
batch:899 average train loss 1.9956
batch:999 average train loss 1.9813
batch:1099 average train loss 1.9819
batch:1199 average train loss 1.9723
average train loss 1.9645
Train Consuming time:96.18 in the epoch: 6
total val iterations: 276 
average val loss 2.1013
accuracy ( less than 0.1 ): 0.1728
median val loss 0.5119
total test iterations: 276 
average test loss 2.0496
accuracy ( less than 0.1 ): 0.1636
median test loss 0.5070
Consuming time:120.94 in the epoch: 6
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.0717
batch:199 average train loss 2.0279
batch:299 average train loss 2.0473
batch:399 average train loss 2.0438
batch:499 average train loss 2.0032
batch:599 average train loss 1.9938
batch:699 average train loss 1.9702
batch:799 average train loss 1.9646
batch:899 average train loss 1.9822
batch:999 average train loss 1.9698
batch:1099 average train loss 1.9704
batch:1199 average train loss 1.9620
average train loss 1.9539
Train Consuming time:96.30 in the epoch: 7
total val iterations: 276 
average val loss 2.1033
accuracy ( less than 0.1 ): 0.1716
median val loss 0.4962
total test iterations: 276 
average test loss 2.0381
accuracy ( less than 0.1 ): 0.1657
median test loss 0.5135
Consuming time:120.73 in the epoch: 7
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0784
batch:199 average train loss 2.0395
batch:299 average train loss 2.0583
batch:399 average train loss 2.0513
batch:499 average train loss 2.0072
batch:599 average train loss 1.9984
batch:699 average train loss 1.9719
batch:799 average train loss 1.9629
batch:899 average train loss 1.9783
batch:999 average train loss 1.9647
batch:1099 average train loss 1.9656
batch:1199 average train loss 1.9570
average train loss 1.9476
Train Consuming time:96.15 in the epoch: 8
total val iterations: 276 
average val loss 2.0987
accuracy ( less than 0.1 ): 0.1774
median val loss 0.5004
total test iterations: 276 
average test loss 2.0259
accuracy ( less than 0.1 ): 0.1727
median test loss 0.5037
Consuming time:120.68 in the epoch: 8
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0828
batch:199 average train loss 2.0377
batch:299 average train loss 2.0445
batch:399 average train loss 2.0413
batch:499 average train loss 2.0007
batch:599 average train loss 1.9873
batch:699 average train loss 1.9595
batch:799 average train loss 1.9535
batch:899 average train loss 1.9674
batch:999 average train loss 1.9526
batch:1099 average train loss 1.9535
batch:1199 average train loss 1.9435
average train loss 1.9343
Train Consuming time:95.47 in the epoch: 9
total val iterations: 276 
average val loss 2.1187
accuracy ( less than 0.1 ): 0.1595
median val loss 0.4908
total test iterations: 276 
average test loss 2.0713
accuracy ( less than 0.1 ): 0.1537
median test loss 0.5115
Consuming time:120.29 in the epoch: 9
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0652
batch:199 average train loss 2.0080
batch:299 average train loss 2.0242
batch:399 average train loss 2.0182
batch:499 average train loss 1.9722
batch:599 average train loss 1.9611
batch:699 average train loss 1.9275
batch:799 average train loss 1.9161
batch:899 average train loss 1.9280
batch:999 average train loss 1.9087
batch:1099 average train loss 1.9075
batch:1199 average train loss 1.8927
average train loss 1.8762
Train Consuming time:96.56 in the epoch: 10
total val iterations: 276 
average val loss 2.0182
accuracy ( less than 0.1 ): 0.2333
median val loss 0.5262
total test iterations: 276 
average test loss 1.9455
accuracy ( less than 0.1 ): 0.2360
median test loss 0.5329
Consuming time:121.39 in the epoch: 10
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0213
batch:199 average train loss 1.9707
batch:299 average train loss 1.9912
batch:399 average train loss 1.9871
batch:499 average train loss 1.9434
batch:599 average train loss 1.9346
batch:699 average train loss 1.9044
batch:799 average train loss 1.8939
batch:899 average train loss 1.9060
batch:999 average train loss 1.8874
batch:1099 average train loss 1.8863
batch:1199 average train loss 1.8723
average train loss 1.8573
Train Consuming time:96.89 in the epoch: 11
total val iterations: 276 
average val loss 2.0127
accuracy ( less than 0.1 ): 0.2347
median val loss 0.5239
total test iterations: 276 
average test loss 1.9399
accuracy ( less than 0.1 ): 0.2373
median test loss 0.5385
Consuming time:121.67 in the epoch: 11
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0083
batch:199 average train loss 1.9601
batch:299 average train loss 1.9803
batch:399 average train loss 1.9772
batch:499 average train loss 1.9333
batch:599 average train loss 1.9247
batch:699 average train loss 1.8950
batch:799 average train loss 1.8846
batch:899 average train loss 1.8969
batch:999 average train loss 1.8786
batch:1099 average train loss 1.8777
batch:1199 average train loss 1.8641
average train loss 1.8498
Train Consuming time:96.68 in the epoch: 12
total val iterations: 276 
average val loss 2.0091
accuracy ( less than 0.1 ): 0.2365
median val loss 0.5248
total test iterations: 276 
average test loss 1.9384
accuracy ( less than 0.1 ): 0.2351
median test loss 0.5423
Consuming time:121.32 in the epoch: 12
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0014
batch:199 average train loss 1.9534
batch:299 average train loss 1.9737
batch:399 average train loss 1.9708
batch:499 average train loss 1.9276
batch:599 average train loss 1.9184
batch:699 average train loss 1.8890
batch:799 average train loss 1.8784
batch:899 average train loss 1.8909
batch:999 average train loss 1.8729
batch:1099 average train loss 1.8721
batch:1199 average train loss 1.8588
average train loss 1.8450
Train Consuming time:96.25 in the epoch: 13
total val iterations: 276 
average val loss 2.0085
accuracy ( less than 0.1 ): 0.2372
median val loss 0.5221
total test iterations: 276 
average test loss 1.9353
accuracy ( less than 0.1 ): 0.2344
median test loss 0.5458
Consuming time:120.98 in the epoch: 13
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9964
batch:199 average train loss 1.9485
batch:299 average train loss 1.9694
batch:399 average train loss 1.9668
batch:499 average train loss 1.9231
batch:599 average train loss 1.9136
batch:699 average train loss 1.8839
batch:799 average train loss 1.8732
batch:899 average train loss 1.8860
batch:999 average train loss 1.8681
batch:1099 average train loss 1.8674
batch:1199 average train loss 1.8546
average train loss 1.8411
Train Consuming time:96.23 in the epoch: 14
total val iterations: 276 
average val loss 2.0072
accuracy ( less than 0.1 ): 0.2378
median val loss 0.5233
total test iterations: 276 
average test loss 1.9322
accuracy ( less than 0.1 ): 0.2350
median test loss 0.5464
Consuming time:120.98 in the epoch: 14
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9933
batch:199 average train loss 1.9453
batch:299 average train loss 1.9660
batch:399 average train loss 1.9635
batch:499 average train loss 1.9199
batch:599 average train loss 1.9103
batch:699 average train loss 1.8807
batch:799 average train loss 1.8700
batch:899 average train loss 1.8828
batch:999 average train loss 1.8650
batch:1099 average train loss 1.8644
batch:1199 average train loss 1.8518
average train loss 1.8386
Train Consuming time:96.30 in the epoch: 15
total val iterations: 276 
average val loss 2.0063
accuracy ( less than 0.1 ): 0.2378
median val loss 0.5219
total test iterations: 276 
average test loss 1.9308
accuracy ( less than 0.1 ): 0.2367
median test loss 0.5462
Consuming time:121.49 in the epoch: 15
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9915
batch:199 average train loss 1.9431
batch:299 average train loss 1.9635
batch:399 average train loss 1.9611
batch:499 average train loss 1.9177
batch:599 average train loss 1.9080
batch:699 average train loss 1.8786
batch:799 average train loss 1.8677
batch:899 average train loss 1.8806
batch:999 average train loss 1.8628
batch:1099 average train loss 1.8621
batch:1199 average train loss 1.8496
average train loss 1.8366
Train Consuming time:97.04 in the epoch: 16
total val iterations: 276 
average val loss 2.0063
accuracy ( less than 0.1 ): 0.2370
median val loss 0.5232
total test iterations: 276 
average test loss 1.9302
accuracy ( less than 0.1 ): 0.2359
median test loss 0.5429
Consuming time:121.67 in the epoch: 16
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9903
batch:199 average train loss 1.9420
batch:299 average train loss 1.9617
batch:399 average train loss 1.9593
batch:499 average train loss 1.9157
batch:599 average train loss 1.9061
batch:699 average train loss 1.8766
batch:799 average train loss 1.8659
batch:899 average train loss 1.8788
batch:999 average train loss 1.8610
batch:1099 average train loss 1.8604
batch:1199 average train loss 1.8480
average train loss 1.8352
Train Consuming time:102.95 in the epoch: 17
total val iterations: 276 
average val loss 2.0053
accuracy ( less than 0.1 ): 0.2370
median val loss 0.5225
total test iterations: 276 
average test loss 1.9281
accuracy ( less than 0.1 ): 0.2353
median test loss 0.5383
Consuming time:128.29 in the epoch: 17
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9876
batch:199 average train loss 1.9394
batch:299 average train loss 1.9592
batch:399 average train loss 1.9566
batch:499 average train loss 1.9131
batch:599 average train loss 1.9033
batch:699 average train loss 1.8738
batch:799 average train loss 1.8633
batch:899 average train loss 1.8765
batch:999 average train loss 1.8587
batch:1099 average train loss 1.8582
batch:1199 average train loss 1.8460
average train loss 1.8333
Train Consuming time:105.34 in the epoch: 18
total val iterations: 276 
average val loss 2.0047
accuracy ( less than 0.1 ): 0.2373
median val loss 0.5207
total test iterations: 276 
average test loss 1.9273
accuracy ( less than 0.1 ): 0.2356
median test loss 0.5375
Consuming time:131.08 in the epoch: 18
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9857
batch:199 average train loss 1.9379
batch:299 average train loss 1.9572
batch:399 average train loss 1.9544
batch:499 average train loss 1.9110
batch:599 average train loss 1.9012
batch:699 average train loss 1.8717
batch:799 average train loss 1.8610
batch:899 average train loss 1.8744
batch:999 average train loss 1.8566
batch:1099 average train loss 1.8562
batch:1199 average train loss 1.8440
average train loss 1.8315
Train Consuming time:104.03 in the epoch: 19
total val iterations: 276 
average val loss 2.0042
accuracy ( less than 0.1 ): 0.2374
median val loss 0.5192
total test iterations: 276 
average test loss 1.9263
accuracy ( less than 0.1 ): 0.2344
median test loss 0.5408
Consuming time:129.72 in the epoch: 19
Best test loss is 1.93
---------------*****---------------
