/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:80.40292859077454
====bidirected: False,attention: ====
total parameters 44201
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.4847
batch:199 average train loss 2.9830
batch:299 average train loss 2.8300
batch:399 average train loss 2.7076
batch:499 average train loss 2.6110
batch:599 average train loss 2.5533
batch:699 average train loss 2.4905
batch:799 average train loss 2.4530
batch:899 average train loss 2.4478
batch:999 average train loss 2.4123
batch:1099 average train loss 2.3981
batch:1199 average train loss 2.3720
average train loss 2.3545
Train Consuming time:66.24 in the epoch: 0
total val iterations: 276 
average val loss 2.3838
accuracy ( less than 0.1 ): 0.1265
median val loss 0.6260
total test iterations: 276 
average test loss 2.3444
accuracy ( less than 0.1 ): 0.1224
median test loss 0.6270
Consuming time:86.51 in the epoch: 0
Best test loss is 2.34
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3286
batch:199 average train loss 2.2692
batch:299 average train loss 2.2914
batch:399 average train loss 2.2683
batch:499 average train loss 2.2231
batch:599 average train loss 2.2066
batch:699 average train loss 2.1762
batch:799 average train loss 2.1643
batch:899 average train loss 2.1829
batch:999 average train loss 2.1629
batch:1099 average train loss 2.1652
batch:1199 average train loss 2.1500
average train loss 2.1386
Train Consuming time:66.51 in the epoch: 1
total val iterations: 276 
average val loss 2.3157
accuracy ( less than 0.1 ): 0.1338
median val loss 0.6105
total test iterations: 276 
average test loss 2.2922
accuracy ( less than 0.1 ): 0.1284
median test loss 0.6145
Consuming time:86.77 in the epoch: 1
Best test loss is 2.29
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2325
batch:199 average train loss 2.1891
batch:299 average train loss 2.2092
batch:399 average train loss 2.1989
batch:499 average train loss 2.1594
batch:599 average train loss 2.1479
batch:699 average train loss 2.1154
batch:799 average train loss 2.1059
batch:899 average train loss 2.1238
batch:999 average train loss 2.1085
batch:1099 average train loss 2.1112
batch:1199 average train loss 2.0979
average train loss 2.0880
Train Consuming time:66.63 in the epoch: 2
total val iterations: 276 
average val loss 2.2297
accuracy ( less than 0.1 ): 0.1447
median val loss 0.5642
total test iterations: 276 
average test loss 2.1959
accuracy ( less than 0.1 ): 0.1340
median test loss 0.5636
Consuming time:86.83 in the epoch: 2
Best test loss is 2.20
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1900
batch:199 average train loss 2.1604
batch:299 average train loss 2.1808
batch:399 average train loss 2.1716
batch:499 average train loss 2.1272
batch:599 average train loss 2.1151
batch:699 average train loss 2.0842
batch:799 average train loss 2.0787
batch:899 average train loss 2.0970
batch:999 average train loss 2.0803
batch:1099 average train loss 2.0837
batch:1199 average train loss 2.0727
average train loss 2.0605
Train Consuming time:67.29 in the epoch: 3
total val iterations: 276 
average val loss 2.2396
accuracy ( less than 0.1 ): 0.1308
median val loss 0.5546
total test iterations: 276 
average test loss 2.2337
accuracy ( less than 0.1 ): 0.1231
median test loss 0.5702
Consuming time:87.41 in the epoch: 3
Best test loss is 2.20
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1766
batch:199 average train loss 2.1369
batch:299 average train loss 2.1518
batch:399 average train loss 2.1472
batch:499 average train loss 2.1044
batch:599 average train loss 2.0880
batch:699 average train loss 2.0584
batch:799 average train loss 2.0531
batch:899 average train loss 2.0715
batch:999 average train loss 2.0516
batch:1099 average train loss 2.0557
batch:1199 average train loss 2.0452
average train loss 2.0339
Train Consuming time:66.99 in the epoch: 4
total val iterations: 276 
average val loss 2.2267
accuracy ( less than 0.1 ): 0.1416
median val loss 0.5575
total test iterations: 276 
average test loss 2.1753
accuracy ( less than 0.1 ): 0.1382
median test loss 0.5856
Consuming time:87.21 in the epoch: 4
Best test loss is 2.18
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1683
batch:199 average train loss 2.1310
batch:299 average train loss 2.1341
batch:399 average train loss 2.1262
batch:499 average train loss 2.0857
batch:599 average train loss 2.0739
batch:699 average train loss 2.0449
batch:799 average train loss 2.0373
batch:899 average train loss 2.0558
batch:999 average train loss 2.0407
batch:1099 average train loss 2.0441
batch:1199 average train loss 2.0308
average train loss 2.0200
Train Consuming time:67.13 in the epoch: 5
total val iterations: 276 
average val loss 2.1477
accuracy ( less than 0.1 ): 0.1648
median val loss 0.5268
total test iterations: 276 
average test loss 2.1218
accuracy ( less than 0.1 ): 0.1598
median test loss 0.5466
Consuming time:87.78 in the epoch: 5
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1308
batch:199 average train loss 2.0922
batch:299 average train loss 2.1090
batch:399 average train loss 2.0938
batch:499 average train loss 2.0594
batch:599 average train loss 2.0503
batch:699 average train loss 2.0202
batch:799 average train loss 2.0129
batch:899 average train loss 2.0309
batch:999 average train loss 2.0166
batch:1099 average train loss 2.0186
batch:1199 average train loss 2.0060
average train loss 1.9963
Train Consuming time:66.46 in the epoch: 6
total val iterations: 276 
average val loss 2.1463
accuracy ( less than 0.1 ): 0.1582
median val loss 0.5303
total test iterations: 276 
average test loss 2.1209
accuracy ( less than 0.1 ): 0.1566
median test loss 0.5368
Consuming time:87.16 in the epoch: 6
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1260
batch:199 average train loss 2.0932
batch:299 average train loss 2.1054
batch:399 average train loss 2.0961
batch:499 average train loss 2.0585
batch:599 average train loss 2.0480
batch:699 average train loss 2.0214
batch:799 average train loss 2.0110
batch:899 average train loss 2.0260
batch:999 average train loss 2.0085
batch:1099 average train loss 2.0103
batch:1199 average train loss 1.9975
average train loss 1.9868
Train Consuming time:65.55 in the epoch: 7
total val iterations: 276 
average val loss 2.1887
accuracy ( less than 0.1 ): 0.1582
median val loss 0.5342
total test iterations: 276 
average test loss 2.1862
accuracy ( less than 0.1 ): 0.1548
median test loss 0.5589
Consuming time:86.41 in the epoch: 7
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0959
batch:199 average train loss 2.0650
batch:299 average train loss 2.0813
batch:399 average train loss 2.0785
batch:499 average train loss 2.0401
batch:599 average train loss 2.0293
batch:699 average train loss 1.9995
batch:799 average train loss 1.9915
batch:899 average train loss 2.0062
batch:999 average train loss 1.9910
batch:1099 average train loss 1.9916
batch:1199 average train loss 1.9789
average train loss 1.9670
Train Consuming time:65.54 in the epoch: 8
total val iterations: 276 
average val loss 2.1167
accuracy ( less than 0.1 ): 0.1812
median val loss 0.5280
total test iterations: 276 
average test loss 2.0622
accuracy ( less than 0.1 ): 0.1766
median test loss 0.5422
Consuming time:86.87 in the epoch: 8
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0848
batch:199 average train loss 2.0578
batch:299 average train loss 2.0699
batch:399 average train loss 2.0598
batch:499 average train loss 2.0222
batch:599 average train loss 2.0136
batch:699 average train loss 1.9845
batch:799 average train loss 1.9765
batch:899 average train loss 1.9933
batch:999 average train loss 1.9767
batch:1099 average train loss 1.9814
batch:1199 average train loss 1.9681
average train loss 1.9600
Train Consuming time:66.14 in the epoch: 9
total val iterations: 276 
average val loss 2.0922
accuracy ( less than 0.1 ): 0.1767
median val loss 0.5161
total test iterations: 276 
average test loss 2.0498
accuracy ( less than 0.1 ): 0.1714
median test loss 0.5309
Consuming time:87.47 in the epoch: 9
Best test loss is 2.05
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0833
batch:199 average train loss 2.0411
batch:299 average train loss 2.0520
batch:399 average train loss 2.0351
batch:499 average train loss 1.9898
batch:599 average train loss 1.9770
batch:699 average train loss 1.9455
batch:799 average train loss 1.9375
batch:899 average train loss 1.9514
batch:999 average train loss 1.9292
batch:1099 average train loss 1.9288
batch:1199 average train loss 1.9126
average train loss 1.8951
Train Consuming time:64.99 in the epoch: 10
total val iterations: 276 
average val loss 2.0073
accuracy ( less than 0.1 ): 0.2355
median val loss 0.5251
total test iterations: 276 
average test loss 1.9514
accuracy ( less than 0.1 ): 0.2393
median test loss 0.5446
Consuming time:86.08 in the epoch: 10
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0241
batch:199 average train loss 1.9976
batch:299 average train loss 2.0162
batch:399 average train loss 2.0027
batch:499 average train loss 1.9610
batch:599 average train loss 1.9519
batch:699 average train loss 1.9216
batch:799 average train loss 1.9142
batch:899 average train loss 1.9289
batch:999 average train loss 1.9075
batch:1099 average train loss 1.9082
batch:1199 average train loss 1.8927
average train loss 1.8765
Train Consuming time:64.95 in the epoch: 11
total val iterations: 276 
average val loss 2.0004
accuracy ( less than 0.1 ): 0.2338
median val loss 0.5265
total test iterations: 276 
average test loss 1.9454
accuracy ( less than 0.1 ): 0.2389
median test loss 0.5388
Consuming time:86.16 in the epoch: 11
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0106
batch:199 average train loss 1.9859
batch:299 average train loss 2.0048
batch:399 average train loss 1.9933
batch:499 average train loss 1.9525
batch:599 average train loss 1.9432
batch:699 average train loss 1.9133
batch:799 average train loss 1.9054
batch:899 average train loss 1.9197
batch:999 average train loss 1.8984
batch:1099 average train loss 1.8993
batch:1199 average train loss 1.8840
average train loss 1.8685
Train Consuming time:64.90 in the epoch: 12
total val iterations: 276 
average val loss 1.9978
accuracy ( less than 0.1 ): 0.2319
median val loss 0.5300
total test iterations: 276 
average test loss 1.9447
accuracy ( less than 0.1 ): 0.2367
median test loss 0.5362
Consuming time:86.11 in the epoch: 12
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0046
batch:199 average train loss 1.9798
batch:299 average train loss 1.9984
batch:399 average train loss 1.9859
batch:499 average train loss 1.9451
batch:599 average train loss 1.9364
batch:699 average train loss 1.9071
batch:799 average train loss 1.8988
batch:899 average train loss 1.9133
batch:999 average train loss 1.8922
batch:1099 average train loss 1.8931
batch:1199 average train loss 1.8780
average train loss 1.8628
Train Consuming time:65.68 in the epoch: 13
total val iterations: 276 
average val loss 1.9967
accuracy ( less than 0.1 ): 0.2320
median val loss 0.5283
total test iterations: 276 
average test loss 1.9429
accuracy ( less than 0.1 ): 0.2378
median test loss 0.5331
Consuming time:86.97 in the epoch: 13
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9995
batch:199 average train loss 1.9747
batch:299 average train loss 1.9931
batch:399 average train loss 1.9806
batch:499 average train loss 1.9399
batch:599 average train loss 1.9316
batch:699 average train loss 1.9027
batch:799 average train loss 1.8943
batch:899 average train loss 1.9087
batch:999 average train loss 1.8877
batch:1099 average train loss 1.8887
batch:1199 average train loss 1.8737
average train loss 1.8588
Train Consuming time:65.57 in the epoch: 14
total val iterations: 276 
average val loss 1.9959
accuracy ( less than 0.1 ): 0.2309
median val loss 0.5278
total test iterations: 276 
average test loss 1.9427
accuracy ( less than 0.1 ): 0.2377
median test loss 0.5295
Consuming time:86.35 in the epoch: 14
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9961
batch:199 average train loss 1.9717
batch:299 average train loss 1.9893
batch:399 average train loss 1.9764
batch:499 average train loss 1.9356
batch:599 average train loss 1.9274
batch:699 average train loss 1.8991
batch:799 average train loss 1.8905
batch:899 average train loss 1.9048
batch:999 average train loss 1.8839
batch:1099 average train loss 1.8851
batch:1199 average train loss 1.8704
average train loss 1.8557
Train Consuming time:62.03 in the epoch: 15
total val iterations: 276 
average val loss 1.9950
accuracy ( less than 0.1 ): 0.2314
median val loss 0.5264
total test iterations: 276 
average test loss 1.9413
accuracy ( less than 0.1 ): 0.2370
median test loss 0.5309
Consuming time:82.26 in the epoch: 15
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9930
batch:199 average train loss 1.9683
batch:299 average train loss 1.9854
batch:399 average train loss 1.9730
batch:499 average train loss 1.9320
batch:599 average train loss 1.9239
batch:699 average train loss 1.8956
batch:799 average train loss 1.8868
batch:899 average train loss 1.9013
batch:999 average train loss 1.8804
batch:1099 average train loss 1.8816
batch:1199 average train loss 1.8672
average train loss 1.8527
Train Consuming time:62.15 in the epoch: 16
total val iterations: 276 
average val loss 1.9948
accuracy ( less than 0.1 ): 0.2310
median val loss 0.5268
total test iterations: 276 
average test loss 1.9418
accuracy ( less than 0.1 ): 0.2370
median test loss 0.5307
Consuming time:82.40 in the epoch: 16
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9899
batch:199 average train loss 1.9648
batch:299 average train loss 1.9816
batch:399 average train loss 1.9700
batch:499 average train loss 1.9291
batch:599 average train loss 1.9213
batch:699 average train loss 1.8932
batch:799 average train loss 1.8843
batch:899 average train loss 1.8986
batch:999 average train loss 1.8778
batch:1099 average train loss 1.8791
batch:1199 average train loss 1.8646
average train loss 1.8503
Train Consuming time:62.35 in the epoch: 17
total val iterations: 276 
average val loss 1.9946
accuracy ( less than 0.1 ): 0.2317
median val loss 0.5281
total test iterations: 276 
average test loss 1.9418
accuracy ( less than 0.1 ): 0.2362
median test loss 0.5327
Consuming time:82.74 in the epoch: 17
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9888
batch:199 average train loss 1.9632
batch:299 average train loss 1.9798
batch:399 average train loss 1.9682
batch:499 average train loss 1.9272
batch:599 average train loss 1.9191
batch:699 average train loss 1.8911
batch:799 average train loss 1.8820
batch:899 average train loss 1.8963
batch:999 average train loss 1.8755
batch:1099 average train loss 1.8766
batch:1199 average train loss 1.8623
average train loss 1.8482
Train Consuming time:62.80 in the epoch: 18
total val iterations: 276 
average val loss 1.9943
accuracy ( less than 0.1 ): 0.2323
median val loss 0.5278
total test iterations: 276 
average test loss 1.9406
accuracy ( less than 0.1 ): 0.2381
median test loss 0.5309
Consuming time:84.01 in the epoch: 18
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9858
batch:199 average train loss 1.9604
batch:299 average train loss 1.9767
batch:399 average train loss 1.9656
batch:499 average train loss 1.9247
batch:599 average train loss 1.9168
batch:699 average train loss 1.8887
batch:799 average train loss 1.8795
batch:899 average train loss 1.8939
batch:999 average train loss 1.8731
batch:1099 average train loss 1.8743
batch:1199 average train loss 1.8600
average train loss 1.8460
Train Consuming time:70.80 in the epoch: 19
total val iterations: 276 
average val loss 1.9935
accuracy ( less than 0.1 ): 0.2311
median val loss 0.5307
total test iterations: 276 
average test loss 1.9399
accuracy ( less than 0.1 ): 0.2377
median test loss 0.5269
Consuming time:91.18 in the epoch: 19
Best test loss is 1.94
---------------*****---------------
