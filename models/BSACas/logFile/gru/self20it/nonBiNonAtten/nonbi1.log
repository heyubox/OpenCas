/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:76.96581411361694
====bidirected: False,attention: ====
total parameters 44201
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.4462
batch:199 average train loss 2.9660
batch:299 average train loss 2.8275
batch:399 average train loss 2.6976
batch:499 average train loss 2.5990
batch:599 average train loss 2.5456
batch:699 average train loss 2.4901
batch:799 average train loss 2.4533
batch:899 average train loss 2.4501
batch:999 average train loss 2.4162
batch:1099 average train loss 2.4030
batch:1199 average train loss 2.3755
average train loss 2.3566
Train Consuming time:64.09 in the epoch: 0
total val iterations: 276 
average val loss 2.2524
accuracy ( less than 0.1 ): 0.1722
median val loss 0.5681
total test iterations: 276 
average test loss 2.1952
accuracy ( less than 0.1 ): 0.1676
median test loss 0.5733
Consuming time:84.09 in the epoch: 0
Best test loss is 2.20
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3040
batch:199 average train loss 2.2467
batch:299 average train loss 2.2807
batch:399 average train loss 2.2564
batch:499 average train loss 2.2112
batch:599 average train loss 2.2041
batch:699 average train loss 2.1770
batch:799 average train loss 2.1691
batch:899 average train loss 2.1833
batch:999 average train loss 2.1645
batch:1099 average train loss 2.1706
batch:1199 average train loss 2.1546
average train loss 2.1426
Train Consuming time:63.55 in the epoch: 1
total val iterations: 276 
average val loss 2.2773
accuracy ( less than 0.1 ): 0.1460
median val loss 0.5733
total test iterations: 276 
average test loss 2.2440
accuracy ( less than 0.1 ): 0.1395
median test loss 0.5589
Consuming time:83.98 in the epoch: 1
Best test loss is 2.20
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2503
batch:199 average train loss 2.1842
batch:299 average train loss 2.2072
batch:399 average train loss 2.1959
batch:499 average train loss 2.1503
batch:599 average train loss 2.1403
batch:699 average train loss 2.1129
batch:799 average train loss 2.1077
batch:899 average train loss 2.1254
batch:999 average train loss 2.1080
batch:1099 average train loss 2.1119
batch:1199 average train loss 2.0999
average train loss 2.0880
Train Consuming time:61.64 in the epoch: 2
total val iterations: 276 
average val loss 2.2263
accuracy ( less than 0.1 ): 0.1560
median val loss 0.5567
total test iterations: 276 
average test loss 2.1790
accuracy ( less than 0.1 ): 0.1497
median test loss 0.5629
Consuming time:81.97 in the epoch: 2
Best test loss is 2.18
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1984
batch:199 average train loss 2.1524
batch:299 average train loss 2.1684
batch:399 average train loss 2.1564
batch:499 average train loss 2.1126
batch:599 average train loss 2.1058
batch:699 average train loss 2.0789
batch:799 average train loss 2.0783
batch:899 average train loss 2.0967
batch:999 average train loss 2.0814
batch:1099 average train loss 2.0836
batch:1199 average train loss 2.0711
average train loss 2.0609
Train Consuming time:64.18 in the epoch: 3
total val iterations: 276 
average val loss 2.2500
accuracy ( less than 0.1 ): 0.1559
median val loss 0.5813
total test iterations: 276 
average test loss 2.2098
accuracy ( less than 0.1 ): 0.1506
median test loss 0.5893
Consuming time:84.52 in the epoch: 3
Best test loss is 2.18
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1900
batch:199 average train loss 2.1463
batch:299 average train loss 2.1598
batch:399 average train loss 2.1466
batch:499 average train loss 2.1036
batch:599 average train loss 2.0928
batch:699 average train loss 2.0646
batch:799 average train loss 2.0586
batch:899 average train loss 2.0782
batch:999 average train loss 2.0606
batch:1099 average train loss 2.0644
batch:1199 average train loss 2.0504
average train loss 2.0400
Train Consuming time:59.09 in the epoch: 4
total val iterations: 276 
average val loss 2.1252
accuracy ( less than 0.1 ): 0.1809
median val loss 0.5263
total test iterations: 276 
average test loss 2.0808
accuracy ( less than 0.1 ): 0.1762
median test loss 0.5347
Consuming time:77.88 in the epoch: 4
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1525
batch:199 average train loss 2.1209
batch:299 average train loss 2.1366
batch:399 average train loss 2.1220
batch:499 average train loss 2.0830
batch:599 average train loss 2.0734
batch:699 average train loss 2.0434
batch:799 average train loss 2.0406
batch:899 average train loss 2.0571
batch:999 average train loss 2.0382
batch:1099 average train loss 2.0409
batch:1199 average train loss 2.0290
average train loss 2.0191
Train Consuming time:58.93 in the epoch: 5
total val iterations: 276 
average val loss 2.1694
accuracy ( less than 0.1 ): 0.1651
median val loss 0.5590
total test iterations: 276 
average test loss 2.1302
accuracy ( less than 0.1 ): 0.1591
median test loss 0.5579
Consuming time:81.07 in the epoch: 5
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1380
batch:199 average train loss 2.1018
batch:299 average train loss 2.1214
batch:399 average train loss 2.1091
batch:499 average train loss 2.0659
batch:599 average train loss 2.0609
batch:699 average train loss 2.0333
batch:799 average train loss 2.0291
batch:899 average train loss 2.0459
batch:999 average train loss 2.0271
batch:1099 average train loss 2.0280
batch:1199 average train loss 2.0160
average train loss 2.0064
Train Consuming time:66.16 in the epoch: 6
total val iterations: 276 
average val loss 2.2138
accuracy ( less than 0.1 ): 0.1423
median val loss 0.5520
total test iterations: 276 
average test loss 2.2042
accuracy ( less than 0.1 ): 0.1356
median test loss 0.5622
Consuming time:88.43 in the epoch: 6
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1311
batch:199 average train loss 2.0821
batch:299 average train loss 2.0911
batch:399 average train loss 2.0792
batch:499 average train loss 2.0397
batch:599 average train loss 2.0386
batch:699 average train loss 2.0142
batch:799 average train loss 2.0098
batch:899 average train loss 2.0269
batch:999 average train loss 2.0081
batch:1099 average train loss 2.0100
batch:1199 average train loss 1.9990
average train loss 1.9899
Train Consuming time:67.44 in the epoch: 7
total val iterations: 276 
average val loss 2.1724
accuracy ( less than 0.1 ): 0.1477
median val loss 0.5347
total test iterations: 276 
average test loss 2.1528
accuracy ( less than 0.1 ): 0.1392
median test loss 0.5352
Consuming time:89.97 in the epoch: 7
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.1104
batch:199 average train loss 2.0655
batch:299 average train loss 2.0816
batch:399 average train loss 2.0754
batch:499 average train loss 2.0360
batch:599 average train loss 2.0320
batch:699 average train loss 2.0088
batch:799 average train loss 2.0033
batch:899 average train loss 2.0174
batch:999 average train loss 1.9998
batch:1099 average train loss 2.0020
batch:1199 average train loss 1.9911
average train loss 1.9814
Train Consuming time:68.70 in the epoch: 8
total val iterations: 276 
average val loss 2.1530
accuracy ( less than 0.1 ): 0.1517
median val loss 0.5307
total test iterations: 276 
average test loss 2.1391
accuracy ( less than 0.1 ): 0.1432
median test loss 0.5420
Consuming time:91.00 in the epoch: 8
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.1080
batch:199 average train loss 2.0604
batch:299 average train loss 2.0719
batch:399 average train loss 2.0619
batch:499 average train loss 2.0237
batch:599 average train loss 2.0176
batch:699 average train loss 1.9906
batch:799 average train loss 1.9847
batch:899 average train loss 2.0004
batch:999 average train loss 1.9830
batch:1099 average train loss 1.9850
batch:1199 average train loss 1.9740
average train loss 1.9659
Train Consuming time:68.60 in the epoch: 9
total val iterations: 276 
average val loss 2.1727
accuracy ( less than 0.1 ): 0.1434
median val loss 0.5358
total test iterations: 276 
average test loss 2.1611
accuracy ( less than 0.1 ): 0.1345
median test loss 0.5497
Consuming time:90.96 in the epoch: 9
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.1308
batch:199 average train loss 2.0574
batch:299 average train loss 2.0621
batch:399 average train loss 2.0505
batch:499 average train loss 2.0016
batch:599 average train loss 1.9926
batch:699 average train loss 1.9630
batch:799 average train loss 1.9537
batch:899 average train loss 1.9659
batch:999 average train loss 1.9442
batch:1099 average train loss 1.9434
batch:1199 average train loss 1.9275
average train loss 1.9121
Train Consuming time:68.21 in the epoch: 10
total val iterations: 276 
average val loss 2.0129
accuracy ( less than 0.1 ): 0.2359
median val loss 0.5261
total test iterations: 276 
average test loss 1.9605
accuracy ( less than 0.1 ): 0.2309
median test loss 0.5424
Consuming time:90.54 in the epoch: 10
Best test loss is 1.96
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0574
batch:199 average train loss 2.0077
batch:299 average train loss 2.0194
batch:399 average train loss 2.0130
batch:499 average train loss 1.9677
batch:599 average train loss 1.9631
batch:699 average train loss 1.9357
batch:799 average train loss 1.9273
batch:899 average train loss 1.9403
batch:999 average train loss 1.9193
batch:1099 average train loss 1.9188
batch:1199 average train loss 1.9039
average train loss 1.8901
Train Consuming time:68.02 in the epoch: 11
total val iterations: 276 
average val loss 2.0091
accuracy ( less than 0.1 ): 0.2352
median val loss 0.5232
total test iterations: 276 
average test loss 1.9550
accuracy ( less than 0.1 ): 0.2306
median test loss 0.5399
Consuming time:90.15 in the epoch: 11
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0526
batch:199 average train loss 1.9990
batch:299 average train loss 2.0077
batch:399 average train loss 2.0015
batch:499 average train loss 1.9557
batch:599 average train loss 1.9520
batch:699 average train loss 1.9250
batch:799 average train loss 1.9162
batch:899 average train loss 1.9298
batch:999 average train loss 1.9089
batch:1099 average train loss 1.9082
batch:1199 average train loss 1.8936
average train loss 1.8806
Train Consuming time:66.15 in the epoch: 12
total val iterations: 276 
average val loss 2.0077
accuracy ( less than 0.1 ): 0.2340
median val loss 0.5230
total test iterations: 276 
average test loss 1.9519
accuracy ( less than 0.1 ): 0.2315
median test loss 0.5415
Consuming time:88.27 in the epoch: 12
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0427
batch:199 average train loss 1.9920
batch:299 average train loss 2.0003
batch:399 average train loss 1.9946
batch:499 average train loss 1.9483
batch:599 average train loss 1.9445
batch:699 average train loss 1.9181
batch:799 average train loss 1.9095
batch:899 average train loss 1.9234
batch:999 average train loss 1.9024
batch:1099 average train loss 1.9017
batch:1199 average train loss 1.8875
average train loss 1.8749
Train Consuming time:67.00 in the epoch: 13
total val iterations: 276 
average val loss 2.0062
accuracy ( less than 0.1 ): 0.2359
median val loss 0.5248
total test iterations: 276 
average test loss 1.9514
accuracy ( less than 0.1 ): 0.2332
median test loss 0.5449
Consuming time:89.10 in the epoch: 13
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 2.0362
batch:199 average train loss 1.9867
batch:299 average train loss 1.9952
batch:399 average train loss 1.9895
batch:499 average train loss 1.9431
batch:599 average train loss 1.9391
batch:699 average train loss 1.9130
batch:799 average train loss 1.9044
batch:899 average train loss 1.9185
batch:999 average train loss 1.8976
batch:1099 average train loss 1.8971
batch:1199 average train loss 1.8829
average train loss 1.8705
Train Consuming time:67.83 in the epoch: 14
total val iterations: 276 
average val loss 2.0047
accuracy ( less than 0.1 ): 0.2349
median val loss 0.5292
total test iterations: 276 
average test loss 1.9497
accuracy ( less than 0.1 ): 0.2333
median test loss 0.5435
Consuming time:90.54 in the epoch: 14
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 2.0332
batch:199 average train loss 1.9838
batch:299 average train loss 1.9920
batch:399 average train loss 1.9864
batch:499 average train loss 1.9399
batch:599 average train loss 1.9356
batch:699 average train loss 1.9097
batch:799 average train loss 1.9012
batch:899 average train loss 1.9152
batch:999 average train loss 1.8942
batch:1099 average train loss 1.8937
batch:1199 average train loss 1.8797
average train loss 1.8674
Train Consuming time:68.73 in the epoch: 15
total val iterations: 276 
average val loss 2.0041
accuracy ( less than 0.1 ): 0.2360
median val loss 0.5321
total test iterations: 276 
average test loss 1.9482
accuracy ( less than 0.1 ): 0.2347
median test loss 0.5424
Consuming time:91.00 in the epoch: 15
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 2.0289
batch:199 average train loss 1.9806
batch:299 average train loss 1.9888
batch:399 average train loss 1.9831
batch:499 average train loss 1.9369
batch:599 average train loss 1.9323
batch:699 average train loss 1.9065
batch:799 average train loss 1.8981
batch:899 average train loss 1.9120
batch:999 average train loss 1.8911
batch:1099 average train loss 1.8907
batch:1199 average train loss 1.8768
average train loss 1.8646
Train Consuming time:69.01 in the epoch: 16
total val iterations: 276 
average val loss 2.0034
accuracy ( less than 0.1 ): 0.2358
median val loss 0.5301
total test iterations: 276 
average test loss 1.9483
accuracy ( less than 0.1 ): 0.2333
median test loss 0.5457
Consuming time:91.49 in the epoch: 16
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 2.0261
batch:199 average train loss 1.9778
batch:299 average train loss 1.9857
batch:399 average train loss 1.9805
batch:499 average train loss 1.9343
batch:599 average train loss 1.9296
batch:699 average train loss 1.9037
batch:799 average train loss 1.8954
batch:899 average train loss 1.9094
batch:999 average train loss 1.8886
batch:1099 average train loss 1.8882
batch:1199 average train loss 1.8744
average train loss 1.8623
Train Consuming time:68.45 in the epoch: 17
total val iterations: 276 
average val loss 2.0032
accuracy ( less than 0.1 ): 0.2348
median val loss 0.5303
total test iterations: 276 
average test loss 1.9472
accuracy ( less than 0.1 ): 0.2334
median test loss 0.5417
Consuming time:90.76 in the epoch: 17
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 2.0248
batch:199 average train loss 1.9759
batch:299 average train loss 1.9836
batch:399 average train loss 1.9782
batch:499 average train loss 1.9320
batch:599 average train loss 1.9271
batch:699 average train loss 1.9013
batch:799 average train loss 1.8929
batch:899 average train loss 1.9069
batch:999 average train loss 1.8861
batch:1099 average train loss 1.8858
batch:1199 average train loss 1.8721
average train loss 1.8602
Train Consuming time:69.22 in the epoch: 18
total val iterations: 276 
average val loss 2.0026
accuracy ( less than 0.1 ): 0.2352
median val loss 0.5330
total test iterations: 276 
average test loss 1.9464
accuracy ( less than 0.1 ): 0.2336
median test loss 0.5442
Consuming time:91.68 in the epoch: 18
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 2.0228
batch:199 average train loss 1.9743
batch:299 average train loss 1.9815
batch:399 average train loss 1.9760
batch:499 average train loss 1.9297
batch:599 average train loss 1.9246
batch:699 average train loss 1.8990
batch:799 average train loss 1.8905
batch:899 average train loss 1.9046
batch:999 average train loss 1.8840
batch:1099 average train loss 1.8837
batch:1199 average train loss 1.8701
average train loss 1.8584
Train Consuming time:69.00 in the epoch: 19
total val iterations: 276 
average val loss 2.0025
accuracy ( less than 0.1 ): 0.2341
median val loss 0.5318
total test iterations: 276 
average test loss 1.9461
accuracy ( less than 0.1 ): 0.2334
median test loss 0.5434
Consuming time:91.45 in the epoch: 19
Best test loss is 1.95
---------------*****---------------
