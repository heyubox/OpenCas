/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:80.58721399307251
====bidirected: False,attention: ====
total parameters 44201
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.4799
batch:199 average train loss 3.0032
batch:299 average train loss 2.8477
batch:399 average train loss 2.7215
batch:499 average train loss 2.6110
batch:599 average train loss 2.5531
batch:699 average train loss 2.4894
batch:799 average train loss 2.4479
batch:899 average train loss 2.4436
batch:999 average train loss 2.4090
batch:1099 average train loss 2.3959
batch:1199 average train loss 2.3691
average train loss 2.3473
Train Consuming time:64.45 in the epoch: 0
total val iterations: 276 
average val loss 2.3835
accuracy ( less than 0.1 ): 0.1211
median val loss 0.6227
total test iterations: 276 
average test loss 2.3532
accuracy ( less than 0.1 ): 0.1189
median test loss 0.6433
Consuming time:84.19 in the epoch: 0
Best test loss is 2.35
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3042
batch:199 average train loss 2.2624
batch:299 average train loss 2.2868
batch:399 average train loss 2.2730
batch:499 average train loss 2.2274
batch:599 average train loss 2.2105
batch:699 average train loss 2.1751
batch:799 average train loss 2.1649
batch:899 average train loss 2.1789
batch:999 average train loss 2.1596
batch:1099 average train loss 2.1630
batch:1199 average train loss 2.1491
average train loss 2.1377
Train Consuming time:65.03 in the epoch: 1
total val iterations: 276 
average val loss 2.3431
accuracy ( less than 0.1 ): 0.1288
median val loss 0.6229
total test iterations: 276 
average test loss 2.3032
accuracy ( less than 0.1 ): 0.1247
median test loss 0.6270
Consuming time:84.58 in the epoch: 1
Best test loss is 2.30
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2276
batch:199 average train loss 2.1779
batch:299 average train loss 2.2021
batch:399 average train loss 2.1995
batch:499 average train loss 2.1562
batch:599 average train loss 2.1462
batch:699 average train loss 2.1140
batch:799 average train loss 2.1035
batch:899 average train loss 2.1229
batch:999 average train loss 2.1063
batch:1099 average train loss 2.1096
batch:1199 average train loss 2.0972
average train loss 2.0850
Train Consuming time:65.05 in the epoch: 2
total val iterations: 276 
average val loss 2.2096
accuracy ( less than 0.1 ): 0.1486
median val loss 0.5648
total test iterations: 276 
average test loss 2.1750
accuracy ( less than 0.1 ): 0.1461
median test loss 0.5649
Consuming time:84.40 in the epoch: 2
Best test loss is 2.17
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1696
batch:199 average train loss 2.1491
batch:299 average train loss 2.1729
batch:399 average train loss 2.1632
batch:499 average train loss 2.1229
batch:599 average train loss 2.1088
batch:699 average train loss 2.0780
batch:799 average train loss 2.0699
batch:899 average train loss 2.0877
batch:999 average train loss 2.0751
batch:1099 average train loss 2.0780
batch:1199 average train loss 2.0674
average train loss 2.0558
Train Consuming time:66.07 in the epoch: 3
total val iterations: 276 
average val loss 2.2569
accuracy ( less than 0.1 ): 0.1390
median val loss 0.5906
total test iterations: 276 
average test loss 2.2513
accuracy ( less than 0.1 ): 0.1342
median test loss 0.6118
Consuming time:85.66 in the epoch: 3
Best test loss is 2.17
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1577
batch:199 average train loss 2.1345
batch:299 average train loss 2.1591
batch:399 average train loss 2.1577
batch:499 average train loss 2.1172
batch:599 average train loss 2.1046
batch:699 average train loss 2.0722
batch:799 average train loss 2.0600
batch:899 average train loss 2.0766
batch:999 average train loss 2.0620
batch:1099 average train loss 2.0638
batch:1199 average train loss 2.0530
average train loss 2.0406
Train Consuming time:65.77 in the epoch: 4
total val iterations: 276 
average val loss 2.1204
accuracy ( less than 0.1 ): 0.1672
median val loss 0.5302
total test iterations: 276 
average test loss 2.0887
accuracy ( less than 0.1 ): 0.1615
median test loss 0.5396
Consuming time:85.64 in the epoch: 4
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1244
batch:199 average train loss 2.1055
batch:299 average train loss 2.1225
batch:399 average train loss 2.1170
batch:499 average train loss 2.0772
batch:599 average train loss 2.0644
batch:699 average train loss 2.0375
batch:799 average train loss 2.0319
batch:899 average train loss 2.0524
batch:999 average train loss 2.0377
batch:1099 average train loss 2.0389
batch:1199 average train loss 2.0293
average train loss 2.0169
Train Consuming time:64.62 in the epoch: 5
total val iterations: 276 
average val loss 2.1506
accuracy ( less than 0.1 ): 0.1630
median val loss 0.5388
total test iterations: 276 
average test loss 2.0994
accuracy ( less than 0.1 ): 0.1591
median test loss 0.5332
Consuming time:84.65 in the epoch: 5
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.0956
batch:199 average train loss 2.0889
batch:299 average train loss 2.0986
batch:399 average train loss 2.1008
batch:499 average train loss 2.0647
batch:599 average train loss 2.0535
batch:699 average train loss 2.0265
batch:799 average train loss 2.0184
batch:899 average train loss 2.0373
batch:999 average train loss 2.0250
batch:1099 average train loss 2.0278
batch:1199 average train loss 2.0166
average train loss 2.0041
Train Consuming time:63.72 in the epoch: 6
total val iterations: 276 
average val loss 2.1791
accuracy ( less than 0.1 ): 0.1503
median val loss 0.5357
total test iterations: 276 
average test loss 2.1545
accuracy ( less than 0.1 ): 0.1490
median test loss 0.5496
Consuming time:83.69 in the epoch: 6
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1214
batch:199 average train loss 2.0883
batch:299 average train loss 2.0989
batch:399 average train loss 2.0970
batch:499 average train loss 2.0594
batch:599 average train loss 2.0437
batch:699 average train loss 2.0175
batch:799 average train loss 2.0074
batch:899 average train loss 2.0268
batch:999 average train loss 2.0112
batch:1099 average train loss 2.0123
batch:1199 average train loss 2.0039
average train loss 1.9915
Train Consuming time:63.32 in the epoch: 7
total val iterations: 276 
average val loss 2.1691
accuracy ( less than 0.1 ): 0.1582
median val loss 0.5344
total test iterations: 276 
average test loss 2.1373
accuracy ( less than 0.1 ): 0.1533
median test loss 0.5588
Consuming time:83.29 in the epoch: 7
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.1052
batch:199 average train loss 2.0742
batch:299 average train loss 2.0825
batch:399 average train loss 2.0876
batch:499 average train loss 2.0446
batch:599 average train loss 2.0289
batch:699 average train loss 2.0022
batch:799 average train loss 1.9906
batch:899 average train loss 2.0077
batch:999 average train loss 1.9914
batch:1099 average train loss 1.9931
batch:1199 average train loss 1.9832
average train loss 1.9724
Train Consuming time:63.84 in the epoch: 8
total val iterations: 276 
average val loss 2.1278
accuracy ( less than 0.1 ): 0.1562
median val loss 0.5158
total test iterations: 276 
average test loss 2.1026
accuracy ( less than 0.1 ): 0.1540
median test loss 0.5478
Consuming time:84.40 in the epoch: 8
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0862
batch:199 average train loss 2.0526
batch:299 average train loss 2.0624
batch:399 average train loss 2.0600
batch:499 average train loss 2.0228
batch:599 average train loss 2.0093
batch:699 average train loss 1.9842
batch:799 average train loss 1.9739
batch:899 average train loss 1.9908
batch:999 average train loss 1.9754
batch:1099 average train loss 1.9762
batch:1199 average train loss 1.9671
average train loss 1.9582
Train Consuming time:64.36 in the epoch: 9
total val iterations: 276 
average val loss 2.1567
accuracy ( less than 0.1 ): 0.1593
median val loss 0.5382
total test iterations: 276 
average test loss 2.1138
accuracy ( less than 0.1 ): 0.1560
median test loss 0.5414
Consuming time:84.47 in the epoch: 9
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.1067
batch:199 average train loss 2.0551
batch:299 average train loss 2.0570
batch:399 average train loss 2.0466
batch:499 average train loss 2.0037
batch:599 average train loss 1.9826
batch:699 average train loss 1.9538
batch:799 average train loss 1.9412
batch:899 average train loss 1.9545
batch:999 average train loss 1.9343
batch:1099 average train loss 1.9326
batch:1199 average train loss 1.9179
average train loss 1.9003
Train Consuming time:63.27 in the epoch: 10
total val iterations: 276 
average val loss 2.0230
accuracy ( less than 0.1 ): 0.2317
median val loss 0.5294
total test iterations: 276 
average test loss 1.9590
accuracy ( less than 0.1 ): 0.2439
median test loss 0.5453
Consuming time:83.33 in the epoch: 10
Best test loss is 1.96
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0320
batch:199 average train loss 1.9951
batch:299 average train loss 2.0091
batch:399 average train loss 2.0049
batch:499 average train loss 1.9669
batch:599 average train loss 1.9486
batch:699 average train loss 1.9214
batch:799 average train loss 1.9107
batch:899 average train loss 1.9244
batch:999 average train loss 1.9056
batch:1099 average train loss 1.9049
batch:1199 average train loss 1.8919
average train loss 1.8767
Train Consuming time:61.54 in the epoch: 11
total val iterations: 276 
average val loss 2.0180
accuracy ( less than 0.1 ): 0.2331
median val loss 0.5299
total test iterations: 276 
average test loss 1.9521
accuracy ( less than 0.1 ): 0.2434
median test loss 0.5439
Consuming time:81.32 in the epoch: 11
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0180
batch:199 average train loss 1.9809
batch:299 average train loss 1.9968
batch:399 average train loss 1.9942
batch:499 average train loss 1.9569
batch:599 average train loss 1.9395
batch:699 average train loss 1.9127
batch:799 average train loss 1.9019
batch:899 average train loss 1.9152
batch:999 average train loss 1.8968
batch:1099 average train loss 1.8963
batch:1199 average train loss 1.8836
average train loss 1.8689
Train Consuming time:62.80 in the epoch: 12
total val iterations: 276 
average val loss 2.0141
accuracy ( less than 0.1 ): 0.2325
median val loss 0.5297
total test iterations: 276 
average test loss 1.9476
accuracy ( less than 0.1 ): 0.2436
median test loss 0.5477
Consuming time:82.80 in the epoch: 12
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0142
batch:199 average train loss 1.9766
batch:299 average train loss 1.9918
batch:399 average train loss 1.9887
batch:499 average train loss 1.9515
batch:599 average train loss 1.9343
batch:699 average train loss 1.9078
batch:799 average train loss 1.8969
batch:899 average train loss 1.9101
batch:999 average train loss 1.8914
batch:1099 average train loss 1.8908
batch:1199 average train loss 1.8783
average train loss 1.8641
Train Consuming time:63.72 in the epoch: 13
total val iterations: 276 
average val loss 2.0131
accuracy ( less than 0.1 ): 0.2326
median val loss 0.5289
total test iterations: 276 
average test loss 1.9459
accuracy ( less than 0.1 ): 0.2443
median test loss 0.5506
Consuming time:83.80 in the epoch: 13
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 2.0091
batch:199 average train loss 1.9719
batch:299 average train loss 1.9867
batch:399 average train loss 1.9846
batch:499 average train loss 1.9475
batch:599 average train loss 1.9308
batch:699 average train loss 1.9045
batch:799 average train loss 1.8935
batch:899 average train loss 1.9064
batch:999 average train loss 1.8876
batch:1099 average train loss 1.8868
batch:1199 average train loss 1.8744
average train loss 1.8603
Train Consuming time:63.68 in the epoch: 14
total val iterations: 276 
average val loss 2.0118
accuracy ( less than 0.1 ): 0.2325
median val loss 0.5272
total test iterations: 276 
average test loss 1.9457
accuracy ( less than 0.1 ): 0.2425
median test loss 0.5539
Consuming time:83.54 in the epoch: 14
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 2.0029
batch:199 average train loss 1.9673
batch:299 average train loss 1.9818
batch:399 average train loss 1.9804
batch:499 average train loss 1.9436
batch:599 average train loss 1.9274
batch:699 average train loss 1.9013
batch:799 average train loss 1.8902
batch:899 average train loss 1.9029
batch:999 average train loss 1.8840
batch:1099 average train loss 1.8832
batch:1199 average train loss 1.8709
average train loss 1.8571
Train Consuming time:61.95 in the epoch: 15
total val iterations: 276 
average val loss 2.0101
accuracy ( less than 0.1 ): 0.2319
median val loss 0.5284
total test iterations: 276 
average test loss 1.9451
accuracy ( less than 0.1 ): 0.2424
median test loss 0.5516
Consuming time:80.95 in the epoch: 15
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9982
batch:199 average train loss 1.9640
batch:299 average train loss 1.9782
batch:399 average train loss 1.9770
batch:499 average train loss 1.9405
batch:599 average train loss 1.9245
batch:699 average train loss 1.8984
batch:799 average train loss 1.8873
batch:899 average train loss 1.8999
batch:999 average train loss 1.8809
batch:1099 average train loss 1.8802
batch:1199 average train loss 1.8680
average train loss 1.8543
Train Consuming time:61.25 in the epoch: 16
total val iterations: 276 
average val loss 2.0096
accuracy ( less than 0.1 ): 0.2327
median val loss 0.5271
total test iterations: 276 
average test loss 1.9449
accuracy ( less than 0.1 ): 0.2423
median test loss 0.5521
Consuming time:80.34 in the epoch: 16
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9944
batch:199 average train loss 1.9604
batch:299 average train loss 1.9746
batch:399 average train loss 1.9735
batch:499 average train loss 1.9373
batch:599 average train loss 1.9218
batch:699 average train loss 1.8956
batch:799 average train loss 1.8843
batch:899 average train loss 1.8969
batch:999 average train loss 1.8779
batch:1099 average train loss 1.8772
batch:1199 average train loss 1.8651
average train loss 1.8516
Train Consuming time:61.55 in the epoch: 17
total val iterations: 276 
average val loss 2.0087
accuracy ( less than 0.1 ): 0.2324
median val loss 0.5288
total test iterations: 276 
average test loss 1.9451
accuracy ( less than 0.1 ): 0.2412
median test loss 0.5511
Consuming time:80.87 in the epoch: 17
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9916
batch:199 average train loss 1.9576
batch:299 average train loss 1.9720
batch:399 average train loss 1.9710
batch:499 average train loss 1.9350
batch:599 average train loss 1.9197
batch:699 average train loss 1.8934
batch:799 average train loss 1.8820
batch:899 average train loss 1.8947
batch:999 average train loss 1.8757
batch:1099 average train loss 1.8750
batch:1199 average train loss 1.8630
average train loss 1.8496
Train Consuming time:61.07 in the epoch: 18
total val iterations: 276 
average val loss 2.0084
accuracy ( less than 0.1 ): 0.2306
median val loss 0.5250
total test iterations: 276 
average test loss 1.9454
accuracy ( less than 0.1 ): 0.2400
median test loss 0.5501
Consuming time:80.47 in the epoch: 18
Best test loss is 1.94
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9892
batch:199 average train loss 1.9557
batch:299 average train loss 1.9698
batch:399 average train loss 1.9689
batch:499 average train loss 1.9328
batch:599 average train loss 1.9176
batch:699 average train loss 1.8914
batch:799 average train loss 1.8799
batch:899 average train loss 1.8926
batch:999 average train loss 1.8735
batch:1099 average train loss 1.8729
batch:1199 average train loss 1.8611
average train loss 1.8478
Train Consuming time:62.40 in the epoch: 19
total val iterations: 276 
average val loss 2.0079
accuracy ( less than 0.1 ): 0.2327
median val loss 0.5257
total test iterations: 276 
average test loss 1.9449
accuracy ( less than 0.1 ): 0.2406
median test loss 0.5503
Consuming time:86.11 in the epoch: 19
Best test loss is 1.94
---------------*****---------------
