/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:81.61697101593018
====bidirected: False,attention: ====
total parameters 44201
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.4860
batch:199 average train loss 2.9793
batch:299 average train loss 2.8362
batch:399 average train loss 2.7042
batch:499 average train loss 2.6000
batch:599 average train loss 2.5503
batch:699 average train loss 2.4927
batch:799 average train loss 2.4577
batch:899 average train loss 2.4510
batch:999 average train loss 2.4135
batch:1099 average train loss 2.4045
batch:1199 average train loss 2.3759
average train loss 2.3557
Train Consuming time:67.68 in the epoch: 0
total val iterations: 276 
average val loss 2.3286
accuracy ( less than 0.1 ): 0.1466
median val loss 0.5947
total test iterations: 276 
average test loss 2.2654
accuracy ( less than 0.1 ): 0.1384
median test loss 0.5822
Consuming time:89.11 in the epoch: 0
Best test loss is 2.27
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3304
batch:199 average train loss 2.2581
batch:299 average train loss 2.2945
batch:399 average train loss 2.2627
batch:499 average train loss 2.2208
batch:599 average train loss 2.2138
batch:699 average train loss 2.1837
batch:799 average train loss 2.1780
batch:899 average train loss 2.1912
batch:999 average train loss 2.1732
batch:1099 average train loss 2.1771
batch:1199 average train loss 2.1632
average train loss 2.1507
Train Consuming time:68.99 in the epoch: 1
total val iterations: 276 
average val loss 2.2637
accuracy ( less than 0.1 ): 0.1615
median val loss 0.6065
total test iterations: 276 
average test loss 2.2423
accuracy ( less than 0.1 ): 0.1509
median test loss 0.6105
Consuming time:90.14 in the epoch: 1
Best test loss is 2.24
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2727
batch:199 average train loss 2.2198
batch:299 average train loss 2.2410
batch:399 average train loss 2.2175
batch:499 average train loss 2.1722
batch:599 average train loss 2.1602
batch:699 average train loss 2.1315
batch:799 average train loss 2.1251
batch:899 average train loss 2.1422
batch:999 average train loss 2.1253
batch:1099 average train loss 2.1290
batch:1199 average train loss 2.1144
average train loss 2.1056
Train Consuming time:65.86 in the epoch: 2
total val iterations: 276 
average val loss 2.2040
accuracy ( less than 0.1 ): 0.1515
median val loss 0.5692
total test iterations: 276 
average test loss 2.1745
accuracy ( less than 0.1 ): 0.1452
median test loss 0.5576
Consuming time:87.01 in the epoch: 2
Best test loss is 2.17
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.2044
batch:199 average train loss 2.1813
batch:299 average train loss 2.1963
batch:399 average train loss 2.1795
batch:499 average train loss 2.1347
batch:599 average train loss 2.1209
batch:699 average train loss 2.0900
batch:799 average train loss 2.0832
batch:899 average train loss 2.0993
batch:999 average train loss 2.0837
batch:1099 average train loss 2.0867
batch:1199 average train loss 2.0714
average train loss 2.0616
Train Consuming time:67.96 in the epoch: 3
total val iterations: 276 
average val loss 2.2087
accuracy ( less than 0.1 ): 0.1531
median val loss 0.5525
total test iterations: 276 
average test loss 2.1972
accuracy ( less than 0.1 ): 0.1478
median test loss 0.5700
Consuming time:89.06 in the epoch: 3
Best test loss is 2.17
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1833
batch:199 average train loss 2.1378
batch:299 average train loss 2.1640
batch:399 average train loss 2.1453
batch:499 average train loss 2.1044
batch:599 average train loss 2.0937
batch:699 average train loss 2.0629
batch:799 average train loss 2.0569
batch:899 average train loss 2.0699
batch:999 average train loss 2.0551
batch:1099 average train loss 2.0581
batch:1199 average train loss 2.0449
average train loss 2.0366
Train Consuming time:68.72 in the epoch: 4
total val iterations: 276 
average val loss 2.2162
accuracy ( less than 0.1 ): 0.1512
median val loss 0.5505
total test iterations: 276 
average test loss 2.1890
accuracy ( less than 0.1 ): 0.1381
median test loss 0.5532
Consuming time:89.97 in the epoch: 4
Best test loss is 2.17
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1702
batch:199 average train loss 2.1176
batch:299 average train loss 2.1372
batch:399 average train loss 2.1223
batch:499 average train loss 2.0830
batch:599 average train loss 2.0738
batch:699 average train loss 2.0444
batch:799 average train loss 2.0363
batch:899 average train loss 2.0510
batch:999 average train loss 2.0383
batch:1099 average train loss 2.0428
batch:1199 average train loss 2.0305
average train loss 2.0203
Train Consuming time:68.97 in the epoch: 5
total val iterations: 276 
average val loss 2.1520
accuracy ( less than 0.1 ): 0.1540
median val loss 0.5260
total test iterations: 276 
average test loss 2.1331
accuracy ( less than 0.1 ): 0.1469
median test loss 0.5340
Consuming time:90.14 in the epoch: 5
Best test loss is 2.13
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1271
batch:199 average train loss 2.0949
batch:299 average train loss 2.1165
batch:399 average train loss 2.1012
batch:499 average train loss 2.0636
batch:599 average train loss 2.0551
batch:699 average train loss 2.0265
batch:799 average train loss 2.0203
batch:899 average train loss 2.0377
batch:999 average train loss 2.0251
batch:1099 average train loss 2.0299
batch:1199 average train loss 2.0191
average train loss 2.0079
Train Consuming time:67.78 in the epoch: 6
total val iterations: 276 
average val loss 2.2026
accuracy ( less than 0.1 ): 0.1485
median val loss 0.5579
total test iterations: 276 
average test loss 2.1936
accuracy ( less than 0.1 ): 0.1393
median test loss 0.5697
Consuming time:88.94 in the epoch: 6
Best test loss is 2.13
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1254
batch:199 average train loss 2.0886
batch:299 average train loss 2.1097
batch:399 average train loss 2.0981
batch:499 average train loss 2.0554
batch:599 average train loss 2.0472
batch:699 average train loss 2.0197
batch:799 average train loss 2.0139
batch:899 average train loss 2.0313
batch:999 average train loss 2.0191
batch:1099 average train loss 2.0213
batch:1199 average train loss 2.0092
average train loss 1.9995
Train Consuming time:67.69 in the epoch: 7
total val iterations: 276 
average val loss 2.2060
accuracy ( less than 0.1 ): 0.1317
median val loss 0.5610
total test iterations: 276 
average test loss 2.2035
accuracy ( less than 0.1 ): 0.1276
median test loss 0.5609
Consuming time:89.01 in the epoch: 7
Best test loss is 2.13
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0927
batch:199 average train loss 2.0677
batch:299 average train loss 2.0948
batch:399 average train loss 2.0804
batch:499 average train loss 2.0395
batch:599 average train loss 2.0315
batch:699 average train loss 2.0033
batch:799 average train loss 1.9979
batch:899 average train loss 2.0169
batch:999 average train loss 2.0028
batch:1099 average train loss 2.0051
batch:1199 average train loss 1.9935
average train loss 1.9829
Train Consuming time:68.10 in the epoch: 8
total val iterations: 276 
average val loss 2.2749
accuracy ( less than 0.1 ): 0.1368
median val loss 0.5598
total test iterations: 276 
average test loss 2.2532
accuracy ( less than 0.1 ): 0.1292
median test loss 0.5643
Consuming time:90.02 in the epoch: 8
Best test loss is 2.13
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0865
batch:199 average train loss 2.0550
batch:299 average train loss 2.0729
batch:399 average train loss 2.0581
batch:499 average train loss 2.0216
batch:599 average train loss 2.0175
batch:699 average train loss 1.9936
batch:799 average train loss 1.9855
batch:899 average train loss 2.0001
batch:999 average train loss 1.9866
batch:1099 average train loss 1.9901
batch:1199 average train loss 1.9771
average train loss 1.9689
Train Consuming time:68.84 in the epoch: 9
total val iterations: 276 
average val loss 2.1239
accuracy ( less than 0.1 ): 0.1635
median val loss 0.5154
total test iterations: 276 
average test loss 2.1219
accuracy ( less than 0.1 ): 0.1589
median test loss 0.5245
Consuming time:90.92 in the epoch: 9
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0921
batch:199 average train loss 2.0486
batch:299 average train loss 2.0591
batch:399 average train loss 2.0424
batch:499 average train loss 2.0000
batch:599 average train loss 1.9890
batch:699 average train loss 1.9599
batch:799 average train loss 1.9504
batch:899 average train loss 1.9638
batch:999 average train loss 1.9443
batch:1099 average train loss 1.9449
batch:1199 average train loss 1.9270
average train loss 1.9106
Train Consuming time:68.82 in the epoch: 10
total val iterations: 276 
average val loss 2.0287
accuracy ( less than 0.1 ): 0.2318
median val loss 0.5383
total test iterations: 276 
average test loss 1.9926
accuracy ( less than 0.1 ): 0.2344
median test loss 0.5698
Consuming time:90.91 in the epoch: 10
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0368
batch:199 average train loss 2.0039
batch:299 average train loss 2.0222
batch:399 average train loss 2.0096
batch:499 average train loss 1.9697
batch:599 average train loss 1.9624
batch:699 average train loss 1.9346
batch:799 average train loss 1.9261
batch:899 average train loss 1.9400
batch:999 average train loss 1.9218
batch:1099 average train loss 1.9233
batch:1199 average train loss 1.9067
average train loss 1.8921
Train Consuming time:68.19 in the epoch: 11
total val iterations: 276 
average val loss 2.0208
accuracy ( less than 0.1 ): 0.2308
median val loss 0.5350
total test iterations: 276 
average test loss 1.9819
accuracy ( less than 0.1 ): 0.2342
median test loss 0.5679
Consuming time:90.36 in the epoch: 11
Best test loss is 1.98
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0217
batch:199 average train loss 1.9884
batch:299 average train loss 2.0082
batch:399 average train loss 1.9968
batch:499 average train loss 1.9577
batch:599 average train loss 1.9514
batch:699 average train loss 1.9235
batch:799 average train loss 1.9151
batch:899 average train loss 1.9291
batch:999 average train loss 1.9113
batch:1099 average train loss 1.9131
batch:1199 average train loss 1.8969
average train loss 1.8831
Train Consuming time:68.80 in the epoch: 12
total val iterations: 276 
average val loss 2.0154
accuracy ( less than 0.1 ): 0.2300
median val loss 0.5369
total test iterations: 276 
average test loss 1.9767
accuracy ( less than 0.1 ): 0.2334
median test loss 0.5596
Consuming time:91.26 in the epoch: 12
Best test loss is 1.98
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0126
batch:199 average train loss 1.9785
batch:299 average train loss 1.9995
batch:399 average train loss 1.9886
batch:499 average train loss 1.9502
batch:599 average train loss 1.9443
batch:699 average train loss 1.9167
batch:799 average train loss 1.9080
batch:899 average train loss 1.9220
batch:999 average train loss 1.9044
batch:1099 average train loss 1.9059
batch:1199 average train loss 1.8901
average train loss 1.8769
Train Consuming time:69.08 in the epoch: 13
total val iterations: 276 
average val loss 2.0119
accuracy ( less than 0.1 ): 0.2307
median val loss 0.5348
total test iterations: 276 
average test loss 1.9731
accuracy ( less than 0.1 ): 0.2343
median test loss 0.5576
Consuming time:91.39 in the epoch: 13
Best test loss is 1.97
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 2.0075
batch:199 average train loss 1.9726
batch:299 average train loss 1.9939
batch:399 average train loss 1.9836
batch:499 average train loss 1.9451
batch:599 average train loss 1.9392
batch:699 average train loss 1.9115
batch:799 average train loss 1.9024
batch:899 average train loss 1.9162
batch:999 average train loss 1.8985
batch:1099 average train loss 1.9006
batch:1199 average train loss 1.8850
average train loss 1.8721
Train Consuming time:67.35 in the epoch: 14
total val iterations: 276 
average val loss 2.0093
accuracy ( less than 0.1 ): 0.2310
median val loss 0.5344
total test iterations: 276 
average test loss 1.9710
accuracy ( less than 0.1 ): 0.2340
median test loss 0.5555
Consuming time:88.45 in the epoch: 14
Best test loss is 1.97
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 2.0019
batch:199 average train loss 1.9683
batch:299 average train loss 1.9899
batch:399 average train loss 1.9801
batch:499 average train loss 1.9413
batch:599 average train loss 1.9352
batch:699 average train loss 1.9075
batch:799 average train loss 1.8982
batch:899 average train loss 1.9119
batch:999 average train loss 1.8945
batch:1099 average train loss 1.8965
batch:1199 average train loss 1.8813
average train loss 1.8689
Train Consuming time:66.15 in the epoch: 15
total val iterations: 276 
average val loss 2.0075
accuracy ( less than 0.1 ): 0.2315
median val loss 0.5325
total test iterations: 276 
average test loss 1.9689
accuracy ( less than 0.1 ): 0.2360
median test loss 0.5572
Consuming time:87.40 in the epoch: 15
Best test loss is 1.97
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9989
batch:199 average train loss 1.9647
batch:299 average train loss 1.9860
batch:399 average train loss 1.9762
batch:499 average train loss 1.9377
batch:599 average train loss 1.9316
batch:699 average train loss 1.9037
batch:799 average train loss 1.8942
batch:899 average train loss 1.9083
batch:999 average train loss 1.8912
batch:1099 average train loss 1.8932
batch:1199 average train loss 1.8781
average train loss 1.8658
Train Consuming time:65.74 in the epoch: 16
total val iterations: 276 
average val loss 2.0062
accuracy ( less than 0.1 ): 0.2318
median val loss 0.5313
total test iterations: 276 
average test loss 1.9682
accuracy ( less than 0.1 ): 0.2356
median test loss 0.5520
Consuming time:86.57 in the epoch: 16
Best test loss is 1.97
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9955
batch:199 average train loss 1.9613
batch:299 average train loss 1.9826
batch:399 average train loss 1.9727
batch:499 average train loss 1.9343
batch:599 average train loss 1.9281
batch:699 average train loss 1.9003
batch:799 average train loss 1.8906
batch:899 average train loss 1.9046
batch:999 average train loss 1.8874
batch:1099 average train loss 1.8897
batch:1199 average train loss 1.8747
average train loss 1.8625
Train Consuming time:65.37 in the epoch: 17
total val iterations: 276 
average val loss 2.0042
accuracy ( less than 0.1 ): 0.2322
median val loss 0.5320
total test iterations: 276 
average test loss 1.9663
accuracy ( less than 0.1 ): 0.2348
median test loss 0.5537
Consuming time:86.16 in the epoch: 17
Best test loss is 1.97
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9935
batch:199 average train loss 1.9589
batch:299 average train loss 1.9802
batch:399 average train loss 1.9703
batch:499 average train loss 1.9319
batch:599 average train loss 1.9255
batch:699 average train loss 1.8978
batch:799 average train loss 1.8879
batch:899 average train loss 1.9021
batch:999 average train loss 1.8850
batch:1099 average train loss 1.8873
batch:1199 average train loss 1.8724
average train loss 1.8605
Train Consuming time:72.68 in the epoch: 18
total val iterations: 276 
average val loss 2.0031
accuracy ( less than 0.1 ): 0.2328
median val loss 0.5308
total test iterations: 276 
average test loss 1.9653
accuracy ( less than 0.1 ): 0.2357
median test loss 0.5553
Consuming time:95.36 in the epoch: 18
Best test loss is 1.97
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9919
batch:199 average train loss 1.9567
batch:299 average train loss 1.9775
batch:399 average train loss 1.9676
batch:499 average train loss 1.9291
batch:599 average train loss 1.9227
batch:699 average train loss 1.8948
batch:799 average train loss 1.8850
batch:899 average train loss 1.8989
batch:999 average train loss 1.8819
batch:1099 average train loss 1.8843
batch:1199 average train loss 1.8695
average train loss 1.8576
Train Consuming time:63.04 in the epoch: 19
total val iterations: 276 
average val loss 2.0015
accuracy ( less than 0.1 ): 0.2319
median val loss 0.5320
total test iterations: 276 
average test loss 1.9640
accuracy ( less than 0.1 ): 0.2361
median test loss 0.5550
Consuming time:83.11 in the epoch: 19
Best test loss is 1.96
---------------*****---------------
