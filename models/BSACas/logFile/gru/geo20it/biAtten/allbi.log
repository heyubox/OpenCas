/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:73.78979778289795
geometric gcn
total parameters 76553
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8279
batch:199 average train loss 3.5389
batch:299 average train loss 3.3290
batch:399 average train loss 3.1309
batch:499 average train loss 2.9862
batch:599 average train loss 2.8672
batch:699 average train loss 2.7599
batch:799 average train loss 2.7002
batch:899 average train loss 2.6696
batch:999 average train loss 2.6179
batch:1099 average train loss 2.5900
batch:1199 average train loss 2.5471
average train loss 2.5171
Train Consuming time:579.88 in the epoch: 0
total val iterations: 276 
average val loss 2.3579
accuracy ( less than 0.1 ): 0.1509
median val loss 0.5591
total test iterations: 276 
average test loss 2.3193
accuracy ( less than 0.1 ): 0.1457
median test loss 0.5611
Consuming time:811.37 in the epoch: 0
Best test loss is 2.32
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3327
batch:199 average train loss 2.2823
batch:299 average train loss 2.2965
batch:399 average train loss 2.2680
batch:499 average train loss 2.2324
batch:599 average train loss 2.2116
batch:699 average train loss 2.1774
batch:799 average train loss 2.1679
batch:899 average train loss 2.1803
batch:999 average train loss 2.1648
batch:1099 average train loss 2.1642
batch:1199 average train loss 2.1488
average train loss 2.1380
Train Consuming time:90.50 in the epoch: 1
total val iterations: 276 
average val loss 2.1727
accuracy ( less than 0.1 ): 0.2006
median val loss 0.5356
total test iterations: 276 
average test loss 2.0943
accuracy ( less than 0.1 ): 0.1963
median test loss 0.5450
Consuming time:115.28 in the epoch: 1
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2313
batch:199 average train loss 2.1944
batch:299 average train loss 2.2122
batch:399 average train loss 2.1881
batch:499 average train loss 2.1467
batch:599 average train loss 2.1330
batch:699 average train loss 2.1051
batch:799 average train loss 2.0971
batch:899 average train loss 2.1115
batch:999 average train loss 2.0979
batch:1099 average train loss 2.0992
batch:1199 average train loss 2.0879
average train loss 2.0778
Train Consuming time:90.90 in the epoch: 2
total val iterations: 276 
average val loss 2.1509
accuracy ( less than 0.1 ): 0.1963
median val loss 0.5309
total test iterations: 276 
average test loss 2.0749
accuracy ( less than 0.1 ): 0.1903
median test loss 0.5319
Consuming time:115.80 in the epoch: 2
Best test loss is 2.07
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1732
batch:199 average train loss 2.1498
batch:299 average train loss 2.1669
batch:399 average train loss 2.1498
batch:499 average train loss 2.1071
batch:599 average train loss 2.0943
batch:699 average train loss 2.0683
batch:799 average train loss 2.0599
batch:899 average train loss 2.0768
batch:999 average train loss 2.0634
batch:1099 average train loss 2.0641
batch:1199 average train loss 2.0541
average train loss 2.0443
Train Consuming time:89.90 in the epoch: 3
total val iterations: 276 
average val loss 2.1377
accuracy ( less than 0.1 ): 0.1953
median val loss 0.5296
total test iterations: 276 
average test loss 2.0536
accuracy ( less than 0.1 ): 0.1910
median test loss 0.5356
Consuming time:114.06 in the epoch: 3
Best test loss is 2.05
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1558
batch:199 average train loss 2.1333
batch:299 average train loss 2.1472
batch:399 average train loss 2.1280
batch:499 average train loss 2.0839
batch:599 average train loss 2.0713
batch:699 average train loss 2.0457
batch:799 average train loss 2.0363
batch:899 average train loss 2.0543
batch:999 average train loss 2.0411
batch:1099 average train loss 2.0419
batch:1199 average train loss 2.0317
average train loss 2.0221
Train Consuming time:90.95 in the epoch: 4
total val iterations: 276 
average val loss 2.1106
accuracy ( less than 0.1 ): 0.1911
median val loss 0.5110
total test iterations: 276 
average test loss 2.0233
accuracy ( less than 0.1 ): 0.1897
median test loss 0.5087
Consuming time:115.92 in the epoch: 4
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1132
batch:199 average train loss 2.1020
batch:299 average train loss 2.1181
batch:399 average train loss 2.1042
batch:499 average train loss 2.0617
batch:599 average train loss 2.0498
batch:699 average train loss 2.0240
batch:799 average train loss 2.0147
batch:899 average train loss 2.0330
batch:999 average train loss 2.0205
batch:1099 average train loss 2.0207
batch:1199 average train loss 2.0112
average train loss 2.0019
Train Consuming time:90.88 in the epoch: 5
total val iterations: 276 
average val loss 2.0852
accuracy ( less than 0.1 ): 0.1984
median val loss 0.5043
total test iterations: 276 
average test loss 2.0059
accuracy ( less than 0.1 ): 0.1970
median test loss 0.5146
Consuming time:115.69 in the epoch: 5
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.0943
batch:199 average train loss 2.0840
batch:299 average train loss 2.0986
batch:399 average train loss 2.0853
batch:499 average train loss 2.0461
batch:599 average train loss 2.0351
batch:699 average train loss 2.0086
batch:799 average train loss 1.9987
batch:899 average train loss 2.0166
batch:999 average train loss 2.0044
batch:1099 average train loss 2.0053
batch:1199 average train loss 1.9963
average train loss 1.9868
Train Consuming time:90.85 in the epoch: 6
total val iterations: 276 
average val loss 2.0712
accuracy ( less than 0.1 ): 0.1889
median val loss 0.4914
total test iterations: 276 
average test loss 1.9768
accuracy ( less than 0.1 ): 0.1920
median test loss 0.5136
Consuming time:115.66 in the epoch: 6
Best test loss is 1.98
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.0811
batch:199 average train loss 2.0613
batch:299 average train loss 2.0816
batch:399 average train loss 2.0684
batch:499 average train loss 2.0279
batch:599 average train loss 2.0182
batch:699 average train loss 1.9921
batch:799 average train loss 1.9837
batch:899 average train loss 2.0033
batch:999 average train loss 1.9912
batch:1099 average train loss 1.9917
batch:1199 average train loss 1.9830
average train loss 1.9744
Train Consuming time:90.68 in the epoch: 7
total val iterations: 276 
average val loss 2.0734
accuracy ( less than 0.1 ): 0.1876
median val loss 0.4980
total test iterations: 276 
average test loss 1.9987
accuracy ( less than 0.1 ): 0.1908
median test loss 0.5107
Consuming time:115.35 in the epoch: 7
Best test loss is 1.98
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0625
batch:199 average train loss 2.0569
batch:299 average train loss 2.0774
batch:399 average train loss 2.0651
batch:499 average train loss 2.0233
batch:599 average train loss 2.0126
batch:699 average train loss 1.9846
batch:799 average train loss 1.9761
batch:899 average train loss 1.9952
batch:999 average train loss 1.9833
batch:1099 average train loss 1.9836
batch:1199 average train loss 1.9749
average train loss 1.9656
Train Consuming time:90.32 in the epoch: 8
total val iterations: 276 
average val loss 2.0885
accuracy ( less than 0.1 ): 0.1706
median val loss 0.4988
total test iterations: 276 
average test loss 1.9929
accuracy ( less than 0.1 ): 0.1693
median test loss 0.5006
Consuming time:114.53 in the epoch: 8
Best test loss is 1.98
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0561
batch:199 average train loss 2.0499
batch:299 average train loss 2.0640
batch:399 average train loss 2.0514
batch:499 average train loss 2.0097
batch:599 average train loss 1.9993
batch:699 average train loss 1.9736
batch:799 average train loss 1.9647
batch:899 average train loss 1.9839
batch:999 average train loss 1.9722
batch:1099 average train loss 1.9728
batch:1199 average train loss 1.9640
average train loss 1.9540
Train Consuming time:89.87 in the epoch: 9
total val iterations: 276 
average val loss 2.0411
accuracy ( less than 0.1 ): 0.1826
median val loss 0.4754
total test iterations: 276 
average test loss 1.9476
accuracy ( less than 0.1 ): 0.1833
median test loss 0.4907
Consuming time:114.58 in the epoch: 9
Best test loss is 1.95
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0426
batch:199 average train loss 2.0089
batch:299 average train loss 2.0098
batch:399 average train loss 1.9991
batch:499 average train loss 1.9554
batch:599 average train loss 1.9459
batch:699 average train loss 1.9180
batch:799 average train loss 1.9100
batch:899 average train loss 1.9307
batch:999 average train loss 1.9130
batch:1099 average train loss 1.9136
batch:1199 average train loss 1.9023
average train loss 1.8896
Train Consuming time:89.01 in the epoch: 10
total val iterations: 276 
average val loss 1.9847
accuracy ( less than 0.1 ): 0.2197
median val loss 0.4866
total test iterations: 276 
average test loss 1.8763
accuracy ( less than 0.1 ): 0.2243
median test loss 0.5087
Consuming time:113.25 in the epoch: 10
Best test loss is 1.88
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0078
batch:199 average train loss 1.9823
batch:299 average train loss 1.9827
batch:399 average train loss 1.9728
batch:499 average train loss 1.9330
batch:599 average train loss 1.9260
batch:699 average train loss 1.8992
batch:799 average train loss 1.8929
batch:899 average train loss 1.9142
batch:999 average train loss 1.8974
batch:1099 average train loss 1.8984
batch:1199 average train loss 1.8877
average train loss 1.8758
Train Consuming time:88.98 in the epoch: 11
total val iterations: 276 
average val loss 1.9785
accuracy ( less than 0.1 ): 0.2213
median val loss 0.4868
total test iterations: 276 
average test loss 1.8700
accuracy ( less than 0.1 ): 0.2223
median test loss 0.5097
Consuming time:113.24 in the epoch: 11
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 1.9979
batch:199 average train loss 1.9730
batch:299 average train loss 1.9732
batch:399 average train loss 1.9637
batch:499 average train loss 1.9248
batch:599 average train loss 1.9187
batch:699 average train loss 1.8924
batch:799 average train loss 1.8863
batch:899 average train loss 1.9077
batch:999 average train loss 1.8910
batch:1099 average train loss 1.8920
batch:1199 average train loss 1.8815
average train loss 1.8699
Train Consuming time:89.04 in the epoch: 12
total val iterations: 276 
average val loss 1.9734
accuracy ( less than 0.1 ): 0.2220
median val loss 0.4915
total test iterations: 276 
average test loss 1.8659
accuracy ( less than 0.1 ): 0.2227
median test loss 0.5130
Consuming time:113.23 in the epoch: 12
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 1.9930
batch:199 average train loss 1.9684
batch:299 average train loss 1.9672
batch:399 average train loss 1.9577
batch:499 average train loss 1.9192
batch:599 average train loss 1.9137
batch:699 average train loss 1.8877
batch:799 average train loss 1.8817
batch:899 average train loss 1.9032
batch:999 average train loss 1.8865
batch:1099 average train loss 1.8876
batch:1199 average train loss 1.8772
average train loss 1.8657
Train Consuming time:89.32 in the epoch: 13
total val iterations: 276 
average val loss 1.9706
accuracy ( less than 0.1 ): 0.2225
median val loss 0.4927
total test iterations: 276 
average test loss 1.8637
accuracy ( less than 0.1 ): 0.2228
median test loss 0.5138
Consuming time:113.90 in the epoch: 13
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9890
batch:199 average train loss 1.9650
batch:299 average train loss 1.9636
batch:399 average train loss 1.9541
batch:499 average train loss 1.9159
batch:599 average train loss 1.9111
batch:699 average train loss 1.8851
batch:799 average train loss 1.8791
batch:899 average train loss 1.9005
batch:999 average train loss 1.8837
batch:1099 average train loss 1.8848
batch:1199 average train loss 1.8744
average train loss 1.8630
Train Consuming time:90.05 in the epoch: 14
total val iterations: 276 
average val loss 1.9678
accuracy ( less than 0.1 ): 0.2228
median val loss 0.4925
total test iterations: 276 
average test loss 1.8611
accuracy ( less than 0.1 ): 0.2230
median test loss 0.5146
Consuming time:114.64 in the epoch: 14
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9849
batch:199 average train loss 1.9613
batch:299 average train loss 1.9600
batch:399 average train loss 1.9506
batch:499 average train loss 1.9123
batch:599 average train loss 1.9080
batch:699 average train loss 1.8820
batch:799 average train loss 1.8760
batch:899 average train loss 1.8974
batch:999 average train loss 1.8807
batch:1099 average train loss 1.8818
batch:1199 average train loss 1.8716
average train loss 1.8601
Train Consuming time:90.24 in the epoch: 15
total val iterations: 276 
average val loss 1.9655
accuracy ( less than 0.1 ): 0.2242
median val loss 0.4948
total test iterations: 276 
average test loss 1.8590
accuracy ( less than 0.1 ): 0.2253
median test loss 0.5185
Consuming time:114.99 in the epoch: 15
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9814
batch:199 average train loss 1.9585
batch:299 average train loss 1.9571
batch:399 average train loss 1.9479
batch:499 average train loss 1.9098
batch:599 average train loss 1.9057
batch:699 average train loss 1.8798
batch:799 average train loss 1.8735
batch:899 average train loss 1.8950
batch:999 average train loss 1.8784
batch:1099 average train loss 1.8795
batch:1199 average train loss 1.8694
average train loss 1.8580
Train Consuming time:91.04 in the epoch: 16
total val iterations: 276 
average val loss 1.9641
accuracy ( less than 0.1 ): 0.2251
median val loss 0.4935
total test iterations: 276 
average test loss 1.8577
accuracy ( less than 0.1 ): 0.2265
median test loss 0.5170
Consuming time:115.80 in the epoch: 16
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9800
batch:199 average train loss 1.9569
batch:299 average train loss 1.9555
batch:399 average train loss 1.9464
batch:499 average train loss 1.9081
batch:599 average train loss 1.9040
batch:699 average train loss 1.8780
batch:799 average train loss 1.8719
batch:899 average train loss 1.8935
batch:999 average train loss 1.8770
batch:1099 average train loss 1.8779
batch:1199 average train loss 1.8677
average train loss 1.8565
Train Consuming time:90.40 in the epoch: 17
total val iterations: 276 
average val loss 1.9629
accuracy ( less than 0.1 ): 0.2247
median val loss 0.4915
total test iterations: 276 
average test loss 1.8564
accuracy ( less than 0.1 ): 0.2263
median test loss 0.5156
Consuming time:115.05 in the epoch: 17
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9784
batch:199 average train loss 1.9557
batch:299 average train loss 1.9546
batch:399 average train loss 1.9453
batch:499 average train loss 1.9071
batch:599 average train loss 1.9031
batch:699 average train loss 1.8769
batch:799 average train loss 1.8708
batch:899 average train loss 1.8924
batch:999 average train loss 1.8758
batch:1099 average train loss 1.8767
batch:1199 average train loss 1.8667
average train loss 1.8555
Train Consuming time:90.20 in the epoch: 18
total val iterations: 276 
average val loss 1.9622
accuracy ( less than 0.1 ): 0.2240
median val loss 0.4902
total test iterations: 276 
average test loss 1.8560
accuracy ( less than 0.1 ): 0.2255
median test loss 0.5208
Consuming time:115.02 in the epoch: 18
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9776
batch:199 average train loss 1.9542
batch:299 average train loss 1.9533
batch:399 average train loss 1.9443
batch:499 average train loss 1.9059
batch:599 average train loss 1.9018
batch:699 average train loss 1.8758
batch:799 average train loss 1.8697
batch:899 average train loss 1.8914
batch:999 average train loss 1.8749
batch:1099 average train loss 1.8757
batch:1199 average train loss 1.8657
average train loss 1.8546
Train Consuming time:90.27 in the epoch: 19
total val iterations: 276 
average val loss 1.9612
accuracy ( less than 0.1 ): 0.2252
median val loss 0.4935
total test iterations: 276 
average test loss 1.8550
accuracy ( less than 0.1 ): 0.2269
median test loss 0.5183
Consuming time:115.09 in the epoch: 19
Best test loss is 1.86
---------------*****---------------
