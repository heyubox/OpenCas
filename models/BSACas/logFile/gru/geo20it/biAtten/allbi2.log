/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:76.95664930343628
====bidirected: True,attention: GAT====
geometric gcn
total parameters 76553
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8607
batch:199 average train loss 3.5508
batch:299 average train loss 3.3348
batch:399 average train loss 3.1319
batch:499 average train loss 2.9860
batch:599 average train loss 2.8685
batch:699 average train loss 2.7635
batch:799 average train loss 2.7049
batch:899 average train loss 2.6772
batch:999 average train loss 2.6269
batch:1099 average train loss 2.5998
batch:1199 average train loss 2.5577
average train loss 2.5268
Train Consuming time:91.82 in the epoch: 0
total val iterations: 276 
average val loss 2.2582
accuracy ( less than 0.1 ): 0.1848
median val loss 0.5510
total test iterations: 276 
average test loss 2.1921
accuracy ( less than 0.1 ): 0.1748
median test loss 0.5613
Consuming time:116.49 in the epoch: 0
Best test loss is 2.19
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3286
batch:199 average train loss 2.2864
batch:299 average train loss 2.2967
batch:399 average train loss 2.2710
batch:499 average train loss 2.2365
batch:599 average train loss 2.2109
batch:699 average train loss 2.1780
batch:799 average train loss 2.1701
batch:899 average train loss 2.1809
batch:999 average train loss 2.1664
batch:1099 average train loss 2.1667
batch:1199 average train loss 2.1518
average train loss 2.1405
Train Consuming time:89.84 in the epoch: 1
total val iterations: 276 
average val loss 2.2172
accuracy ( less than 0.1 ): 0.1686
median val loss 0.5336
total test iterations: 276 
average test loss 2.1521
accuracy ( less than 0.1 ): 0.1600
median test loss 0.5406
Consuming time:114.53 in the epoch: 1
Best test loss is 2.15
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2225
batch:199 average train loss 2.1915
batch:299 average train loss 2.2145
batch:399 average train loss 2.1905
batch:499 average train loss 2.1528
batch:599 average train loss 2.1345
batch:699 average train loss 2.1050
batch:799 average train loss 2.0967
batch:899 average train loss 2.1118
batch:999 average train loss 2.0986
batch:1099 average train loss 2.1000
batch:1199 average train loss 2.0880
average train loss 2.0777
Train Consuming time:90.20 in the epoch: 2
total val iterations: 276 
average val loss 2.1488
accuracy ( less than 0.1 ): 0.1943
median val loss 0.5374
total test iterations: 276 
average test loss 2.0814
accuracy ( less than 0.1 ): 0.1861
median test loss 0.5366
Consuming time:114.92 in the epoch: 2
Best test loss is 2.08
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1814
batch:199 average train loss 2.1575
batch:299 average train loss 2.1813
batch:399 average train loss 2.1583
batch:499 average train loss 2.1154
batch:599 average train loss 2.0995
batch:699 average train loss 2.0721
batch:799 average train loss 2.0630
batch:899 average train loss 2.0799
batch:999 average train loss 2.0680
batch:1099 average train loss 2.0685
batch:1199 average train loss 2.0590
average train loss 2.0482
Train Consuming time:89.95 in the epoch: 3
total val iterations: 276 
average val loss 2.1120
accuracy ( less than 0.1 ): 0.1942
median val loss 0.5242
total test iterations: 276 
average test loss 2.0419
accuracy ( less than 0.1 ): 0.1906
median test loss 0.5218
Consuming time:115.25 in the epoch: 3
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1467
batch:199 average train loss 2.1311
batch:299 average train loss 2.1499
batch:399 average train loss 2.1320
batch:499 average train loss 2.0898
batch:599 average train loss 2.0775
batch:699 average train loss 2.0517
batch:799 average train loss 2.0436
batch:899 average train loss 2.0592
batch:999 average train loss 2.0471
batch:1099 average train loss 2.0477
batch:1199 average train loss 2.0393
average train loss 2.0297
Train Consuming time:90.51 in the epoch: 4
total val iterations: 276 
average val loss 2.0958
accuracy ( less than 0.1 ): 0.1952
median val loss 0.5090
total test iterations: 276 
average test loss 2.0191
accuracy ( less than 0.1 ): 0.1901
median test loss 0.5073
Consuming time:115.64 in the epoch: 4
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1349
batch:199 average train loss 2.1187
batch:299 average train loss 2.1327
batch:399 average train loss 2.1138
batch:499 average train loss 2.0691
batch:599 average train loss 2.0565
batch:699 average train loss 2.0314
batch:799 average train loss 2.0235
batch:899 average train loss 2.0406
batch:999 average train loss 2.0276
batch:1099 average train loss 2.0298
batch:1199 average train loss 2.0209
average train loss 2.0113
Train Consuming time:90.92 in the epoch: 5
total val iterations: 276 
average val loss 2.0939
accuracy ( less than 0.1 ): 0.1927
median val loss 0.5040
total test iterations: 276 
average test loss 2.0294
accuracy ( less than 0.1 ): 0.1892
median test loss 0.5137
Consuming time:115.97 in the epoch: 5
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1087
batch:199 average train loss 2.0913
batch:299 average train loss 2.1083
batch:399 average train loss 2.0905
batch:499 average train loss 2.0478
batch:599 average train loss 2.0354
batch:699 average train loss 2.0102
batch:799 average train loss 2.0027
batch:899 average train loss 2.0213
batch:999 average train loss 2.0093
batch:1099 average train loss 2.0107
batch:1199 average train loss 2.0024
average train loss 1.9928
Train Consuming time:90.83 in the epoch: 6
total val iterations: 276 
average val loss 2.0893
accuracy ( less than 0.1 ): 0.1925
median val loss 0.5055
total test iterations: 276 
average test loss 2.0103
accuracy ( less than 0.1 ): 0.1891
median test loss 0.5166
Consuming time:115.83 in the epoch: 6
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.0916
batch:199 average train loss 2.0780
batch:299 average train loss 2.0923
batch:399 average train loss 2.0770
batch:499 average train loss 2.0339
batch:599 average train loss 2.0227
batch:699 average train loss 1.9981
batch:799 average train loss 1.9915
batch:899 average train loss 2.0103
batch:999 average train loss 1.9975
batch:1099 average train loss 1.9997
batch:1199 average train loss 1.9916
average train loss 1.9819
Train Consuming time:91.57 in the epoch: 7
total val iterations: 276 
average val loss 2.1042
accuracy ( less than 0.1 ): 0.1855
median val loss 0.4986
total test iterations: 276 
average test loss 2.0340
accuracy ( less than 0.1 ): 0.1807
median test loss 0.5191
Consuming time:116.85 in the epoch: 7
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0751
batch:199 average train loss 2.0631
batch:299 average train loss 2.0810
batch:399 average train loss 2.0665
batch:499 average train loss 2.0247
batch:599 average train loss 2.0128
batch:699 average train loss 1.9877
batch:799 average train loss 1.9822
batch:899 average train loss 1.9998
batch:999 average train loss 1.9877
batch:1099 average train loss 1.9894
batch:1199 average train loss 1.9824
average train loss 1.9722
Train Consuming time:91.58 in the epoch: 8
total val iterations: 276 
average val loss 2.1009
accuracy ( less than 0.1 ): 0.1753
median val loss 0.4976
total test iterations: 276 
average test loss 2.0246
accuracy ( less than 0.1 ): 0.1742
median test loss 0.5124
Consuming time:116.93 in the epoch: 8
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0708
batch:199 average train loss 2.0551
batch:299 average train loss 2.0684
batch:399 average train loss 2.0571
batch:499 average train loss 2.0145
batch:599 average train loss 2.0021
batch:699 average train loss 1.9787
batch:799 average train loss 1.9728
batch:899 average train loss 1.9909
batch:999 average train loss 1.9793
batch:1099 average train loss 1.9808
batch:1199 average train loss 1.9732
average train loss 1.9626
Train Consuming time:91.58 in the epoch: 9
total val iterations: 276 
average val loss 2.0758
accuracy ( less than 0.1 ): 0.1865
median val loss 0.4931
total test iterations: 276 
average test loss 1.9978
accuracy ( less than 0.1 ): 0.1836
median test loss 0.5038
Consuming time:116.89 in the epoch: 9
Best test loss is 2.00
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0785
batch:199 average train loss 2.0385
batch:299 average train loss 2.0501
batch:399 average train loss 2.0307
batch:499 average train loss 1.9835
batch:599 average train loss 1.9728
batch:699 average train loss 1.9478
batch:799 average train loss 1.9410
batch:899 average train loss 1.9588
batch:999 average train loss 1.9425
batch:1099 average train loss 1.9433
batch:1199 average train loss 1.9301
average train loss 1.9162
Train Consuming time:90.78 in the epoch: 10
total val iterations: 276 
average val loss 2.0003
accuracy ( less than 0.1 ): 0.2173
median val loss 0.4930
total test iterations: 276 
average test loss 1.8941
accuracy ( less than 0.1 ): 0.2211
median test loss 0.5118
Consuming time:115.85 in the epoch: 10
Best test loss is 1.89
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0095
batch:199 average train loss 1.9888
batch:299 average train loss 2.0003
batch:399 average train loss 1.9860
batch:499 average train loss 1.9437
batch:599 average train loss 1.9381
batch:699 average train loss 1.9143
batch:799 average train loss 1.9084
batch:899 average train loss 1.9280
batch:999 average train loss 1.9131
batch:1099 average train loss 1.9150
batch:1199 average train loss 1.9035
average train loss 1.8910
Train Consuming time:86.58 in the epoch: 11
total val iterations: 276 
average val loss 1.9907
accuracy ( less than 0.1 ): 0.2189
median val loss 0.4919
total test iterations: 276 
average test loss 1.8834
accuracy ( less than 0.1 ): 0.2230
median test loss 0.5153
Consuming time:111.95 in the epoch: 11
Best test loss is 1.88
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 1.9937
batch:199 average train loss 1.9774
batch:299 average train loss 1.9873
batch:399 average train loss 1.9745
batch:499 average train loss 1.9333
batch:599 average train loss 1.9286
batch:699 average train loss 1.9051
batch:799 average train loss 1.8995
batch:899 average train loss 1.9193
batch:999 average train loss 1.9045
batch:1099 average train loss 1.9064
batch:1199 average train loss 1.8953
average train loss 1.8833
Train Consuming time:88.22 in the epoch: 12
total val iterations: 276 
average val loss 1.9854
accuracy ( less than 0.1 ): 0.2197
median val loss 0.4910
total test iterations: 276 
average test loss 1.8795
accuracy ( less than 0.1 ): 0.2223
median test loss 0.5211
Consuming time:113.48 in the epoch: 12
Best test loss is 1.88
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 1.9862
batch:199 average train loss 1.9713
batch:299 average train loss 1.9797
batch:399 average train loss 1.9679
batch:499 average train loss 1.9274
batch:599 average train loss 1.9231
batch:699 average train loss 1.8998
batch:799 average train loss 1.8944
batch:899 average train loss 1.9142
batch:999 average train loss 1.8994
batch:1099 average train loss 1.9013
batch:1199 average train loss 1.8904
average train loss 1.8787
Train Consuming time:91.07 in the epoch: 13
total val iterations: 276 
average val loss 1.9816
accuracy ( less than 0.1 ): 0.2207
median val loss 0.4915
total test iterations: 276 
average test loss 1.8752
accuracy ( less than 0.1 ): 0.2219
median test loss 0.5217
Consuming time:116.29 in the epoch: 13
Best test loss is 1.88
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9812
batch:199 average train loss 1.9668
batch:299 average train loss 1.9747
batch:399 average train loss 1.9636
batch:499 average train loss 1.9235
batch:599 average train loss 1.9193
batch:699 average train loss 1.8962
batch:799 average train loss 1.8909
batch:899 average train loss 1.9106
batch:999 average train loss 1.8958
batch:1099 average train loss 1.8978
batch:1199 average train loss 1.8870
average train loss 1.8755
Train Consuming time:91.37 in the epoch: 14
total val iterations: 276 
average val loss 1.9789
accuracy ( less than 0.1 ): 0.2210
median val loss 0.4911
total test iterations: 276 
average test loss 1.8727
accuracy ( less than 0.1 ): 0.2215
median test loss 0.5234
Consuming time:116.70 in the epoch: 14
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9775
batch:199 average train loss 1.9631
batch:299 average train loss 1.9708
batch:399 average train loss 1.9604
batch:499 average train loss 1.9201
batch:599 average train loss 1.9161
batch:699 average train loss 1.8930
batch:799 average train loss 1.8879
batch:899 average train loss 1.9077
batch:999 average train loss 1.8929
batch:1099 average train loss 1.8949
batch:1199 average train loss 1.8843
average train loss 1.8730
Train Consuming time:90.50 in the epoch: 15
total val iterations: 276 
average val loss 1.9775
accuracy ( less than 0.1 ): 0.2213
median val loss 0.4907
total test iterations: 276 
average test loss 1.8714
accuracy ( less than 0.1 ): 0.2223
median test loss 0.5225
Consuming time:115.09 in the epoch: 15
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9745
batch:199 average train loss 1.9607
batch:299 average train loss 1.9680
batch:399 average train loss 1.9578
batch:499 average train loss 1.9177
batch:599 average train loss 1.9137
batch:699 average train loss 1.8906
batch:799 average train loss 1.8855
batch:899 average train loss 1.9053
batch:999 average train loss 1.8905
batch:1099 average train loss 1.8926
batch:1199 average train loss 1.8821
average train loss 1.8709
Train Consuming time:89.87 in the epoch: 16
total val iterations: 276 
average val loss 1.9761
accuracy ( less than 0.1 ): 0.2211
median val loss 0.4921
total test iterations: 276 
average test loss 1.8700
accuracy ( less than 0.1 ): 0.2225
median test loss 0.5227
Consuming time:114.32 in the epoch: 16
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9720
batch:199 average train loss 1.9583
batch:299 average train loss 1.9654
batch:399 average train loss 1.9556
batch:499 average train loss 1.9155
batch:599 average train loss 1.9118
batch:699 average train loss 1.8885
batch:799 average train loss 1.8835
batch:899 average train loss 1.9034
batch:999 average train loss 1.8886
batch:1099 average train loss 1.8907
batch:1199 average train loss 1.8803
average train loss 1.8691
Train Consuming time:90.18 in the epoch: 17
total val iterations: 276 
average val loss 1.9750
accuracy ( less than 0.1 ): 0.2217
median val loss 0.4923
total test iterations: 276 
average test loss 1.8688
accuracy ( less than 0.1 ): 0.2227
median test loss 0.5208
Consuming time:115.57 in the epoch: 17
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9693
batch:199 average train loss 1.9559
batch:299 average train loss 1.9632
batch:399 average train loss 1.9537
batch:499 average train loss 1.9136
batch:599 average train loss 1.9099
batch:699 average train loss 1.8865
batch:799 average train loss 1.8816
batch:899 average train loss 1.9016
batch:999 average train loss 1.8868
batch:1099 average train loss 1.8888
batch:1199 average train loss 1.8786
average train loss 1.8675
Train Consuming time:91.45 in the epoch: 18
total val iterations: 276 
average val loss 1.9741
accuracy ( less than 0.1 ): 0.2226
median val loss 0.4938
total test iterations: 276 
average test loss 1.8675
accuracy ( less than 0.1 ): 0.2243
median test loss 0.5218
Consuming time:116.79 in the epoch: 18
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9673
batch:199 average train loss 1.9539
batch:299 average train loss 1.9610
batch:399 average train loss 1.9519
batch:499 average train loss 1.9119
batch:599 average train loss 1.9082
batch:699 average train loss 1.8847
batch:799 average train loss 1.8799
batch:899 average train loss 1.8999
batch:999 average train loss 1.8851
batch:1099 average train loss 1.8872
batch:1199 average train loss 1.8771
average train loss 1.8660
Train Consuming time:90.34 in the epoch: 19
total val iterations: 276 
average val loss 1.9730
accuracy ( less than 0.1 ): 0.2227
median val loss 0.4930
total test iterations: 276 
average test loss 1.8666
accuracy ( less than 0.1 ): 0.2242
median test loss 0.5218
Consuming time:115.62 in the epoch: 19
Best test loss is 1.87
---------------*****---------------
