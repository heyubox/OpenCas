/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:74.40641641616821
====bidirected: True,attention: GAT====
geometric gcn
total parameters 76553
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8305
batch:199 average train loss 3.5458
batch:299 average train loss 3.3289
batch:399 average train loss 3.1338
batch:499 average train loss 2.9895
batch:599 average train loss 2.8703
batch:699 average train loss 2.7647
batch:799 average train loss 2.7045
batch:899 average train loss 2.6750
batch:999 average train loss 2.6235
batch:1099 average train loss 2.5965
batch:1199 average train loss 2.5533
average train loss 2.5235
Train Consuming time:90.05 in the epoch: 0
total val iterations: 276 
average val loss 2.3323
accuracy ( less than 0.1 ): 0.1468
median val loss 0.5541
total test iterations: 276 
average test loss 2.2809
accuracy ( less than 0.1 ): 0.1422
median test loss 0.5672
Consuming time:114.41 in the epoch: 0
Best test loss is 2.28
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3224
batch:199 average train loss 2.2852
batch:299 average train loss 2.2985
batch:399 average train loss 2.2744
batch:499 average train loss 2.2370
batch:599 average train loss 2.2171
batch:699 average train loss 2.1819
batch:799 average train loss 2.1728
batch:899 average train loss 2.1839
batch:999 average train loss 2.1680
batch:1099 average train loss 2.1675
batch:1199 average train loss 2.1514
average train loss 2.1403
Train Consuming time:89.35 in the epoch: 1
total val iterations: 276 
average val loss 2.1599
accuracy ( less than 0.1 ): 0.2125
median val loss 0.5237
total test iterations: 276 
average test loss 2.0860
accuracy ( less than 0.1 ): 0.2068
median test loss 0.5336
Consuming time:113.60 in the epoch: 1
Best test loss is 2.09
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2185
batch:199 average train loss 2.1910
batch:299 average train loss 2.2072
batch:399 average train loss 2.1897
batch:499 average train loss 2.1480
batch:599 average train loss 2.1326
batch:699 average train loss 2.1044
batch:799 average train loss 2.0957
batch:899 average train loss 2.1104
batch:999 average train loss 2.0969
batch:1099 average train loss 2.0975
batch:1199 average train loss 2.0857
average train loss 2.0753
Train Consuming time:88.68 in the epoch: 2
total val iterations: 276 
average val loss 2.1395
accuracy ( less than 0.1 ): 0.2019
median val loss 0.5268
total test iterations: 276 
average test loss 2.0716
accuracy ( less than 0.1 ): 0.1983
median test loss 0.5279
Consuming time:113.00 in the epoch: 2
Best test loss is 2.07
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1774
batch:199 average train loss 2.1523
batch:299 average train loss 2.1693
batch:399 average train loss 2.1509
batch:499 average train loss 2.1068
batch:599 average train loss 2.0945
batch:699 average train loss 2.0676
batch:799 average train loss 2.0595
batch:899 average train loss 2.0767
batch:999 average train loss 2.0639
batch:1099 average train loss 2.0656
batch:1199 average train loss 2.0561
average train loss 2.0459
Train Consuming time:88.74 in the epoch: 3
total val iterations: 276 
average val loss 2.1287
accuracy ( less than 0.1 ): 0.1980
median val loss 0.5145
total test iterations: 276 
average test loss 2.0580
accuracy ( less than 0.1 ): 0.1947
median test loss 0.5182
Consuming time:113.58 in the epoch: 3
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1392
batch:199 average train loss 2.1256
batch:299 average train loss 2.1419
batch:399 average train loss 2.1244
batch:499 average train loss 2.0812
batch:599 average train loss 2.0689
batch:699 average train loss 2.0427
batch:799 average train loss 2.0336
batch:899 average train loss 2.0513
batch:999 average train loss 2.0389
batch:1099 average train loss 2.0413
batch:1199 average train loss 2.0314
average train loss 2.0215
Train Consuming time:89.49 in the epoch: 4
total val iterations: 276 
average val loss 2.1010
accuracy ( less than 0.1 ): 0.1886
median val loss 0.5040
total test iterations: 276 
average test loss 2.0246
accuracy ( less than 0.1 ): 0.1885
median test loss 0.5116
Consuming time:114.35 in the epoch: 4
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1127
batch:199 average train loss 2.1026
batch:299 average train loss 2.1188
batch:399 average train loss 2.0995
batch:499 average train loss 2.0573
batch:599 average train loss 2.0463
batch:699 average train loss 2.0209
batch:799 average train loss 2.0131
batch:899 average train loss 2.0316
batch:999 average train loss 2.0193
batch:1099 average train loss 2.0201
batch:1199 average train loss 2.0111
average train loss 2.0017
Train Consuming time:89.15 in the epoch: 5
total val iterations: 276 
average val loss 2.0733
accuracy ( less than 0.1 ): 0.1872
median val loss 0.4986
total test iterations: 276 
average test loss 1.9949
accuracy ( less than 0.1 ): 0.1898
median test loss 0.5050
Consuming time:114.05 in the epoch: 5
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.0988
batch:199 average train loss 2.0876
batch:299 average train loss 2.1004
batch:399 average train loss 2.0828
batch:499 average train loss 2.0426
batch:599 average train loss 2.0314
batch:699 average train loss 2.0065
batch:799 average train loss 1.9989
batch:899 average train loss 2.0183
batch:999 average train loss 2.0061
batch:1099 average train loss 2.0069
batch:1199 average train loss 1.9982
average train loss 1.9888
Train Consuming time:89.28 in the epoch: 6
total val iterations: 276 
average val loss 2.0945
accuracy ( less than 0.1 ): 0.1848
median val loss 0.4989
total test iterations: 276 
average test loss 2.0248
accuracy ( less than 0.1 ): 0.1864
median test loss 0.5127
Consuming time:114.23 in the epoch: 6
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.0868
batch:199 average train loss 2.0759
batch:299 average train loss 2.0944
batch:399 average train loss 2.0764
batch:499 average train loss 2.0350
batch:599 average train loss 2.0239
batch:699 average train loss 1.9990
batch:799 average train loss 1.9913
batch:899 average train loss 2.0104
batch:999 average train loss 1.9981
batch:1099 average train loss 1.9984
batch:1199 average train loss 1.9899
average train loss 1.9806
Train Consuming time:89.35 in the epoch: 7
total val iterations: 276 
average val loss 2.0718
accuracy ( less than 0.1 ): 0.1903
median val loss 0.4967
total test iterations: 276 
average test loss 1.9973
accuracy ( less than 0.1 ): 0.1866
median test loss 0.5017
Consuming time:114.40 in the epoch: 7
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0731
batch:199 average train loss 2.0667
batch:299 average train loss 2.0763
batch:399 average train loss 2.0616
batch:499 average train loss 2.0199
batch:599 average train loss 2.0102
batch:699 average train loss 1.9840
batch:799 average train loss 1.9779
batch:899 average train loss 1.9975
batch:999 average train loss 1.9847
batch:1099 average train loss 1.9853
batch:1199 average train loss 1.9765
average train loss 1.9668
Train Consuming time:89.91 in the epoch: 8
total val iterations: 276 
average val loss 2.0780
accuracy ( less than 0.1 ): 0.1840
median val loss 0.5023
total test iterations: 276 
average test loss 2.0032
accuracy ( less than 0.1 ): 0.1842
median test loss 0.5085
Consuming time:114.90 in the epoch: 8
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0593
batch:199 average train loss 2.0517
batch:299 average train loss 2.0642
batch:399 average train loss 2.0492
batch:499 average train loss 2.0099
batch:599 average train loss 2.0018
batch:699 average train loss 1.9763
batch:799 average train loss 1.9701
batch:899 average train loss 1.9887
batch:999 average train loss 1.9763
batch:1099 average train loss 1.9771
batch:1199 average train loss 1.9687
average train loss 1.9588
Train Consuming time:91.10 in the epoch: 9
total val iterations: 276 
average val loss 2.0941
accuracy ( less than 0.1 ): 0.1786
median val loss 0.5201
total test iterations: 276 
average test loss 2.0277
accuracy ( less than 0.1 ): 0.1806
median test loss 0.5390
Consuming time:116.08 in the epoch: 9
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0786
batch:199 average train loss 2.0357
batch:299 average train loss 2.0303
batch:399 average train loss 2.0115
batch:499 average train loss 1.9692
batch:599 average train loss 1.9621
batch:699 average train loss 1.9359
batch:799 average train loss 1.9284
batch:899 average train loss 1.9483
batch:999 average train loss 1.9311
batch:1099 average train loss 1.9310
batch:1199 average train loss 1.9183
average train loss 1.9043
Train Consuming time:90.87 in the epoch: 10
total val iterations: 276 
average val loss 1.9883
accuracy ( less than 0.1 ): 0.2249
median val loss 0.5076
total test iterations: 276 
average test loss 1.8826
accuracy ( less than 0.1 ): 0.2227
median test loss 0.5184
Consuming time:115.85 in the epoch: 10
Best test loss is 1.88
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0158
batch:199 average train loss 1.9880
batch:299 average train loss 1.9892
batch:399 average train loss 1.9762
batch:499 average train loss 1.9382
batch:599 average train loss 1.9349
batch:699 average train loss 1.9094
batch:799 average train loss 1.9032
batch:899 average train loss 1.9244
batch:999 average train loss 1.9085
batch:1099 average train loss 1.9092
batch:1199 average train loss 1.8983
average train loss 1.8856
Train Consuming time:90.82 in the epoch: 11
total val iterations: 276 
average val loss 1.9822
accuracy ( less than 0.1 ): 0.2234
median val loss 0.5019
total test iterations: 276 
average test loss 1.8749
accuracy ( less than 0.1 ): 0.2219
median test loss 0.5194
Consuming time:115.86 in the epoch: 11
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0030
batch:199 average train loss 1.9794
batch:299 average train loss 1.9810
batch:399 average train loss 1.9688
batch:499 average train loss 1.9309
batch:599 average train loss 1.9281
batch:699 average train loss 1.9029
batch:799 average train loss 1.8970
batch:899 average train loss 1.9181
batch:999 average train loss 1.9024
batch:1099 average train loss 1.9029
batch:1199 average train loss 1.8925
average train loss 1.8801
Train Consuming time:90.90 in the epoch: 12
total val iterations: 276 
average val loss 1.9779
accuracy ( less than 0.1 ): 0.2235
median val loss 0.5002
total test iterations: 276 
average test loss 1.8709
accuracy ( less than 0.1 ): 0.2228
median test loss 0.5196
Consuming time:115.93 in the epoch: 12
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 1.9948
batch:199 average train loss 1.9742
batch:299 average train loss 1.9752
batch:399 average train loss 1.9633
batch:499 average train loss 1.9256
batch:599 average train loss 1.9228
batch:699 average train loss 1.8977
batch:799 average train loss 1.8921
batch:899 average train loss 1.9130
batch:999 average train loss 1.8975
batch:1099 average train loss 1.8981
batch:1199 average train loss 1.8879
average train loss 1.8759
Train Consuming time:90.79 in the epoch: 13
total val iterations: 276 
average val loss 1.9753
accuracy ( less than 0.1 ): 0.2234
median val loss 0.5001
total test iterations: 276 
average test loss 1.8686
accuracy ( less than 0.1 ): 0.2240
median test loss 0.5192
Consuming time:115.90 in the epoch: 13
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9888
batch:199 average train loss 1.9702
batch:299 average train loss 1.9707
batch:399 average train loss 1.9591
batch:499 average train loss 1.9216
batch:599 average train loss 1.9191
batch:699 average train loss 1.8941
batch:799 average train loss 1.8887
batch:899 average train loss 1.9096
batch:999 average train loss 1.8941
batch:1099 average train loss 1.8947
batch:1199 average train loss 1.8847
average train loss 1.8730
Train Consuming time:90.84 in the epoch: 14
total val iterations: 276 
average val loss 1.9737
accuracy ( less than 0.1 ): 0.2235
median val loss 0.5000
total test iterations: 276 
average test loss 1.8664
accuracy ( less than 0.1 ): 0.2243
median test loss 0.5209
Consuming time:115.84 in the epoch: 14
Best test loss is 1.87
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9836
batch:199 average train loss 1.9663
batch:299 average train loss 1.9673
batch:399 average train loss 1.9561
batch:499 average train loss 1.9186
batch:599 average train loss 1.9163
batch:699 average train loss 1.8913
batch:799 average train loss 1.8860
batch:899 average train loss 1.9069
batch:999 average train loss 1.8914
batch:1099 average train loss 1.8919
batch:1199 average train loss 1.8822
average train loss 1.8706
Train Consuming time:90.87 in the epoch: 15
total val iterations: 276 
average val loss 1.9717
accuracy ( less than 0.1 ): 0.2248
median val loss 0.5004
total test iterations: 276 
average test loss 1.8642
accuracy ( less than 0.1 ): 0.2244
median test loss 0.5171
Consuming time:115.72 in the epoch: 15
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9798
batch:199 average train loss 1.9632
batch:299 average train loss 1.9646
batch:399 average train loss 1.9537
batch:499 average train loss 1.9161
batch:599 average train loss 1.9139
batch:699 average train loss 1.8891
batch:799 average train loss 1.8839
batch:899 average train loss 1.9047
batch:999 average train loss 1.8893
batch:1099 average train loss 1.8898
batch:1199 average train loss 1.8802
average train loss 1.8688
Train Consuming time:90.44 in the epoch: 16
total val iterations: 276 
average val loss 1.9697
accuracy ( less than 0.1 ): 0.2250
median val loss 0.4970
total test iterations: 276 
average test loss 1.8620
accuracy ( less than 0.1 ): 0.2250
median test loss 0.5127
Consuming time:115.31 in the epoch: 16
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9769
batch:199 average train loss 1.9605
batch:299 average train loss 1.9621
batch:399 average train loss 1.9514
batch:499 average train loss 1.9138
batch:599 average train loss 1.9116
batch:699 average train loss 1.8870
batch:799 average train loss 1.8819
batch:899 average train loss 1.9027
batch:999 average train loss 1.8873
batch:1099 average train loss 1.8879
batch:1199 average train loss 1.8784
average train loss 1.8671
Train Consuming time:90.24 in the epoch: 17
total val iterations: 276 
average val loss 1.9689
accuracy ( less than 0.1 ): 0.2247
median val loss 0.4970
total test iterations: 276 
average test loss 1.8613
accuracy ( less than 0.1 ): 0.2255
median test loss 0.5153
Consuming time:115.11 in the epoch: 17
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9748
batch:199 average train loss 1.9583
batch:299 average train loss 1.9595
batch:399 average train loss 1.9493
batch:499 average train loss 1.9118
batch:599 average train loss 1.9099
batch:699 average train loss 1.8854
batch:799 average train loss 1.8804
batch:899 average train loss 1.9010
batch:999 average train loss 1.8857
batch:1099 average train loss 1.8864
batch:1199 average train loss 1.8769
average train loss 1.8657
Train Consuming time:90.28 in the epoch: 18
total val iterations: 276 
average val loss 1.9678
accuracy ( less than 0.1 ): 0.2260
median val loss 0.4956
total test iterations: 276 
average test loss 1.8600
accuracy ( less than 0.1 ): 0.2263
median test loss 0.5138
Consuming time:115.02 in the epoch: 18
Best test loss is 1.86
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9731
batch:199 average train loss 1.9566
batch:299 average train loss 1.9579
batch:399 average train loss 1.9478
batch:499 average train loss 1.9104
batch:599 average train loss 1.9083
batch:699 average train loss 1.8839
batch:799 average train loss 1.8789
batch:899 average train loss 1.8995
batch:999 average train loss 1.8842
batch:1099 average train loss 1.8849
batch:1199 average train loss 1.8756
average train loss 1.8645
Train Consuming time:89.96 in the epoch: 19
total val iterations: 276 
average val loss 1.9664
accuracy ( less than 0.1 ): 0.2263
median val loss 0.4941
total test iterations: 276 
average test loss 1.8588
accuracy ( less than 0.1 ): 0.2275
median test loss 0.5119
Consuming time:114.26 in the epoch: 19
Best test loss is 1.86
---------------*****---------------
