/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:76.89196181297302
geometric gcn
total parameters 76553
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8453
batch:199 average train loss 3.5499
batch:299 average train loss 3.3234
batch:399 average train loss 3.1255
batch:499 average train loss 2.9855
batch:599 average train loss 2.8684
batch:699 average train loss 2.7621
batch:799 average train loss 2.7035
batch:899 average train loss 2.6751
batch:999 average train loss 2.6249
batch:1099 average train loss 2.5990
batch:1199 average train loss 2.5581
average train loss 2.5276
Train Consuming time:96.85 in the epoch: 0
total val iterations: 276 
average val loss 2.4552
accuracy ( less than 0.1 ): 0.1327
median val loss 0.6121
total test iterations: 276 
average test loss 2.3950
accuracy ( less than 0.1 ): 0.1308
median test loss 0.5977
Consuming time:122.71 in the epoch: 0
Best test loss is 2.39
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3541
batch:199 average train loss 2.3063
batch:299 average train loss 2.3146
batch:399 average train loss 2.2866
batch:499 average train loss 2.2549
batch:599 average train loss 2.2284
batch:699 average train loss 2.1930
batch:799 average train loss 2.1862
batch:899 average train loss 2.1984
batch:999 average train loss 2.1843
batch:1099 average train loss 2.1840
batch:1199 average train loss 2.1692
average train loss 2.1578
Train Consuming time:96.36 in the epoch: 1
total val iterations: 276 
average val loss 2.5125
accuracy ( less than 0.1 ): 0.1286
median val loss 0.5953
total test iterations: 276 
average test loss 2.4873
accuracy ( less than 0.1 ): 0.1280
median test loss 0.6021
Consuming time:121.95 in the epoch: 1
Best test loss is 2.39
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2502
batch:199 average train loss 2.2109
batch:299 average train loss 2.2298
batch:399 average train loss 2.2064
batch:499 average train loss 2.1709
batch:599 average train loss 2.1495
batch:699 average train loss 2.1187
batch:799 average train loss 2.1129
batch:899 average train loss 2.1278
batch:999 average train loss 2.1147
batch:1099 average train loss 2.1153
batch:1199 average train loss 2.1033
average train loss 2.0933
Train Consuming time:91.50 in the epoch: 2
total val iterations: 276 
average val loss 2.3253
accuracy ( less than 0.1 ): 0.1391
median val loss 0.5422
total test iterations: 276 
average test loss 2.2855
accuracy ( less than 0.1 ): 0.1380
median test loss 0.5453
Consuming time:116.64 in the epoch: 2
Best test loss is 2.29
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.2111
batch:199 average train loss 2.1743
batch:299 average train loss 2.1905
batch:399 average train loss 2.1692
batch:499 average train loss 2.1309
batch:599 average train loss 2.1131
batch:699 average train loss 2.0846
batch:799 average train loss 2.0772
batch:899 average train loss 2.0941
batch:999 average train loss 2.0818
batch:1099 average train loss 2.0824
batch:1199 average train loss 2.0701
average train loss 2.0602
Train Consuming time:91.88 in the epoch: 3
total val iterations: 276 
average val loss 2.1429
accuracy ( less than 0.1 ): 0.2028
median val loss 0.5238
total test iterations: 276 
average test loss 2.0692
accuracy ( less than 0.1 ): 0.1953
median test loss 0.5339
Consuming time:117.11 in the epoch: 3
Best test loss is 2.07
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1621
batch:199 average train loss 2.1428
batch:299 average train loss 2.1607
batch:399 average train loss 2.1391
batch:499 average train loss 2.1004
batch:599 average train loss 2.0854
batch:699 average train loss 2.0602
batch:799 average train loss 2.0539
batch:899 average train loss 2.0705
batch:999 average train loss 2.0589
batch:1099 average train loss 2.0591
batch:1199 average train loss 2.0473
average train loss 2.0369
Train Consuming time:91.52 in the epoch: 4
total val iterations: 276 
average val loss 2.1125
accuracy ( less than 0.1 ): 0.2014
median val loss 0.5090
total test iterations: 276 
average test loss 2.0376
accuracy ( less than 0.1 ): 0.1960
median test loss 0.5122
Consuming time:116.66 in the epoch: 4
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1408
batch:199 average train loss 2.1162
batch:299 average train loss 2.1356
batch:399 average train loss 2.1140
batch:499 average train loss 2.0751
batch:599 average train loss 2.0621
batch:699 average train loss 2.0368
batch:799 average train loss 2.0304
batch:899 average train loss 2.0474
batch:999 average train loss 2.0363
batch:1099 average train loss 2.0370
batch:1199 average train loss 2.0266
average train loss 2.0165
Train Consuming time:91.24 in the epoch: 5
total val iterations: 276 
average val loss 2.1355
accuracy ( less than 0.1 ): 0.1777
median val loss 0.5015
total test iterations: 276 
average test loss 2.0713
accuracy ( less than 0.1 ): 0.1732
median test loss 0.5081
Consuming time:115.98 in the epoch: 5
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1266
batch:199 average train loss 2.1049
batch:299 average train loss 2.1212
batch:399 average train loss 2.1008
batch:499 average train loss 2.0599
batch:599 average train loss 2.0491
batch:699 average train loss 2.0244
batch:799 average train loss 2.0179
batch:899 average train loss 2.0348
batch:999 average train loss 2.0232
batch:1099 average train loss 2.0236
batch:1199 average train loss 2.0125
average train loss 2.0024
Train Consuming time:90.53 in the epoch: 6
total val iterations: 276 
average val loss 2.1263
accuracy ( less than 0.1 ): 0.1690
median val loss 0.5011
total test iterations: 276 
average test loss 2.0582
accuracy ( less than 0.1 ): 0.1647
median test loss 0.5102
Consuming time:115.20 in the epoch: 6
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1166
batch:199 average train loss 2.0904
batch:299 average train loss 2.1083
batch:399 average train loss 2.0887
batch:499 average train loss 2.0475
batch:599 average train loss 2.0372
batch:699 average train loss 2.0109
batch:799 average train loss 2.0039
batch:899 average train loss 2.0200
batch:999 average train loss 2.0090
batch:1099 average train loss 2.0091
batch:1199 average train loss 1.9982
average train loss 1.9883
Train Consuming time:90.48 in the epoch: 7
total val iterations: 276 
average val loss 2.1283
accuracy ( less than 0.1 ): 0.1682
median val loss 0.5027
total test iterations: 276 
average test loss 2.0433
accuracy ( less than 0.1 ): 0.1624
median test loss 0.5160
Consuming time:115.26 in the epoch: 7
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0988
batch:199 average train loss 2.0781
batch:299 average train loss 2.0959
batch:399 average train loss 2.0758
batch:499 average train loss 2.0348
batch:599 average train loss 2.0251
batch:699 average train loss 2.0000
batch:799 average train loss 1.9919
batch:899 average train loss 2.0083
batch:999 average train loss 1.9971
batch:1099 average train loss 1.9979
batch:1199 average train loss 1.9870
average train loss 1.9778
Train Consuming time:91.12 in the epoch: 8
total val iterations: 276 
average val loss 2.1412
accuracy ( less than 0.1 ): 0.1622
median val loss 0.4996
total test iterations: 276 
average test loss 2.0707
accuracy ( less than 0.1 ): 0.1576
median test loss 0.5140
Consuming time:116.42 in the epoch: 8
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0910
batch:199 average train loss 2.0681
batch:299 average train loss 2.0830
batch:399 average train loss 2.0666
batch:499 average train loss 2.0236
batch:599 average train loss 2.0141
batch:699 average train loss 1.9872
batch:799 average train loss 1.9795
batch:899 average train loss 1.9968
batch:999 average train loss 1.9857
batch:1099 average train loss 1.9869
batch:1199 average train loss 1.9774
average train loss 1.9680
Train Consuming time:91.72 in the epoch: 9
total val iterations: 276 
average val loss 2.1302
accuracy ( less than 0.1 ): 0.1626
median val loss 0.4955
total test iterations: 276 
average test loss 2.0574
accuracy ( less than 0.1 ): 0.1594
median test loss 0.5078
Consuming time:117.04 in the epoch: 9
Best test loss is 2.04
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.1147
batch:199 average train loss 2.0606
batch:299 average train loss 2.0591
batch:399 average train loss 2.0401
batch:499 average train loss 1.9946
batch:599 average train loss 1.9813
batch:699 average train loss 1.9540
batch:799 average train loss 1.9439
batch:899 average train loss 1.9622
batch:999 average train loss 1.9445
batch:1099 average train loss 1.9453
batch:1199 average train loss 1.9312
average train loss 1.9176
Train Consuming time:91.41 in the epoch: 10
total val iterations: 276 
average val loss 2.0160
accuracy ( less than 0.1 ): 0.2202
median val loss 0.4915
total test iterations: 276 
average test loss 1.9104
accuracy ( less than 0.1 ): 0.2223
median test loss 0.5180
Consuming time:116.69 in the epoch: 10
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0449
batch:199 average train loss 2.0104
batch:299 average train loss 2.0127
batch:399 average train loss 1.9997
batch:499 average train loss 1.9575
batch:599 average train loss 1.9484
batch:699 average train loss 1.9214
batch:799 average train loss 1.9133
batch:899 average train loss 1.9328
batch:999 average train loss 1.9165
batch:1099 average train loss 1.9179
batch:1199 average train loss 1.9060
average train loss 1.8940
Train Consuming time:91.48 in the epoch: 11
total val iterations: 276 
average val loss 2.0094
accuracy ( less than 0.1 ): 0.2208
median val loss 0.4940
total test iterations: 276 
average test loss 1.9047
accuracy ( less than 0.1 ): 0.2223
median test loss 0.5159
Consuming time:116.76 in the epoch: 11
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0266
batch:199 average train loss 1.9985
batch:299 average train loss 1.9999
batch:399 average train loss 1.9879
batch:499 average train loss 1.9466
batch:599 average train loss 1.9389
batch:699 average train loss 1.9120
batch:799 average train loss 1.9043
batch:899 average train loss 1.9237
batch:999 average train loss 1.9074
batch:1099 average train loss 1.9089
batch:1199 average train loss 1.8977
average train loss 1.8863
Train Consuming time:90.24 in the epoch: 12
total val iterations: 276 
average val loss 2.0075
accuracy ( less than 0.1 ): 0.2203
median val loss 0.5002
total test iterations: 276 
average test loss 1.9048
accuracy ( less than 0.1 ): 0.2242
median test loss 0.5183
Consuming time:115.59 in the epoch: 12
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0176
batch:199 average train loss 1.9929
batch:299 average train loss 1.9939
batch:399 average train loss 1.9822
batch:499 average train loss 1.9417
batch:599 average train loss 1.9342
batch:699 average train loss 1.9070
batch:799 average train loss 1.8992
batch:899 average train loss 1.9186
batch:999 average train loss 1.9024
batch:1099 average train loss 1.9037
batch:1199 average train loss 1.8929
average train loss 1.8818
Train Consuming time:90.75 in the epoch: 13
total val iterations: 276 
average val loss 2.0056
accuracy ( less than 0.1 ): 0.2214
median val loss 0.4990
total test iterations: 276 
average test loss 1.9034
accuracy ( less than 0.1 ): 0.2233
median test loss 0.5194
Consuming time:115.89 in the epoch: 13
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 2.0118
batch:199 average train loss 1.9879
batch:299 average train loss 1.9889
batch:399 average train loss 1.9776
batch:499 average train loss 1.9376
batch:599 average train loss 1.9306
batch:699 average train loss 1.9033
batch:799 average train loss 1.8957
batch:899 average train loss 1.9151
batch:999 average train loss 1.8989
batch:1099 average train loss 1.9004
batch:1199 average train loss 1.8897
average train loss 1.8788
Train Consuming time:90.91 in the epoch: 14
total val iterations: 276 
average val loss 2.0041
accuracy ( less than 0.1 ): 0.2207
median val loss 0.5020
total test iterations: 276 
average test loss 1.9018
accuracy ( less than 0.1 ): 0.2234
median test loss 0.5245
Consuming time:115.99 in the epoch: 14
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 2.0080
batch:199 average train loss 1.9847
batch:299 average train loss 1.9856
batch:399 average train loss 1.9747
batch:499 average train loss 1.9352
batch:599 average train loss 1.9284
batch:699 average train loss 1.9013
batch:799 average train loss 1.8938
batch:899 average train loss 1.9130
batch:999 average train loss 1.8968
batch:1099 average train loss 1.8983
batch:1199 average train loss 1.8877
average train loss 1.8770
Train Consuming time:91.08 in the epoch: 15
total val iterations: 276 
average val loss 2.0026
accuracy ( less than 0.1 ): 0.2215
median val loss 0.5032
total test iterations: 276 
average test loss 1.9009
accuracy ( less than 0.1 ): 0.2233
median test loss 0.5226
Consuming time:116.35 in the epoch: 15
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 2.0042
batch:199 average train loss 1.9821
batch:299 average train loss 1.9828
batch:399 average train loss 1.9724
batch:499 average train loss 1.9328
batch:599 average train loss 1.9262
batch:699 average train loss 1.8991
batch:799 average train loss 1.8918
batch:899 average train loss 1.9108
batch:999 average train loss 1.8947
batch:1099 average train loss 1.8963
batch:1199 average train loss 1.8859
average train loss 1.8752
Train Consuming time:91.28 in the epoch: 16
total val iterations: 276 
average val loss 2.0008
accuracy ( less than 0.1 ): 0.2216
median val loss 0.5018
total test iterations: 276 
average test loss 1.8985
accuracy ( less than 0.1 ): 0.2224
median test loss 0.5225
Consuming time:116.53 in the epoch: 16
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 2.0002
batch:199 average train loss 1.9790
batch:299 average train loss 1.9802
batch:399 average train loss 1.9704
batch:499 average train loss 1.9309
batch:599 average train loss 1.9242
batch:699 average train loss 1.8971
batch:799 average train loss 1.8900
batch:899 average train loss 1.9090
batch:999 average train loss 1.8931
batch:1099 average train loss 1.8948
batch:1199 average train loss 1.8844
average train loss 1.8738
Train Consuming time:91.27 in the epoch: 17
total val iterations: 276 
average val loss 2.0001
accuracy ( less than 0.1 ): 0.2235
median val loss 0.5015
total test iterations: 276 
average test loss 1.8990
accuracy ( less than 0.1 ): 0.2232
median test loss 0.5219
Consuming time:116.53 in the epoch: 17
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9980
batch:199 average train loss 1.9774
batch:299 average train loss 1.9785
batch:399 average train loss 1.9688
batch:499 average train loss 1.9293
batch:599 average train loss 1.9226
batch:699 average train loss 1.8956
batch:799 average train loss 1.8884
batch:899 average train loss 1.9074
batch:999 average train loss 1.8917
batch:1099 average train loss 1.8934
batch:1199 average train loss 1.8831
average train loss 1.8725
Train Consuming time:89.89 in the epoch: 18
total val iterations: 276 
average val loss 1.9994
accuracy ( less than 0.1 ): 0.2226
median val loss 0.4988
total test iterations: 276 
average test loss 1.8984
accuracy ( less than 0.1 ): 0.2223
median test loss 0.5221
Consuming time:115.17 in the epoch: 18
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9963
batch:199 average train loss 1.9754
batch:299 average train loss 1.9765
batch:399 average train loss 1.9671
batch:499 average train loss 1.9278
batch:599 average train loss 1.9212
batch:699 average train loss 1.8941
batch:799 average train loss 1.8870
batch:899 average train loss 1.9060
batch:999 average train loss 1.8903
batch:1099 average train loss 1.8921
batch:1199 average train loss 1.8819
average train loss 1.8714
Train Consuming time:91.60 in the epoch: 19
total val iterations: 276 
average val loss 1.9985
accuracy ( less than 0.1 ): 0.2225
median val loss 0.4982
total test iterations: 276 
average test loss 1.8986
accuracy ( less than 0.1 ): 0.2232
median test loss 0.5214
Consuming time:117.29 in the epoch: 19
Best test loss is 1.90
---------------*****---------------
