/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:79.02226495742798
geometric gcn
total parameters 43017
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8735
batch:199 average train loss 3.5888
batch:299 average train loss 3.3795
batch:399 average train loss 3.1926
batch:499 average train loss 3.0424
batch:599 average train loss 2.9473
batch:699 average train loss 2.8398
batch:799 average train loss 2.7753
batch:899 average train loss 2.7439
batch:999 average train loss 2.6886
batch:1099 average train loss 2.6520
batch:1199 average train loss 2.6065
average train loss 2.5695
Train Consuming time:53.34 in the epoch: 0
total val iterations: 276 
average val loss 2.5036
accuracy ( less than 0.1 ): 0.1244
median val loss 0.6507
total test iterations: 276 
average test loss 2.5111
accuracy ( less than 0.1 ): 0.1212
median test loss 0.6609
Consuming time:73.27 in the epoch: 0
Best test loss is 2.51
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3111
batch:199 average train loss 2.2609
batch:299 average train loss 2.2696
batch:399 average train loss 2.2417
batch:499 average train loss 2.2003
batch:599 average train loss 2.1888
batch:699 average train loss 2.1502
batch:799 average train loss 2.1412
batch:899 average train loss 2.1583
batch:999 average train loss 2.1428
batch:1099 average train loss 2.1437
batch:1199 average train loss 2.1319
average train loss 2.1178
Train Consuming time:52.87 in the epoch: 1
total val iterations: 276 
average val loss 2.2018
accuracy ( less than 0.1 ): 0.1778
median val loss 0.5472
total test iterations: 276 
average test loss 2.1677
accuracy ( less than 0.1 ): 0.1745
median test loss 0.5818
Consuming time:72.75 in the epoch: 1
Best test loss is 2.17
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2096
batch:199 average train loss 2.1716
batch:299 average train loss 2.1816
batch:399 average train loss 2.1609
batch:499 average train loss 2.1220
batch:599 average train loss 2.1152
batch:699 average train loss 2.0821
batch:799 average train loss 2.0750
batch:899 average train loss 2.0900
batch:999 average train loss 2.0726
batch:1099 average train loss 2.0772
batch:1199 average train loss 2.0678
average train loss 2.0567
Train Consuming time:53.20 in the epoch: 2
total val iterations: 276 
average val loss 2.1119
accuracy ( less than 0.1 ): 0.1827
median val loss 0.5223
total test iterations: 276 
average test loss 2.0672
accuracy ( less than 0.1 ): 0.1845
median test loss 0.5488
Consuming time:72.80 in the epoch: 2
Best test loss is 2.07
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1380
batch:199 average train loss 2.1010
batch:299 average train loss 2.1236
batch:399 average train loss 2.1089
batch:499 average train loss 2.0749
batch:599 average train loss 2.0718
batch:699 average train loss 2.0422
batch:799 average train loss 2.0346
batch:899 average train loss 2.0524
batch:999 average train loss 2.0382
batch:1099 average train loss 2.0403
batch:1199 average train loss 2.0323
average train loss 2.0232
Train Consuming time:54.24 in the epoch: 3
total val iterations: 276 
average val loss 2.0867
accuracy ( less than 0.1 ): 0.2019
median val loss 0.5336
total test iterations: 276 
average test loss 2.0608
accuracy ( less than 0.1 ): 0.2008
median test loss 0.5545
Consuming time:74.22 in the epoch: 3
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1291
batch:199 average train loss 2.0926
batch:299 average train loss 2.1072
batch:399 average train loss 2.0975
batch:499 average train loss 2.0611
batch:599 average train loss 2.0558
batch:699 average train loss 2.0263
batch:799 average train loss 2.0192
batch:899 average train loss 2.0384
batch:999 average train loss 2.0246
batch:1099 average train loss 2.0261
batch:1199 average train loss 2.0187
average train loss 2.0079
Train Consuming time:55.00 in the epoch: 4
total val iterations: 276 
average val loss 2.0638
accuracy ( less than 0.1 ): 0.2016
median val loss 0.5062
total test iterations: 276 
average test loss 2.0165
accuracy ( less than 0.1 ): 0.2007
median test loss 0.5360
Consuming time:75.42 in the epoch: 4
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1226
batch:199 average train loss 2.0767
batch:299 average train loss 2.0892
batch:399 average train loss 2.0769
batch:499 average train loss 2.0445
batch:599 average train loss 2.0394
batch:699 average train loss 2.0098
batch:799 average train loss 2.0039
batch:899 average train loss 2.0224
batch:999 average train loss 2.0079
batch:1099 average train loss 2.0094
batch:1199 average train loss 2.0024
average train loss 1.9931
Train Consuming time:55.23 in the epoch: 5
total val iterations: 276 
average val loss 2.0926
accuracy ( less than 0.1 ): 0.1844
median val loss 0.5026
total test iterations: 276 
average test loss 2.0457
accuracy ( less than 0.1 ): 0.1839
median test loss 0.5449
Consuming time:75.90 in the epoch: 5
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.0657
batch:199 average train loss 2.0456
batch:299 average train loss 2.0667
batch:399 average train loss 2.0626
batch:499 average train loss 2.0250
batch:599 average train loss 2.0225
batch:699 average train loss 1.9937
batch:799 average train loss 1.9858
batch:899 average train loss 2.0041
batch:999 average train loss 1.9906
batch:1099 average train loss 1.9926
batch:1199 average train loss 1.9854
average train loss 1.9763
Train Consuming time:55.56 in the epoch: 6
total val iterations: 276 
average val loss 2.0642
accuracy ( less than 0.1 ): 0.1918
median val loss 0.5056
total test iterations: 276 
average test loss 2.0141
accuracy ( less than 0.1 ): 0.1872
median test loss 0.5224
Consuming time:76.16 in the epoch: 6
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.0847
batch:199 average train loss 2.0542
batch:299 average train loss 2.0626
batch:399 average train loss 2.0540
batch:499 average train loss 2.0196
batch:599 average train loss 2.0135
batch:699 average train loss 1.9871
batch:799 average train loss 1.9789
batch:899 average train loss 1.9963
batch:999 average train loss 1.9812
batch:1099 average train loss 1.9823
batch:1199 average train loss 1.9746
average train loss 1.9667
Train Consuming time:55.69 in the epoch: 7
total val iterations: 276 
average val loss 2.0700
accuracy ( less than 0.1 ): 0.1727
median val loss 0.5180
total test iterations: 276 
average test loss 2.0204
accuracy ( less than 0.1 ): 0.1719
median test loss 0.5375
Consuming time:76.61 in the epoch: 7
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0727
batch:199 average train loss 2.0419
batch:299 average train loss 2.0576
batch:399 average train loss 2.0450
batch:499 average train loss 2.0086
batch:599 average train loss 2.0086
batch:699 average train loss 1.9791
batch:799 average train loss 1.9696
batch:899 average train loss 1.9868
batch:999 average train loss 1.9719
batch:1099 average train loss 1.9731
batch:1199 average train loss 1.9654
average train loss 1.9590
Train Consuming time:56.14 in the epoch: 8
total val iterations: 276 
average val loss 2.0606
accuracy ( less than 0.1 ): 0.1790
median val loss 0.5126
total test iterations: 276 
average test loss 2.0075
accuracy ( less than 0.1 ): 0.1778
median test loss 0.5353
Consuming time:76.87 in the epoch: 8
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0636
batch:199 average train loss 2.0245
batch:299 average train loss 2.0483
batch:399 average train loss 2.0431
batch:499 average train loss 2.0037
batch:599 average train loss 1.9987
batch:699 average train loss 1.9697
batch:799 average train loss 1.9624
batch:899 average train loss 1.9810
batch:999 average train loss 1.9651
batch:1099 average train loss 1.9669
batch:1199 average train loss 1.9599
average train loss 1.9514
Train Consuming time:55.51 in the epoch: 9
total val iterations: 276 
average val loss 2.0727
accuracy ( less than 0.1 ): 0.1723
median val loss 0.5210
total test iterations: 276 
average test loss 2.0263
accuracy ( less than 0.1 ): 0.1682
median test loss 0.5310
Consuming time:75.98 in the epoch: 9
Best test loss is 2.01
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0472
batch:199 average train loss 2.0082
batch:299 average train loss 2.0213
batch:399 average train loss 2.0049
batch:499 average train loss 1.9601
batch:599 average train loss 1.9529
batch:699 average train loss 1.9246
batch:799 average train loss 1.9139
batch:899 average train loss 1.9288
batch:999 average train loss 1.9100
batch:1099 average train loss 1.9089
batch:1199 average train loss 1.8991
average train loss 1.8848
Train Consuming time:54.46 in the epoch: 10
total val iterations: 276 
average val loss 1.9908
accuracy ( less than 0.1 ): 0.2349
median val loss 0.5253
total test iterations: 276 
average test loss 1.9312
accuracy ( less than 0.1 ): 0.2391
median test loss 0.5412
Consuming time:74.95 in the epoch: 10
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0005
batch:199 average train loss 1.9758
batch:299 average train loss 1.9942
batch:399 average train loss 1.9794
batch:499 average train loss 1.9373
batch:599 average train loss 1.9336
batch:699 average train loss 1.9066
batch:799 average train loss 1.8965
batch:899 average train loss 1.9122
batch:999 average train loss 1.8951
batch:1099 average train loss 1.8951
batch:1199 average train loss 1.8864
average train loss 1.8732
Train Consuming time:53.34 in the epoch: 11
total val iterations: 276 
average val loss 1.9860
accuracy ( less than 0.1 ): 0.2348
median val loss 0.5268
total test iterations: 276 
average test loss 1.9267
accuracy ( less than 0.1 ): 0.2366
median test loss 0.5372
Consuming time:73.92 in the epoch: 11
Best test loss is 1.93
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 1.9950
batch:199 average train loss 1.9683
batch:299 average train loss 1.9859
batch:399 average train loss 1.9720
batch:499 average train loss 1.9307
batch:599 average train loss 1.9271
batch:699 average train loss 1.8989
batch:799 average train loss 1.8887
batch:899 average train loss 1.9046
batch:999 average train loss 1.8877
batch:1099 average train loss 1.8881
batch:1199 average train loss 1.8799
average train loss 1.8677
Train Consuming time:50.98 in the epoch: 12
total val iterations: 276 
average val loss 1.9824
accuracy ( less than 0.1 ): 0.2361
median val loss 0.5278
total test iterations: 276 
average test loss 1.9228
accuracy ( less than 0.1 ): 0.2389
median test loss 0.5406
Consuming time:71.04 in the epoch: 12
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 1.9909
batch:199 average train loss 1.9645
batch:299 average train loss 1.9823
batch:399 average train loss 1.9685
batch:499 average train loss 1.9272
batch:599 average train loss 1.9259
batch:699 average train loss 1.8986
batch:799 average train loss 1.8882
batch:899 average train loss 1.9037
batch:999 average train loss 1.8864
batch:1099 average train loss 1.8867
batch:1199 average train loss 1.8784
average train loss 1.8665
Train Consuming time:53.70 in the epoch: 13
total val iterations: 276 
average val loss 1.9799
accuracy ( less than 0.1 ): 0.2352
median val loss 0.5249
total test iterations: 276 
average test loss 1.9197
accuracy ( less than 0.1 ): 0.2355
median test loss 0.5401
Consuming time:73.91 in the epoch: 13
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9879
batch:199 average train loss 1.9604
batch:299 average train loss 1.9779
batch:399 average train loss 1.9652
batch:499 average train loss 1.9241
batch:599 average train loss 1.9213
batch:699 average train loss 1.8933
batch:799 average train loss 1.8828
batch:899 average train loss 1.8989
batch:999 average train loss 1.8824
batch:1099 average train loss 1.8831
batch:1199 average train loss 1.8748
average train loss 1.8631
Train Consuming time:54.05 in the epoch: 14
total val iterations: 276 
average val loss 1.9790
accuracy ( less than 0.1 ): 0.2351
median val loss 0.5246
total test iterations: 276 
average test loss 1.9201
accuracy ( less than 0.1 ): 0.2349
median test loss 0.5378
Consuming time:74.16 in the epoch: 14
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9862
batch:199 average train loss 1.9589
batch:299 average train loss 1.9752
batch:399 average train loss 1.9632
batch:499 average train loss 1.9222
batch:599 average train loss 1.9198
batch:699 average train loss 1.8932
batch:799 average train loss 1.8826
batch:899 average train loss 1.8984
batch:999 average train loss 1.8813
batch:1099 average train loss 1.8817
batch:1199 average train loss 1.8738
average train loss 1.8620
Train Consuming time:54.19 in the epoch: 15
total val iterations: 276 
average val loss 1.9771
accuracy ( less than 0.1 ): 0.2381
median val loss 0.5245
total test iterations: 276 
average test loss 1.9177
accuracy ( less than 0.1 ): 0.2375
median test loss 0.5406
Consuming time:74.29 in the epoch: 15
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9825
batch:199 average train loss 1.9556
batch:299 average train loss 1.9729
batch:399 average train loss 1.9615
batch:499 average train loss 1.9206
batch:599 average train loss 1.9183
batch:699 average train loss 1.8904
batch:799 average train loss 1.8797
batch:899 average train loss 1.8957
batch:999 average train loss 1.8787
batch:1099 average train loss 1.8793
batch:1199 average train loss 1.8712
average train loss 1.8598
Train Consuming time:54.49 in the epoch: 16
total val iterations: 276 
average val loss 1.9776
accuracy ( less than 0.1 ): 0.2361
median val loss 0.5267
total test iterations: 276 
average test loss 1.9177
accuracy ( less than 0.1 ): 0.2352
median test loss 0.5357
Consuming time:75.03 in the epoch: 16
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9821
batch:199 average train loss 1.9553
batch:299 average train loss 1.9717
batch:399 average train loss 1.9607
batch:499 average train loss 1.9195
batch:599 average train loss 1.9173
batch:699 average train loss 1.8894
batch:799 average train loss 1.8788
batch:899 average train loss 1.8949
batch:999 average train loss 1.8779
batch:1099 average train loss 1.8785
batch:1199 average train loss 1.8708
average train loss 1.8595
Train Consuming time:54.72 in the epoch: 17
total val iterations: 276 
average val loss 1.9764
accuracy ( less than 0.1 ): 0.2383
median val loss 0.5274
total test iterations: 276 
average test loss 1.9175
accuracy ( less than 0.1 ): 0.2370
median test loss 0.5370
Consuming time:75.12 in the epoch: 17
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9802
batch:199 average train loss 1.9533
batch:299 average train loss 1.9700
batch:399 average train loss 1.9583
batch:499 average train loss 1.9175
batch:599 average train loss 1.9156
batch:699 average train loss 1.8882
batch:799 average train loss 1.8780
batch:899 average train loss 1.8944
batch:999 average train loss 1.8777
batch:1099 average train loss 1.8777
batch:1199 average train loss 1.8700
average train loss 1.8586
Train Consuming time:51.99 in the epoch: 18
total val iterations: 276 
average val loss 1.9758
accuracy ( less than 0.1 ): 0.2373
median val loss 0.5301
total test iterations: 276 
average test loss 1.9152
accuracy ( less than 0.1 ): 0.2356
median test loss 0.5381
Consuming time:72.05 in the epoch: 18
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9786
batch:199 average train loss 1.9525
batch:299 average train loss 1.9689
batch:399 average train loss 1.9575
batch:499 average train loss 1.9165
batch:599 average train loss 1.9146
batch:699 average train loss 1.8869
batch:799 average train loss 1.8769
batch:899 average train loss 1.8930
batch:999 average train loss 1.8760
batch:1099 average train loss 1.8762
batch:1199 average train loss 1.8685
average train loss 1.8573
Train Consuming time:52.93 in the epoch: 19
total val iterations: 276 
average val loss 1.9747
accuracy ( less than 0.1 ): 0.2377
median val loss 0.5287
total test iterations: 276 
average test loss 1.9151
accuracy ( less than 0.1 ): 0.2367
median test loss 0.5377
Consuming time:72.21 in the epoch: 19
Best test loss is 1.92
---------------*****---------------
