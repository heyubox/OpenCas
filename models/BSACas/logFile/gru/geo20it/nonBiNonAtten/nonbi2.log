/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:75.41643476486206
geometric gcn
total parameters 43017
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8595
batch:199 average train loss 3.5757
batch:299 average train loss 3.3754
batch:399 average train loss 3.1930
batch:499 average train loss 3.0535
batch:599 average train loss 2.9550
batch:699 average train loss 2.8431
batch:799 average train loss 2.7757
batch:899 average train loss 2.7474
batch:999 average train loss 2.6906
batch:1099 average train loss 2.6529
batch:1199 average train loss 2.6099
average train loss 2.5748
Train Consuming time:48.49 in the epoch: 0
total val iterations: 276 
average val loss 2.1893
accuracy ( less than 0.1 ): 0.1880
median val loss 0.5891
total test iterations: 276 
average test loss 2.1230
accuracy ( less than 0.1 ): 0.1831
median test loss 0.5834
Consuming time:66.30 in the epoch: 0
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3470
batch:199 average train loss 2.2956
batch:299 average train loss 2.3043
batch:399 average train loss 2.2773
batch:499 average train loss 2.2232
batch:599 average train loss 2.2098
batch:699 average train loss 2.1683
batch:799 average train loss 2.1545
batch:899 average train loss 2.1708
batch:999 average train loss 2.1578
batch:1099 average train loss 2.1546
batch:1199 average train loss 2.1425
average train loss 2.1294
Train Consuming time:48.60 in the epoch: 1
total val iterations: 276 
average val loss 2.3467
accuracy ( less than 0.1 ): 0.1495
median val loss 0.6122
total test iterations: 276 
average test loss 2.3302
accuracy ( less than 0.1 ): 0.1469
median test loss 0.6374
Consuming time:66.47 in the epoch: 1
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.2382
batch:199 average train loss 2.2071
batch:299 average train loss 2.2102
batch:399 average train loss 2.1845
batch:499 average train loss 2.1391
batch:599 average train loss 2.1328
batch:699 average train loss 2.1001
batch:799 average train loss 2.0906
batch:899 average train loss 2.1062
batch:999 average train loss 2.0906
batch:1099 average train loss 2.0900
batch:1199 average train loss 2.0827
average train loss 2.0711
Train Consuming time:48.63 in the epoch: 2
total val iterations: 276 
average val loss 2.1864
accuracy ( less than 0.1 ): 0.1618
median val loss 0.5668
total test iterations: 276 
average test loss 2.1318
accuracy ( less than 0.1 ): 0.1601
median test loss 0.5671
Consuming time:66.46 in the epoch: 2
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1677
batch:199 average train loss 2.1355
batch:299 average train loss 2.1504
batch:399 average train loss 2.1380
batch:499 average train loss 2.0940
batch:599 average train loss 2.0881
batch:699 average train loss 2.0562
batch:799 average train loss 2.0492
batch:899 average train loss 2.0677
batch:999 average train loss 2.0540
batch:1099 average train loss 2.0538
batch:1199 average train loss 2.0443
average train loss 2.0342
Train Consuming time:49.09 in the epoch: 3
total val iterations: 276 
average val loss 2.1769
accuracy ( less than 0.1 ): 0.1561
median val loss 0.5484
total test iterations: 276 
average test loss 2.1546
accuracy ( less than 0.1 ): 0.1507
median test loss 0.5560
Consuming time:67.00 in the epoch: 3
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1497
batch:199 average train loss 2.1067
batch:299 average train loss 2.1185
batch:399 average train loss 2.1063
batch:499 average train loss 2.0667
batch:599 average train loss 2.0579
batch:699 average train loss 2.0289
batch:799 average train loss 2.0222
batch:899 average train loss 2.0404
batch:999 average train loss 2.0266
batch:1099 average train loss 2.0287
batch:1199 average train loss 2.0200
average train loss 2.0100
Train Consuming time:48.76 in the epoch: 4
total val iterations: 276 
average val loss 2.1577
accuracy ( less than 0.1 ): 0.1793
median val loss 0.5405
total test iterations: 276 
average test loss 2.1313
accuracy ( less than 0.1 ): 0.1741
median test loss 0.5482
Consuming time:66.66 in the epoch: 4
Best test loss is 2.12
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1228
batch:199 average train loss 2.0862
batch:299 average train loss 2.0942
batch:399 average train loss 2.0810
batch:499 average train loss 2.0389
batch:599 average train loss 2.0346
batch:699 average train loss 2.0073
batch:799 average train loss 2.0021
batch:899 average train loss 2.0209
batch:999 average train loss 2.0074
batch:1099 average train loss 2.0100
batch:1199 average train loss 2.0032
average train loss 1.9950
Train Consuming time:48.81 in the epoch: 5
total val iterations: 276 
average val loss 2.1375
accuracy ( less than 0.1 ): 0.1761
median val loss 0.5216
total test iterations: 276 
average test loss 2.0979
accuracy ( less than 0.1 ): 0.1750
median test loss 0.5411
Consuming time:66.71 in the epoch: 5
Best test loss is 2.10
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.1189
batch:199 average train loss 2.0740
batch:299 average train loss 2.0795
batch:399 average train loss 2.0677
batch:499 average train loss 2.0268
batch:599 average train loss 2.0218
batch:699 average train loss 1.9933
batch:799 average train loss 1.9868
batch:899 average train loss 2.0063
batch:999 average train loss 1.9933
batch:1099 average train loss 1.9960
batch:1199 average train loss 1.9886
average train loss 1.9790
Train Consuming time:49.24 in the epoch: 6
total val iterations: 276 
average val loss 2.2969
accuracy ( less than 0.1 ): 0.1447
median val loss 0.5911
total test iterations: 276 
average test loss 2.2781
accuracy ( less than 0.1 ): 0.1461
median test loss 0.6281
Consuming time:67.52 in the epoch: 6
Best test loss is 2.10
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1000
batch:199 average train loss 2.0592
batch:299 average train loss 2.0640
batch:399 average train loss 2.0577
batch:499 average train loss 2.0156
batch:599 average train loss 2.0128
batch:699 average train loss 1.9835
batch:799 average train loss 1.9794
batch:899 average train loss 1.9973
batch:999 average train loss 1.9835
batch:1099 average train loss 1.9860
batch:1199 average train loss 1.9780
average train loss 1.9685
Train Consuming time:50.12 in the epoch: 7
total val iterations: 276 
average val loss 2.1651
accuracy ( less than 0.1 ): 0.1635
median val loss 0.5487
total test iterations: 276 
average test loss 2.1469
accuracy ( less than 0.1 ): 0.1636
median test loss 0.5690
Consuming time:69.30 in the epoch: 7
Best test loss is 2.10
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0829
batch:199 average train loss 2.0462
batch:299 average train loss 2.0608
batch:399 average train loss 2.0502
batch:499 average train loss 2.0075
batch:599 average train loss 2.0047
batch:699 average train loss 1.9759
batch:799 average train loss 1.9687
batch:899 average train loss 1.9875
batch:999 average train loss 1.9736
batch:1099 average train loss 1.9754
batch:1199 average train loss 1.9681
average train loss 1.9577
Train Consuming time:53.16 in the epoch: 8
total val iterations: 276 
average val loss 2.1614
accuracy ( less than 0.1 ): 0.1567
median val loss 0.5607
total test iterations: 276 
average test loss 2.1166
accuracy ( less than 0.1 ): 0.1495
median test loss 0.5563
Consuming time:72.77 in the epoch: 8
Best test loss is 2.10
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0946
batch:199 average train loss 2.0535
batch:299 average train loss 2.0544
batch:399 average train loss 2.0422
batch:499 average train loss 1.9977
batch:599 average train loss 1.9919
batch:699 average train loss 1.9633
batch:799 average train loss 1.9588
batch:899 average train loss 1.9768
batch:999 average train loss 1.9632
batch:1099 average train loss 1.9640
batch:1199 average train loss 1.9563
average train loss 1.9474
Train Consuming time:53.25 in the epoch: 9
total val iterations: 276 
average val loss 2.2492
accuracy ( less than 0.1 ): 0.1386
median val loss 0.5701
total test iterations: 276 
average test loss 2.2341
accuracy ( less than 0.1 ): 0.1373
median test loss 0.5865
Consuming time:72.91 in the epoch: 9
Best test loss is 2.10
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.1085
batch:199 average train loss 2.0419
batch:299 average train loss 2.0383
batch:399 average train loss 2.0245
batch:499 average train loss 1.9788
batch:599 average train loss 1.9685
batch:699 average train loss 1.9365
batch:799 average train loss 1.9260
batch:899 average train loss 1.9421
batch:999 average train loss 1.9239
batch:1099 average train loss 1.9216
batch:1199 average train loss 1.9100
average train loss 1.8945
Train Consuming time:53.71 in the epoch: 10
total val iterations: 276 
average val loss 2.0183
accuracy ( less than 0.1 ): 0.2352
median val loss 0.5331
total test iterations: 276 
average test loss 1.9198
accuracy ( less than 0.1 ): 0.2356
median test loss 0.5453
Consuming time:73.68 in the epoch: 10
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0267
batch:199 average train loss 1.9919
batch:299 average train loss 1.9976
batch:399 average train loss 1.9899
batch:499 average train loss 1.9473
batch:599 average train loss 1.9414
batch:699 average train loss 1.9127
batch:799 average train loss 1.9040
batch:899 average train loss 1.9214
batch:999 average train loss 1.9043
batch:1099 average train loss 1.9030
batch:1199 average train loss 1.8926
average train loss 1.8786
Train Consuming time:54.21 in the epoch: 11
total val iterations: 276 
average val loss 2.0137
accuracy ( less than 0.1 ): 0.2340
median val loss 0.5382
total test iterations: 276 
average test loss 1.9166
accuracy ( less than 0.1 ): 0.2369
median test loss 0.5439
Consuming time:74.38 in the epoch: 11
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 2.0200
batch:199 average train loss 1.9845
batch:299 average train loss 1.9908
batch:399 average train loss 1.9834
batch:499 average train loss 1.9420
batch:599 average train loss 1.9355
batch:699 average train loss 1.9061
batch:799 average train loss 1.8974
batch:899 average train loss 1.9152
batch:999 average train loss 1.8984
batch:1099 average train loss 1.8976
batch:1199 average train loss 1.8874
average train loss 1.8737
Train Consuming time:54.95 in the epoch: 12
total val iterations: 276 
average val loss 2.0090
accuracy ( less than 0.1 ): 0.2336
median val loss 0.5352
total test iterations: 276 
average test loss 1.9108
accuracy ( less than 0.1 ): 0.2361
median test loss 0.5422
Consuming time:75.64 in the epoch: 12
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 2.0129
batch:199 average train loss 1.9792
batch:299 average train loss 1.9859
batch:399 average train loss 1.9793
batch:499 average train loss 1.9377
batch:599 average train loss 1.9317
batch:699 average train loss 1.9018
batch:799 average train loss 1.8935
batch:899 average train loss 1.9111
batch:999 average train loss 1.8943
batch:1099 average train loss 1.8937
batch:1199 average train loss 1.8837
average train loss 1.8703
Train Consuming time:54.87 in the epoch: 13
total val iterations: 276 
average val loss 2.0067
accuracy ( less than 0.1 ): 0.2342
median val loss 0.5331
total test iterations: 276 
average test loss 1.9097
accuracy ( less than 0.1 ): 0.2358
median test loss 0.5453
Consuming time:75.33 in the epoch: 13
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 2.0115
batch:199 average train loss 1.9759
batch:299 average train loss 1.9834
batch:399 average train loss 1.9764
batch:499 average train loss 1.9350
batch:599 average train loss 1.9292
batch:699 average train loss 1.8988
batch:799 average train loss 1.8907
batch:899 average train loss 1.9082
batch:999 average train loss 1.8916
batch:1099 average train loss 1.8911
batch:1199 average train loss 1.8812
average train loss 1.8681
Train Consuming time:53.51 in the epoch: 14
total val iterations: 276 
average val loss 2.0062
accuracy ( less than 0.1 ): 0.2348
median val loss 0.5342
total test iterations: 276 
average test loss 1.9106
accuracy ( less than 0.1 ): 0.2355
median test loss 0.5447
Consuming time:74.01 in the epoch: 14
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 2.0087
batch:199 average train loss 1.9744
batch:299 average train loss 1.9817
batch:399 average train loss 1.9757
batch:499 average train loss 1.9344
batch:599 average train loss 1.9288
batch:699 average train loss 1.8985
batch:799 average train loss 1.8902
batch:899 average train loss 1.9081
batch:999 average train loss 1.8913
batch:1099 average train loss 1.8907
batch:1199 average train loss 1.8807
average train loss 1.8676
Train Consuming time:54.48 in the epoch: 15
total val iterations: 276 
average val loss 2.0042
accuracy ( less than 0.1 ): 0.2349
median val loss 0.5339
total test iterations: 276 
average test loss 1.9077
accuracy ( less than 0.1 ): 0.2365
median test loss 0.5447
Consuming time:75.06 in the epoch: 15
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 2.0093
batch:199 average train loss 1.9726
batch:299 average train loss 1.9797
batch:399 average train loss 1.9738
batch:499 average train loss 1.9313
batch:599 average train loss 1.9259
batch:699 average train loss 1.8964
batch:799 average train loss 1.8880
batch:899 average train loss 1.9057
batch:999 average train loss 1.8893
batch:1099 average train loss 1.8891
batch:1199 average train loss 1.8792
average train loss 1.8661
Train Consuming time:52.32 in the epoch: 16
total val iterations: 276 
average val loss 2.0039
accuracy ( less than 0.1 ): 0.2350
median val loss 0.5317
total test iterations: 276 
average test loss 1.9102
accuracy ( less than 0.1 ): 0.2341
median test loss 0.5409
Consuming time:72.79 in the epoch: 16
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 2.0069
batch:199 average train loss 1.9715
batch:299 average train loss 1.9779
batch:399 average train loss 1.9723
batch:499 average train loss 1.9294
batch:599 average train loss 1.9239
batch:699 average train loss 1.8946
batch:799 average train loss 1.8862
batch:899 average train loss 1.9039
batch:999 average train loss 1.8875
batch:1099 average train loss 1.8874
batch:1199 average train loss 1.8775
average train loss 1.8645
Train Consuming time:52.63 in the epoch: 17
total val iterations: 276 
average val loss 2.0037
accuracy ( less than 0.1 ): 0.2349
median val loss 0.5347
total test iterations: 276 
average test loss 1.9116
accuracy ( less than 0.1 ): 0.2357
median test loss 0.5462
Consuming time:73.25 in the epoch: 17
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 2.0051
batch:199 average train loss 1.9698
batch:299 average train loss 1.9763
batch:399 average train loss 1.9706
batch:499 average train loss 1.9277
batch:599 average train loss 1.9225
batch:699 average train loss 1.8928
batch:799 average train loss 1.8843
batch:899 average train loss 1.9022
batch:999 average train loss 1.8859
batch:1099 average train loss 1.8858
batch:1199 average train loss 1.8760
average train loss 1.8632
Train Consuming time:55.07 in the epoch: 18
total val iterations: 276 
average val loss 2.0020
accuracy ( less than 0.1 ): 0.2362
median val loss 0.5315
total test iterations: 276 
average test loss 1.9087
accuracy ( less than 0.1 ): 0.2355
median test loss 0.5442
Consuming time:75.85 in the epoch: 18
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 2.0032
batch:199 average train loss 1.9689
batch:299 average train loss 1.9752
batch:399 average train loss 1.9698
batch:499 average train loss 1.9270
batch:599 average train loss 1.9216
batch:699 average train loss 1.8921
batch:799 average train loss 1.8836
batch:899 average train loss 1.9011
batch:999 average train loss 1.8849
batch:1099 average train loss 1.8847
batch:1199 average train loss 1.8750
average train loss 1.8622
Train Consuming time:55.14 in the epoch: 19
total val iterations: 276 
average val loss 2.0005
accuracy ( less than 0.1 ): 0.2348
median val loss 0.5297
total test iterations: 276 
average test loss 1.9073
accuracy ( less than 0.1 ): 0.2351
median test loss 0.5408
Consuming time:75.86 in the epoch: 19
Best test loss is 1.91
---------------*****---------------
