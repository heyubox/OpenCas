/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:79.1007297039032
geometric gcn
total parameters 43017
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8556
batch:199 average train loss 3.5746
batch:299 average train loss 3.3723
batch:399 average train loss 3.1741
batch:499 average train loss 3.0317
batch:599 average train loss 2.9347
batch:699 average train loss 2.8302
batch:799 average train loss 2.7664
batch:899 average train loss 2.7381
batch:999 average train loss 2.6780
batch:1099 average train loss 2.6448
batch:1199 average train loss 2.6004
average train loss 2.5640
Train Consuming time:52.74 in the epoch: 0
total val iterations: 276 
average val loss 2.3424
accuracy ( less than 0.1 ): 0.1507
median val loss 0.6178
total test iterations: 276 
average test loss 2.2834
accuracy ( less than 0.1 ): 0.1480
median test loss 0.6403
Consuming time:72.28 in the epoch: 0
Best test loss is 2.28
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.2791
batch:199 average train loss 2.2586
batch:299 average train loss 2.2628
batch:399 average train loss 2.2421
batch:499 average train loss 2.2049
batch:599 average train loss 2.1944
batch:699 average train loss 2.1600
batch:799 average train loss 2.1527
batch:899 average train loss 2.1678
batch:999 average train loss 2.1520
batch:1099 average train loss 2.1543
batch:1199 average train loss 2.1389
average train loss 2.1264
Train Consuming time:52.33 in the epoch: 1
total val iterations: 276 
average val loss 2.1548
accuracy ( less than 0.1 ): 0.1683
median val loss 0.5429
total test iterations: 276 
average test loss 2.0618
accuracy ( less than 0.1 ): 0.1643
median test loss 0.5311
Consuming time:71.56 in the epoch: 1
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.1844
batch:199 average train loss 2.1693
batch:299 average train loss 2.1878
batch:399 average train loss 2.1691
batch:499 average train loss 2.1281
batch:599 average train loss 2.1174
batch:699 average train loss 2.0861
batch:799 average train loss 2.0802
batch:899 average train loss 2.0961
batch:999 average train loss 2.0807
batch:1099 average train loss 2.0836
batch:1199 average train loss 2.0718
average train loss 2.0611
Train Consuming time:52.66 in the epoch: 2
total val iterations: 276 
average val loss 2.1626
accuracy ( less than 0.1 ): 0.1708
median val loss 0.5658
total test iterations: 276 
average test loss 2.1141
accuracy ( less than 0.1 ): 0.1653
median test loss 0.5819
Consuming time:72.27 in the epoch: 2
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1222
batch:199 average train loss 2.1028
batch:299 average train loss 2.1219
batch:399 average train loss 2.1122
batch:499 average train loss 2.0761
batch:599 average train loss 2.0695
batch:699 average train loss 2.0418
batch:799 average train loss 2.0386
batch:899 average train loss 2.0565
batch:999 average train loss 2.0422
batch:1099 average train loss 2.0448
batch:1199 average train loss 2.0342
average train loss 2.0232
Train Consuming time:53.48 in the epoch: 3
total val iterations: 276 
average val loss 2.2507
accuracy ( less than 0.1 ): 0.1501
median val loss 0.5779
total test iterations: 276 
average test loss 2.2147
accuracy ( less than 0.1 ): 0.1486
median test loss 0.5963
Consuming time:73.22 in the epoch: 3
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1310
batch:199 average train loss 2.1077
batch:299 average train loss 2.1181
batch:399 average train loss 2.1042
batch:499 average train loss 2.0654
batch:599 average train loss 2.0600
batch:699 average train loss 2.0308
batch:799 average train loss 2.0244
batch:899 average train loss 2.0402
batch:999 average train loss 2.0261
batch:1099 average train loss 2.0295
batch:1199 average train loss 2.0200
average train loss 2.0103
Train Consuming time:54.47 in the epoch: 4
total val iterations: 276 
average val loss 2.1387
accuracy ( less than 0.1 ): 0.1606
median val loss 0.5512
total test iterations: 276 
average test loss 2.0566
accuracy ( less than 0.1 ): 0.1512
median test loss 0.5426
Consuming time:74.63 in the epoch: 4
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1004
batch:199 average train loss 2.0764
batch:299 average train loss 2.0998
batch:399 average train loss 2.0871
batch:499 average train loss 2.0504
batch:599 average train loss 2.0474
batch:699 average train loss 2.0184
batch:799 average train loss 2.0120
batch:899 average train loss 2.0281
batch:999 average train loss 2.0129
batch:1099 average train loss 2.0153
batch:1199 average train loss 2.0059
average train loss 1.9956
Train Consuming time:54.07 in the epoch: 5
total val iterations: 276 
average val loss 2.1735
accuracy ( less than 0.1 ): 0.1492
median val loss 0.5566
total test iterations: 276 
average test loss 2.1126
accuracy ( less than 0.1 ): 0.1439
median test loss 0.5546
Consuming time:74.31 in the epoch: 5
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.0985
batch:199 average train loss 2.0636
batch:299 average train loss 2.0782
batch:399 average train loss 2.0782
batch:499 average train loss 2.0389
batch:599 average train loss 2.0313
batch:699 average train loss 2.0010
batch:799 average train loss 1.9938
batch:899 average train loss 2.0080
batch:999 average train loss 1.9945
batch:1099 average train loss 1.9951
batch:1199 average train loss 1.9866
average train loss 1.9762
Train Consuming time:54.27 in the epoch: 6
total val iterations: 276 
average val loss 2.1295
accuracy ( less than 0.1 ): 0.1725
median val loss 0.5447
total test iterations: 276 
average test loss 2.0568
accuracy ( less than 0.1 ): 0.1674
median test loss 0.5554
Consuming time:74.29 in the epoch: 6
Best test loss is 2.06
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.0885
batch:199 average train loss 2.0526
batch:299 average train loss 2.0684
batch:399 average train loss 2.0627
batch:499 average train loss 2.0224
batch:599 average train loss 2.0122
batch:699 average train loss 1.9848
batch:799 average train loss 1.9765
batch:899 average train loss 1.9928
batch:999 average train loss 1.9797
batch:1099 average train loss 1.9816
batch:1199 average train loss 1.9727
average train loss 1.9628
Train Consuming time:53.50 in the epoch: 7
total val iterations: 276 
average val loss 2.0936
accuracy ( less than 0.1 ): 0.1807
median val loss 0.5419
total test iterations: 276 
average test loss 2.0287
accuracy ( less than 0.1 ): 0.1785
median test loss 0.5452
Consuming time:73.30 in the epoch: 7
Best test loss is 2.03
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0749
batch:199 average train loss 2.0376
batch:299 average train loss 2.0488
batch:399 average train loss 2.0476
batch:499 average train loss 2.0058
batch:599 average train loss 1.9983
batch:699 average train loss 1.9729
batch:799 average train loss 1.9668
batch:899 average train loss 1.9842
batch:999 average train loss 1.9716
batch:1099 average train loss 1.9726
batch:1199 average train loss 1.9641
average train loss 1.9542
Train Consuming time:53.07 in the epoch: 8
total val iterations: 276 
average val loss 2.0813
accuracy ( less than 0.1 ): 0.1778
median val loss 0.5175
total test iterations: 276 
average test loss 2.0239
accuracy ( less than 0.1 ): 0.1760
median test loss 0.5245
Consuming time:72.94 in the epoch: 8
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0720
batch:199 average train loss 2.0314
batch:299 average train loss 2.0521
batch:399 average train loss 2.0478
batch:499 average train loss 2.0080
batch:599 average train loss 1.9997
batch:699 average train loss 1.9712
batch:799 average train loss 1.9666
batch:899 average train loss 1.9839
batch:999 average train loss 1.9706
batch:1099 average train loss 1.9712
batch:1199 average train loss 1.9618
average train loss 1.9514
Train Consuming time:53.16 in the epoch: 9
total val iterations: 276 
average val loss 2.0987
accuracy ( less than 0.1 ): 0.1719
median val loss 0.5446
total test iterations: 276 
average test loss 2.0402
accuracy ( less than 0.1 ): 0.1706
median test loss 0.5427
Consuming time:73.10 in the epoch: 9
Best test loss is 2.02
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0482
batch:199 average train loss 2.0084
batch:299 average train loss 2.0280
batch:399 average train loss 2.0204
batch:499 average train loss 1.9745
batch:599 average train loss 1.9669
batch:699 average train loss 1.9374
batch:799 average train loss 1.9297
batch:899 average train loss 1.9438
batch:999 average train loss 1.9255
batch:1099 average train loss 1.9248
batch:1199 average train loss 1.9109
average train loss 1.8976
Train Consuming time:53.42 in the epoch: 10
total val iterations: 276 
average val loss 1.9953
accuracy ( less than 0.1 ): 0.2263
median val loss 0.5132
total test iterations: 276 
average test loss 1.9233
accuracy ( less than 0.1 ): 0.2285
median test loss 0.5283
Consuming time:73.55 in the epoch: 10
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 2.0055
batch:199 average train loss 1.9772
batch:299 average train loss 1.9962
batch:399 average train loss 1.9895
batch:499 average train loss 1.9486
batch:599 average train loss 1.9443
batch:699 average train loss 1.9172
batch:799 average train loss 1.9115
batch:899 average train loss 1.9265
batch:999 average train loss 1.9092
batch:1099 average train loss 1.9094
batch:1199 average train loss 1.8963
average train loss 1.8839
Train Consuming time:52.98 in the epoch: 11
total val iterations: 276 
average val loss 1.9916
accuracy ( less than 0.1 ): 0.2239
median val loss 0.5204
total test iterations: 276 
average test loss 1.9228
accuracy ( less than 0.1 ): 0.2253
median test loss 0.5339
Consuming time:72.99 in the epoch: 11
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 1.9940
batch:199 average train loss 1.9699
batch:299 average train loss 1.9878
batch:399 average train loss 1.9806
batch:499 average train loss 1.9409
batch:599 average train loss 1.9354
batch:699 average train loss 1.9091
batch:799 average train loss 1.9032
batch:899 average train loss 1.9188
batch:999 average train loss 1.9015
batch:1099 average train loss 1.9020
batch:1199 average train loss 1.8895
average train loss 1.8776
Train Consuming time:52.27 in the epoch: 12
total val iterations: 276 
average val loss 1.9879
accuracy ( less than 0.1 ): 0.2252
median val loss 0.5142
total test iterations: 276 
average test loss 1.9137
accuracy ( less than 0.1 ): 0.2266
median test loss 0.5367
Consuming time:71.65 in the epoch: 12
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 1.9883
batch:199 average train loss 1.9664
batch:299 average train loss 1.9841
batch:399 average train loss 1.9765
batch:499 average train loss 1.9367
batch:599 average train loss 1.9325
batch:699 average train loss 1.9060
batch:799 average train loss 1.9002
batch:899 average train loss 1.9157
batch:999 average train loss 1.8984
batch:1099 average train loss 1.8995
batch:1199 average train loss 1.8868
average train loss 1.8750
Train Consuming time:51.58 in the epoch: 13
total val iterations: 276 
average val loss 1.9891
accuracy ( less than 0.1 ): 0.2261
median val loss 0.5234
total test iterations: 276 
average test loss 1.9187
accuracy ( less than 0.1 ): 0.2260
median test loss 0.5401
Consuming time:70.91 in the epoch: 13
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9848
batch:199 average train loss 1.9634
batch:299 average train loss 1.9806
batch:399 average train loss 1.9722
batch:499 average train loss 1.9327
batch:599 average train loss 1.9287
batch:699 average train loss 1.9018
batch:799 average train loss 1.8960
batch:899 average train loss 1.9118
batch:999 average train loss 1.8946
batch:1099 average train loss 1.8965
batch:1199 average train loss 1.8840
average train loss 1.8723
Train Consuming time:51.54 in the epoch: 14
total val iterations: 276 
average val loss 1.9890
accuracy ( less than 0.1 ): 0.2257
median val loss 0.5202
total test iterations: 276 
average test loss 1.9158
accuracy ( less than 0.1 ): 0.2248
median test loss 0.5413
Consuming time:70.90 in the epoch: 14
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9825
batch:199 average train loss 1.9617
batch:299 average train loss 1.9784
batch:399 average train loss 1.9701
batch:499 average train loss 1.9307
batch:599 average train loss 1.9271
batch:699 average train loss 1.9004
batch:799 average train loss 1.8947
batch:899 average train loss 1.9103
batch:999 average train loss 1.8928
batch:1099 average train loss 1.8943
batch:1199 average train loss 1.8818
average train loss 1.8704
Train Consuming time:51.51 in the epoch: 15
total val iterations: 276 
average val loss 1.9894
accuracy ( less than 0.1 ): 0.2242
median val loss 0.5204
total test iterations: 276 
average test loss 1.9173
accuracy ( less than 0.1 ): 0.2235
median test loss 0.5346
Consuming time:70.80 in the epoch: 15
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9806
batch:199 average train loss 1.9586
batch:299 average train loss 1.9753
batch:399 average train loss 1.9680
batch:499 average train loss 1.9284
batch:599 average train loss 1.9249
batch:699 average train loss 1.8978
batch:799 average train loss 1.8920
batch:899 average train loss 1.9076
batch:999 average train loss 1.8903
batch:1099 average train loss 1.8919
batch:1199 average train loss 1.8795
average train loss 1.8684
Train Consuming time:51.42 in the epoch: 16
total val iterations: 276 
average val loss 1.9884
accuracy ( less than 0.1 ): 0.2250
median val loss 0.5177
total test iterations: 276 
average test loss 1.9170
accuracy ( less than 0.1 ): 0.2238
median test loss 0.5369
Consuming time:70.74 in the epoch: 16
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9794
batch:199 average train loss 1.9572
batch:299 average train loss 1.9736
batch:399 average train loss 1.9654
batch:499 average train loss 1.9271
batch:599 average train loss 1.9234
batch:699 average train loss 1.8961
batch:799 average train loss 1.8902
batch:899 average train loss 1.9058
batch:999 average train loss 1.8887
batch:1099 average train loss 1.8914
batch:1199 average train loss 1.8789
average train loss 1.8679
Train Consuming time:51.66 in the epoch: 17
total val iterations: 276 
average val loss 1.9860
accuracy ( less than 0.1 ): 0.2268
median val loss 0.5184
total test iterations: 276 
average test loss 1.9154
accuracy ( less than 0.1 ): 0.2263
median test loss 0.5409
Consuming time:71.31 in the epoch: 17
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9768
batch:199 average train loss 1.9557
batch:299 average train loss 1.9727
batch:399 average train loss 1.9646
batch:499 average train loss 1.9251
batch:599 average train loss 1.9213
batch:699 average train loss 1.8937
batch:799 average train loss 1.8879
batch:899 average train loss 1.9037
batch:999 average train loss 1.8866
batch:1099 average train loss 1.8883
batch:1199 average train loss 1.8760
average train loss 1.8649
Train Consuming time:52.08 in the epoch: 18
total val iterations: 276 
average val loss 1.9859
accuracy ( less than 0.1 ): 0.2273
median val loss 0.5225
total test iterations: 276 
average test loss 1.9168
accuracy ( less than 0.1 ): 0.2267
median test loss 0.5402
Consuming time:71.59 in the epoch: 18
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9760
batch:199 average train loss 1.9535
batch:299 average train loss 1.9709
batch:399 average train loss 1.9630
batch:499 average train loss 1.9237
batch:599 average train loss 1.9196
batch:699 average train loss 1.8921
batch:799 average train loss 1.8864
batch:899 average train loss 1.9021
batch:999 average train loss 1.8850
batch:1099 average train loss 1.8868
batch:1199 average train loss 1.8746
average train loss 1.8635
Train Consuming time:51.86 in the epoch: 19
total val iterations: 276 
average val loss 1.9858
accuracy ( less than 0.1 ): 0.2265
median val loss 0.5185
total test iterations: 276 
average test loss 1.9152
accuracy ( less than 0.1 ): 0.2249
median test loss 0.5409
Consuming time:71.17 in the epoch: 19
Best test loss is 1.91
---------------*****---------------
