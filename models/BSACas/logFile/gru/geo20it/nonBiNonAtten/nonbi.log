/home/ta/anaconda3/lib/python3.6/site-packages/numba/decorators.py:149: RuntimeWarning: Caching is not available when the 'parallel' target is in use. Caching is now being disabled to allow execution to continue.
  warnings.warn(msg, RuntimeWarning)
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/ta/.local/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
===================configuration===================
learning rate :0.001 
num_mlp_layers : 1
num_layers : 2
gnn input_features : 100
gnn output_features : 64
input of rnn/transformer : 64
hidden_size (out put of rnn/tranformer) : 64
observation hour [7,19]
observation interval : 180
observation threshold : 3600
prediction time : 86400
cascade length [5,600]
model save at : ../model_save/cas2vec/
===================configuration===================
len(Y_train), len(Y_valid), len(Y_test): 41134 8815 8815
preparing time:75.24910855293274
geometric gcn
total parameters 43017
---------------*****---------------
Starting training the epoch: 0 
total batch: 1285.4375 
batch:99 average train loss 3.8609
batch:199 average train loss 3.5643
batch:299 average train loss 3.3736
batch:399 average train loss 3.1923
batch:499 average train loss 3.0463
batch:599 average train loss 2.9456
batch:699 average train loss 2.8381
batch:799 average train loss 2.7696
batch:899 average train loss 2.7385
batch:999 average train loss 2.6838
batch:1099 average train loss 2.6500
batch:1199 average train loss 2.6084
average train loss 2.5715
Train Consuming time:75.77 in the epoch: 0
total val iterations: 276 
average val loss 2.1774
accuracy ( less than 0.1 ): 0.2168
median val loss 0.5620
total test iterations: 276 
average test loss 2.0510
accuracy ( less than 0.1 ): 0.2208
median test loss 0.5606
Consuming time:103.94 in the epoch: 0
Best test loss is 2.05
---------------*****---------------
---------------*****---------------
Starting training the epoch: 1 
total batch: 1285.4375 
batch:99 average train loss 2.3185
batch:199 average train loss 2.2814
batch:299 average train loss 2.2945
batch:399 average train loss 2.2735
batch:499 average train loss 2.2278
batch:599 average train loss 2.2094
batch:699 average train loss 2.1726
batch:799 average train loss 2.1626
batch:899 average train loss 2.1775
batch:999 average train loss 2.1609
batch:1099 average train loss 2.1628
batch:1199 average train loss 2.1489
average train loss 2.1346
Train Consuming time:76.06 in the epoch: 1
total val iterations: 276 
average val loss 2.2124
accuracy ( less than 0.1 ): 0.1630
median val loss 0.5379
total test iterations: 276 
average test loss 2.1659
accuracy ( less than 0.1 ): 0.1591
median test loss 0.5627
Consuming time:104.35 in the epoch: 1
Best test loss is 2.05
---------------*****---------------
---------------*****---------------
Starting training the epoch: 2 
total batch: 1285.4375 
batch:99 average train loss 2.1932
batch:199 average train loss 2.1609
batch:299 average train loss 2.1712
batch:399 average train loss 2.1732
batch:499 average train loss 2.1344
batch:599 average train loss 2.1299
batch:699 average train loss 2.0981
batch:799 average train loss 2.0926
batch:899 average train loss 2.1117
batch:999 average train loss 2.0973
batch:1099 average train loss 2.1007
batch:1199 average train loss 2.0879
average train loss 2.0764
Train Consuming time:75.46 in the epoch: 2
total val iterations: 276 
average val loss 2.0692
accuracy ( less than 0.1 ): 0.2239
median val loss 0.5458
total test iterations: 276 
average test loss 1.9899
accuracy ( less than 0.1 ): 0.2230
median test loss 0.5797
Consuming time:103.69 in the epoch: 2
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 3 
total batch: 1285.4375 
batch:99 average train loss 2.1773
batch:199 average train loss 2.1438
batch:299 average train loss 2.1523
batch:399 average train loss 2.1370
batch:499 average train loss 2.0984
batch:599 average train loss 2.0922
batch:699 average train loss 2.0625
batch:799 average train loss 2.0594
batch:899 average train loss 2.0766
batch:999 average train loss 2.0613
batch:1099 average train loss 2.0668
batch:1199 average train loss 2.0581
average train loss 2.0477
Train Consuming time:75.76 in the epoch: 3
total val iterations: 276 
average val loss 2.1080
accuracy ( less than 0.1 ): 0.2061
median val loss 0.5404
total test iterations: 276 
average test loss 2.0556
accuracy ( less than 0.1 ): 0.2060
median test loss 0.5559
Consuming time:104.06 in the epoch: 3
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 4 
total batch: 1285.4375 
batch:99 average train loss 2.1453
batch:199 average train loss 2.1042
batch:299 average train loss 2.1134
batch:399 average train loss 2.1069
batch:499 average train loss 2.0712
batch:599 average train loss 2.0628
batch:699 average train loss 2.0344
batch:799 average train loss 2.0307
batch:899 average train loss 2.0476
batch:999 average train loss 2.0327
batch:1099 average train loss 2.0373
batch:1199 average train loss 2.0271
average train loss 2.0174
Train Consuming time:75.13 in the epoch: 4
total val iterations: 276 
average val loss 2.2525
accuracy ( less than 0.1 ): 0.1858
median val loss 0.5781
total test iterations: 276 
average test loss 2.2498
accuracy ( less than 0.1 ): 0.1875
median test loss 0.6092
Consuming time:103.57 in the epoch: 4
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 5 
total batch: 1285.4375 
batch:99 average train loss 2.1123
batch:199 average train loss 2.0728
batch:299 average train loss 2.0765
batch:399 average train loss 2.0755
batch:499 average train loss 2.0399
batch:599 average train loss 2.0371
batch:699 average train loss 2.0150
batch:799 average train loss 2.0089
batch:899 average train loss 2.0265
batch:999 average train loss 2.0121
batch:1099 average train loss 2.0168
batch:1199 average train loss 2.0086
average train loss 1.9982
Train Consuming time:75.73 in the epoch: 5
total val iterations: 276 
average val loss 2.1527
accuracy ( less than 0.1 ): 0.1686
median val loss 0.5439
total test iterations: 276 
average test loss 2.1165
accuracy ( less than 0.1 ): 0.1697
median test loss 0.5649
Consuming time:104.03 in the epoch: 5
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 6 
total batch: 1285.4375 
batch:99 average train loss 2.0886
batch:199 average train loss 2.0659
batch:299 average train loss 2.0778
batch:399 average train loss 2.0715
batch:499 average train loss 2.0351
batch:599 average train loss 2.0287
batch:699 average train loss 2.0010
batch:799 average train loss 1.9955
batch:899 average train loss 2.0129
batch:999 average train loss 1.9996
batch:1099 average train loss 2.0023
batch:1199 average train loss 1.9927
average train loss 1.9835
Train Consuming time:75.44 in the epoch: 6
total val iterations: 276 
average val loss 2.1339
accuracy ( less than 0.1 ): 0.1888
median val loss 0.5336
total test iterations: 276 
average test loss 2.0847
accuracy ( less than 0.1 ): 0.1916
median test loss 0.5578
Consuming time:103.80 in the epoch: 6
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 7 
total batch: 1285.4375 
batch:99 average train loss 2.1113
batch:199 average train loss 2.0677
batch:299 average train loss 2.0748
batch:399 average train loss 2.0671
batch:499 average train loss 2.0295
batch:599 average train loss 2.0223
batch:699 average train loss 1.9941
batch:799 average train loss 1.9877
batch:899 average train loss 2.0036
batch:999 average train loss 1.9889
batch:1099 average train loss 1.9916
batch:1199 average train loss 1.9808
average train loss 1.9714
Train Consuming time:76.00 in the epoch: 7
total val iterations: 276 
average val loss 2.2422
accuracy ( less than 0.1 ): 0.1642
median val loss 0.5762
total test iterations: 276 
average test loss 2.2272
accuracy ( less than 0.1 ): 0.1652
median test loss 0.5912
Consuming time:104.56 in the epoch: 7
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 8 
total batch: 1285.4375 
batch:99 average train loss 2.0620
batch:199 average train loss 2.0346
batch:299 average train loss 2.0418
batch:399 average train loss 2.0401
batch:499 average train loss 2.0073
batch:599 average train loss 2.0029
batch:699 average train loss 1.9745
batch:799 average train loss 1.9691
batch:899 average train loss 1.9860
batch:999 average train loss 1.9726
batch:1099 average train loss 1.9742
batch:1199 average train loss 1.9649
average train loss 1.9564
Train Consuming time:75.47 in the epoch: 8
total val iterations: 276 
average val loss 2.2676
accuracy ( less than 0.1 ): 0.1631
median val loss 0.5900
total test iterations: 276 
average test loss 2.2734
accuracy ( less than 0.1 ): 0.1618
median test loss 0.6175
Consuming time:103.30 in the epoch: 8
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 9 
total batch: 1285.4375 
batch:99 average train loss 2.0687
batch:199 average train loss 2.0400
batch:299 average train loss 2.0449
batch:399 average train loss 2.0411
batch:499 average train loss 2.0032
batch:599 average train loss 1.9953
batch:699 average train loss 1.9698
batch:799 average train loss 1.9598
batch:899 average train loss 1.9759
batch:999 average train loss 1.9622
batch:1099 average train loss 1.9643
batch:1199 average train loss 1.9554
average train loss 1.9467
Train Consuming time:74.14 in the epoch: 9
total val iterations: 276 
average val loss 2.0560
accuracy ( less than 0.1 ): 0.1949
median val loss 0.5055
total test iterations: 276 
average test loss 2.0315
accuracy ( less than 0.1 ): 0.1973
median test loss 0.5484
Consuming time:102.36 in the epoch: 9
Best test loss is 1.99
---------------*****---------------
---------------*****---------------
Starting training the epoch: 10 
total batch: 1285.4375 
batch:99 average train loss 2.0412
batch:199 average train loss 2.0195
batch:299 average train loss 2.0310
batch:399 average train loss 2.0169
batch:499 average train loss 1.9748
batch:599 average train loss 1.9652
batch:699 average train loss 1.9367
batch:799 average train loss 1.9259
batch:899 average train loss 1.9428
batch:999 average train loss 1.9241
batch:1099 average train loss 1.9233
batch:1199 average train loss 1.9089
average train loss 1.8947
Train Consuming time:79.18 in the epoch: 10
total val iterations: 276 
average val loss 1.9910
accuracy ( less than 0.1 ): 0.2366
median val loss 0.5216
total test iterations: 276 
average test loss 1.9207
accuracy ( less than 0.1 ): 0.2319
median test loss 0.5358
Consuming time:108.48 in the epoch: 10
Best test loss is 1.92
---------------*****---------------
---------------*****---------------
Starting training the epoch: 11 
total batch: 1285.4375 
batch:99 average train loss 1.9969
batch:199 average train loss 1.9793
batch:299 average train loss 1.9951
batch:399 average train loss 1.9859
batch:499 average train loss 1.9473
batch:599 average train loss 1.9396
batch:699 average train loss 1.9127
batch:799 average train loss 1.9025
batch:899 average train loss 1.9204
batch:999 average train loss 1.9031
batch:1099 average train loss 1.9038
batch:1199 average train loss 1.8909
average train loss 1.8780
Train Consuming time:79.08 in the epoch: 11
total val iterations: 276 
average val loss 1.9831
accuracy ( less than 0.1 ): 0.2368
median val loss 0.5219
total test iterations: 276 
average test loss 1.9109
accuracy ( less than 0.1 ): 0.2335
median test loss 0.5316
Consuming time:108.58 in the epoch: 11
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 12 
total batch: 1285.4375 
batch:99 average train loss 1.9812
batch:199 average train loss 1.9645
batch:299 average train loss 1.9811
batch:399 average train loss 1.9742
batch:499 average train loss 1.9371
batch:599 average train loss 1.9298
batch:699 average train loss 1.9027
batch:799 average train loss 1.8924
batch:899 average train loss 1.9102
batch:999 average train loss 1.8934
batch:1099 average train loss 1.8946
batch:1199 average train loss 1.8825
average train loss 1.8702
Train Consuming time:79.13 in the epoch: 12
total val iterations: 276 
average val loss 1.9805
accuracy ( less than 0.1 ): 0.2377
median val loss 0.5199
total test iterations: 276 
average test loss 1.9088
accuracy ( less than 0.1 ): 0.2344
median test loss 0.5314
Consuming time:108.37 in the epoch: 12
Best test loss is 1.91
---------------*****---------------
---------------*****---------------
Starting training the epoch: 13 
total batch: 1285.4375 
batch:99 average train loss 1.9803
batch:199 average train loss 1.9605
batch:299 average train loss 1.9776
batch:399 average train loss 1.9710
batch:499 average train loss 1.9337
batch:599 average train loss 1.9263
batch:699 average train loss 1.8992
batch:799 average train loss 1.8887
batch:899 average train loss 1.9062
batch:999 average train loss 1.8891
batch:1099 average train loss 1.8905
batch:1199 average train loss 1.8788
average train loss 1.8669
Train Consuming time:78.99 in the epoch: 13
total val iterations: 276 
average val loss 1.9766
accuracy ( less than 0.1 ): 0.2362
median val loss 0.5165
total test iterations: 276 
average test loss 1.9031
accuracy ( less than 0.1 ): 0.2330
median test loss 0.5312
Consuming time:108.52 in the epoch: 13
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 14 
total batch: 1285.4375 
batch:99 average train loss 1.9762
batch:199 average train loss 1.9566
batch:299 average train loss 1.9733
batch:399 average train loss 1.9678
batch:499 average train loss 1.9303
batch:599 average train loss 1.9223
batch:699 average train loss 1.8956
batch:799 average train loss 1.8852
batch:899 average train loss 1.9026
batch:999 average train loss 1.8857
batch:1099 average train loss 1.8872
batch:1199 average train loss 1.8755
average train loss 1.8639
Train Consuming time:79.26 in the epoch: 14
total val iterations: 276 
average val loss 1.9756
accuracy ( less than 0.1 ): 0.2368
median val loss 0.5210
total test iterations: 276 
average test loss 1.9024
accuracy ( less than 0.1 ): 0.2351
median test loss 0.5326
Consuming time:108.89 in the epoch: 14
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 15 
total batch: 1285.4375 
batch:99 average train loss 1.9737
batch:199 average train loss 1.9534
batch:299 average train loss 1.9707
batch:399 average train loss 1.9651
batch:499 average train loss 1.9270
batch:599 average train loss 1.9193
batch:699 average train loss 1.8926
batch:799 average train loss 1.8823
batch:899 average train loss 1.8996
batch:999 average train loss 1.8828
batch:1099 average train loss 1.8845
batch:1199 average train loss 1.8731
average train loss 1.8618
Train Consuming time:79.17 in the epoch: 15
total val iterations: 276 
average val loss 1.9763
accuracy ( less than 0.1 ): 0.2373
median val loss 0.5220
total test iterations: 276 
average test loss 1.9011
accuracy ( less than 0.1 ): 0.2357
median test loss 0.5318
Consuming time:108.71 in the epoch: 15
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 16 
total batch: 1285.4375 
batch:99 average train loss 1.9718
batch:199 average train loss 1.9514
batch:299 average train loss 1.9689
batch:399 average train loss 1.9635
batch:499 average train loss 1.9259
batch:599 average train loss 1.9183
batch:699 average train loss 1.8911
batch:799 average train loss 1.8808
batch:899 average train loss 1.8981
batch:999 average train loss 1.8812
batch:1099 average train loss 1.8829
batch:1199 average train loss 1.8716
average train loss 1.8604
Train Consuming time:75.86 in the epoch: 16
total val iterations: 276 
average val loss 1.9743
accuracy ( less than 0.1 ): 0.2374
median val loss 0.5187
total test iterations: 276 
average test loss 1.9010
accuracy ( less than 0.1 ): 0.2368
median test loss 0.5312
Consuming time:103.86 in the epoch: 16
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 17 
total batch: 1285.4375 
batch:99 average train loss 1.9706
batch:199 average train loss 1.9498
batch:299 average train loss 1.9670
batch:399 average train loss 1.9621
batch:499 average train loss 1.9242
batch:599 average train loss 1.9167
batch:699 average train loss 1.8899
batch:799 average train loss 1.8797
batch:899 average train loss 1.8970
batch:999 average train loss 1.8801
batch:1099 average train loss 1.8820
batch:1199 average train loss 1.8706
average train loss 1.8596
Train Consuming time:75.20 in the epoch: 17
total val iterations: 276 
average val loss 1.9720
accuracy ( less than 0.1 ): 0.2393
median val loss 0.5221
total test iterations: 276 
average test loss 1.9002
accuracy ( less than 0.1 ): 0.2374
median test loss 0.5304
Consuming time:103.17 in the epoch: 17
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 18 
total batch: 1285.4375 
batch:99 average train loss 1.9684
batch:199 average train loss 1.9480
batch:299 average train loss 1.9660
batch:399 average train loss 1.9609
batch:499 average train loss 1.9227
batch:599 average train loss 1.9151
batch:699 average train loss 1.8883
batch:799 average train loss 1.8780
batch:899 average train loss 1.8953
batch:999 average train loss 1.8784
batch:1099 average train loss 1.8802
batch:1199 average train loss 1.8689
average train loss 1.8577
Train Consuming time:74.45 in the epoch: 18
total val iterations: 276 
average val loss 1.9700
accuracy ( less than 0.1 ): 0.2358
median val loss 0.5217
total test iterations: 276 
average test loss 1.8989
accuracy ( less than 0.1 ): 0.2350
median test loss 0.5320
Consuming time:102.48 in the epoch: 18
Best test loss is 1.90
---------------*****---------------
---------------*****---------------
Starting training the epoch: 19 
total batch: 1285.4375 
batch:99 average train loss 1.9657
batch:199 average train loss 1.9463
batch:299 average train loss 1.9639
batch:399 average train loss 1.9594
batch:499 average train loss 1.9211
batch:599 average train loss 1.9132
batch:699 average train loss 1.8865
batch:799 average train loss 1.8764
batch:899 average train loss 1.8939
batch:999 average train loss 1.8770
batch:1099 average train loss 1.8788
batch:1199 average train loss 1.8676
average train loss 1.8566
Train Consuming time:73.64 in the epoch: 19
total val iterations: 276 
average val loss 1.9721
accuracy ( less than 0.1 ): 0.2385
median val loss 0.5205
total test iterations: 276 
average test loss 1.9027
accuracy ( less than 0.1 ): 0.2365
median test loss 0.5377
Consuming time:101.82 in the epoch: 19
Best test loss is 1.90
---------------*****---------------
